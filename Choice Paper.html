<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bijesh Mishra, Ph.D.">

<title>Choice Paper</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Choice Paper_files/libs/clipboard/clipboard.min.js"></script>
<script src="Choice Paper_files/libs/quarto-html/quarto.js"></script>
<script src="Choice Paper_files/libs/quarto-html/popper.min.js"></script>
<script src="Choice Paper_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Choice Paper_files/libs/quarto-html/anchor.min.js"></script>
<link href="Choice Paper_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Choice Paper_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Choice Paper_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Choice Paper_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Choice Paper_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setting-up" id="toc-setting-up" class="nav-link active" data-scroll-target="#setting-up"><span class="header-section-number">1</span> Setting Up</a>
  <ul class="collapse">
  <li><a href="#housekeeping" id="toc-housekeeping" class="nav-link" data-scroll-target="#housekeeping"><span class="header-section-number">1.1</span> Housekeeping</a></li>
  <li><a href="#working-directory" id="toc-working-directory" class="nav-link" data-scroll-target="#working-directory"><span class="header-section-number">1.2</span> Working directory</a></li>
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries"><span class="header-section-number">1.3</span> Load libraries</a></li>
  <li><a href="#theme-for-plots" id="toc-theme-for-plots" class="nav-link" data-scroll-target="#theme-for-plots"><span class="header-section-number">1.4</span> Theme for plots</a></li>
  </ul></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="header-section-number">2</span> Import data</a>
  <ul class="collapse">
  <li><a href="#tomato" id="toc-tomato" class="nav-link" data-scroll-target="#tomato"><span class="header-section-number">2.1</span> Tomato</a></li>
  <li><a href="#strawberry" id="toc-strawberry" class="nav-link" data-scroll-target="#strawberry"><span class="header-section-number">2.2</span> Strawberry</a></li>
  <li><a href="#squash" id="toc-squash" class="nav-link" data-scroll-target="#squash"><span class="header-section-number">2.3</span> Squash</a></li>
  <li><a href="#electricity-price" id="toc-electricity-price" class="nav-link" data-scroll-target="#electricity-price"><span class="header-section-number">2.4</span> Electricity price</a></li>
  <li><a href="#pv-system-cost" id="toc-pv-system-cost" class="nav-link" data-scroll-target="#pv-system-cost"><span class="header-section-number">2.5</span> PV system cost</a></li>
  <li><a href="#capex-nrel" id="toc-capex-nrel" class="nav-link" data-scroll-target="#capex-nrel"><span class="header-section-number">2.6</span> Capex (NREL)</a>
  <ul class="collapse">
  <li><a href="#plotting-capex" id="toc-plotting-capex" class="nav-link" data-scroll-target="#plotting-capex"><span class="header-section-number">2.6.1</span> Plotting capex</a></li>
  </ul></li>
  <li><a href="#panel-configuration" id="toc-panel-configuration" class="nav-link" data-scroll-target="#panel-configuration"><span class="header-section-number">2.7</span> Panel Configuration</a></li>
  <li><a href="#energy-output" id="toc-energy-output" class="nav-link" data-scroll-target="#energy-output"><span class="header-section-number">2.8</span> Energy output</a>
  <ul class="collapse">
  <li><a href="#energy-output-by-solar-panels-counts" id="toc-energy-output-by-solar-panels-counts" class="nav-link" data-scroll-target="#energy-output-by-solar-panels-counts"><span class="header-section-number">2.8.1</span> Energy output by solar panels counts</a></li>
  <li><a href="#energy-output-by-dc-system-size" id="toc-energy-output-by-dc-system-size" class="nav-link" data-scroll-target="#energy-output-by-dc-system-size"><span class="header-section-number">2.8.2</span> Energy output by DC System Size</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#revenue-from-energy" id="toc-revenue-from-energy" class="nav-link" data-scroll-target="#revenue-from-energy"><span class="header-section-number">3</span> Revenue from energy</a>
  <ul class="collapse">
  <li><a href="#simulation-1" id="toc-simulation-1" class="nav-link" data-scroll-target="#simulation-1"><span class="header-section-number">3.1</span> Simulation 1</a></li>
  <li><a href="#simulation-2" id="toc-simulation-2" class="nav-link" data-scroll-target="#simulation-2"><span class="header-section-number">3.2</span> Simulation 2</a></li>
  <li><a href="#plotting-revenue-from-energy-production" id="toc-plotting-revenue-from-energy-production" class="nav-link" data-scroll-target="#plotting-revenue-from-energy-production"><span class="header-section-number">3.3</span> Plotting revenue from energy production</a></li>
  </ul></li>
  <li><a href="#solar-system-cost" id="toc-solar-system-cost" class="nav-link" data-scroll-target="#solar-system-cost"><span class="header-section-number">4</span> Solar system cost</a></li>
  <li><a href="#profit-from-solar" id="toc-profit-from-solar" class="nav-link" data-scroll-target="#profit-from-solar"><span class="header-section-number">5</span> Profit from solar</a>
  <ul class="collapse">
  <li><a href="#plot-profit-from-solar" id="toc-plot-profit-from-solar" class="nav-link" data-scroll-target="#plot-profit-from-solar"><span class="header-section-number">5.1</span> Plot profit from solar</a></li>
  </ul></li>
  <li><a href="#profit-from-crops" id="toc-profit-from-crops" class="nav-link" data-scroll-target="#profit-from-crops"><span class="header-section-number">6</span> Profit from crops</a>
  <ul class="collapse">
  <li><a href="#tomato-1" id="toc-tomato-1" class="nav-link" data-scroll-target="#tomato-1"><span class="header-section-number">6.1</span> Tomato</a>
  <ul class="collapse">
  <li><a href="#profit-from-tomato" id="toc-profit-from-tomato" class="nav-link" data-scroll-target="#profit-from-tomato"><span class="header-section-number">6.1.1</span> Profit from tomato</a></li>
  </ul></li>
  <li><a href="#strawberry-1" id="toc-strawberry-1" class="nav-link" data-scroll-target="#strawberry-1"><span class="header-section-number">6.2</span> Strawberry</a>
  <ul class="collapse">
  <li><a href="#plot-strawberry-profit" id="toc-plot-strawberry-profit" class="nav-link" data-scroll-target="#plot-strawberry-profit"><span class="header-section-number">6.2.1</span> Plot Strawberry Profit</a></li>
  </ul></li>
  <li><a href="#squash-1" id="toc-squash-1" class="nav-link" data-scroll-target="#squash-1"><span class="header-section-number">6.3</span> Squash</a>
  <ul class="collapse">
  <li><a href="#profit-from-squash" id="toc-profit-from-squash" class="nav-link" data-scroll-target="#profit-from-squash"><span class="header-section-number">6.3.1</span> Profit from squash:</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#profit-from-agrivoltaics" id="toc-profit-from-agrivoltaics" class="nav-link" data-scroll-target="#profit-from-agrivoltaics"><span class="header-section-number">7</span> Profit from agrivoltaics</a>
  <ul class="collapse">
  <li><a href="#profit-from-tomato-agrivoltaic-system" id="toc-profit-from-tomato-agrivoltaic-system" class="nav-link" data-scroll-target="#profit-from-tomato-agrivoltaic-system"><span class="header-section-number">7.1</span> Profit from tomato agrivoltaic system</a></li>
  <li><a href="#profit-from-strawberry-agrivoltaic-system" id="toc-profit-from-strawberry-agrivoltaic-system" class="nav-link" data-scroll-target="#profit-from-strawberry-agrivoltaic-system"><span class="header-section-number">7.2</span> Profit from strawberry agrivoltaic system</a></li>
  <li><a href="#profit-from-squash-agrivoltaic-system" id="toc-profit-from-squash-agrivoltaic-system" class="nav-link" data-scroll-target="#profit-from-squash-agrivoltaic-system"><span class="header-section-number">7.3</span> Profit from squash agrivoltaic system</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Choice Paper.ipynb" download="Choice Paper.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Choice Paper</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bijesh Mishra, Ph.D. </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>Technoeconomic anlaysis of agrivoltaic systems in Alabama. A paper for <a href="https://www.aaea.org/publications/choices-magazine" class="uri">Choice Magazine</a> by AAEA.</p>
<section id="setting-up" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Setting Up</h1>
<section id="housekeeping" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="housekeeping"><span class="header-section-number">1.1</span> Housekeeping</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| echo: TRUE</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clean the environment.</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">warn=</span><span class="dv">0</span>, <span class="co"># Warnings. options(warn=-1) / options(warn=0)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scipen=</span><span class="dv">999</span> <span class="co"># No scientific notations.</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="working-directory" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="working-directory"><span class="header-section-number">1.2</span> Working directory</h2>
<p>Codes and output are suppressed. Errors and warnings are visible. No warning and no error means code is working as it should.</p>
</section>
<section id="load-libraries" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="load-libraries"><span class="header-section-number">1.3</span> Load libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(likert,  <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Likert Items</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice,  <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx2, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Scatter plot</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels,  <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Crosstab</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Reshape data</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman,  <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Package Management</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_loaded</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "pacman"    "reshape2"  "gmodels"   "ggpubr"    "openxlsx2" "mice"     
 [7] "likert"    "xtable"    "psych"     "lubridate" "forcats"   "stringr"  
[13] "dplyr"     "purrr"     "readr"     "tidyr"     "tibble"    "ggplot2"  
[19] "tidyverse"</code></pre>
</div>
</div>
</section>
<section id="theme-for-plots" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="theme-for-plots"><span class="header-section-number">1.4</span> Theme for plots</h2>
<p>Setting theme for plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">####### Plotting Data: #####</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Map Theme:</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>plottheme <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mapping theme:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">r =</span> <span class="dv">0</span>, </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">b =</span> <span class="dv">0</span>, </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">l =</span> <span class="dv">0</span>, </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">unit =</span> <span class="st">"cm"</span>),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"lightgrey"</span>,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"lightgrey"</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>,</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x.top =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y.right =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x.bottom =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linetype =</span> <span class="dv">1</span>,</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y.left =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">linetype =</span> <span class="dv">1</span>,</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Text formatting:</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="co"># font</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>                            <span class="at">size =</span> <span class="dv">12</span>, <span class="co"># font size</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>                            <span class="at">colour =</span> <span class="st">"black"</span><span class="co"># font color</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="sc">-</span><span class="fl">0.05</span>),</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">fill =</span> <span class="cn">NA</span>, </span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">linewidth =</span> <span class="fl">0.05</span>, </span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">linetype =</span> <span class="dv">1</span>),</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">"right"</span>,</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="import-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Import data</h1>
<p>Import necessary data.</p>
<section id="tomato" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="tomato"><span class="header-section-number">2.1</span> Tomato</h2>
<ul>
<li><p>Yield = Total tomato production (total bucket of 25 lb) from 1 acres of land which varies from 10% to 200% of total production (100%). The range was simulated by multiplying 100% yield by yldvar.</p></li>
<li><p>yldvar = Yield variation parameter ranges from 10% to 200%.</p></li>
<li><p>Rev17 to Rev23 = Revenue for price ranges of $17 to $23 per bucket of tomato.</p></li>
<li><p>Total cost = Total cost of production for the given yield.</p></li>
<li><p>rolac17 to rolac23= Return to operator, labor and capital for price range of $17 to $23.</p></li>
<li><p>operator Cost = Operator labor cost at $15/hour for given yield. For 100% yield, total hours = 90.</p></li>
<li><p>rlc17 to 23 = Return to land and capital after subtracting operator cost from total revenue.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tomato <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"Parameters.xlsx"</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">"Tomato"</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">start_row =</span> <span class="dv">2</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">start_col =</span> <span class="dv">9</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">skip_empty_rows =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">skip_empty_cols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">yield =</span> Yield,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">yldvar =</span> <span class="st">`</span><span class="at">Yield Variation (%)</span><span class="st">`</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(tomato)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20 25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tomato)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar yield Rev17 Rev18 Rev19 Rev20 Rev21 Rev22 Rev23 Total Cost  rolac17
3    2.0  2720 46240 48960 51680 54400 57120 59840 62560   24560.62 21679.38
4    1.9  2584 43928 46512 49096 51680 54264 56848 59432   23862.62 20065.38
5    1.8  2448 41616 44064 46512 48960 51408 53856 56304   23164.62 18451.38
6    1.7  2312 39304 41616 43928 46240 48552 50864 53176   22466.62 16837.38
7    1.6  2176 36992 39168 41344 43520 45696 47872 50048   21768.62 15223.38
8    1.5  2040 34680 36720 38760 40800 42840 44880 46920   21070.62 13609.38
   rolac18  rolac19  rolac20  rolac21  rolac22  rolac23 Operator Cost    rlc17
3 24399.38 27119.38 29839.38 32559.38 35279.38 37999.38          2700 18979.38
4 22649.38 25233.38 27817.38 30401.38 32985.38 35569.38          2565 17500.38
5 20899.38 23347.38 25795.38 28243.38 30691.38 33139.38          2430 16021.38
6 19149.38 21461.38 23773.38 26085.38 28397.38 30709.38          2295 14542.38
7 17399.38 19575.38 21751.38 23927.38 26103.38 28279.38          2160 13063.38
8 15649.38 17689.38 19729.38 21769.38 23809.38 25849.38          2025 11584.38
     rlc18    rlc19    rlc20    rlc21    rlc22   rlc223
3 21699.38 24419.38 27139.38 29859.38 32579.38 35299.38
4 20084.38 22668.38 25252.38 27836.38 30420.38 33004.38
5 18469.38 20917.38 23365.38 25813.38 28261.38 30709.38
6 16854.38 19166.38 21478.38 23790.38 26102.38 28414.38
7 15239.38 17415.38 19591.38 21767.38 23943.38 26119.38
8 13624.38 15664.38 17704.38 19744.38 21784.38 23824.38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(tomato)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar yield Rev17 Rev18 Rev19 Rev20 Rev21 Rev22 Rev23 Total Cost    rolac17
17    0.6   816 13872 14688 15504 16320 17136 17952 18768   14788.62  -916.6174
18    0.5   680 11560 12240 12920 13600 14280 14960 15640   14090.62 -2530.6174
19    0.4   544  9248  9792 10336 10880 11424 11968 12512   13392.62 -4144.6174
20    0.3   408  6936  7344  7752  8160  8568  8976  9384   12694.62 -5758.6174
21    0.2   272  4624  4896  5168  5440  5712  5984  6256   11996.62 -7372.6174
22    0.1   136  2312  2448  2584  2720  2856  2992  3128   11298.62 -8986.6174
      rolac18    rolac19    rolac20    rolac21    rolac22    rolac23
17  -100.6174   715.3826  1531.3826  2347.3826  3163.3826  3979.3826
18 -1850.6174 -1170.6174  -490.6174   189.3826   869.3826  1549.3826
19 -3600.6174 -3056.6174 -2512.6174 -1968.6174 -1424.6174  -880.6174
20 -5350.6174 -4942.6174 -4534.6174 -4126.6174 -3718.6174 -3310.6174
21 -7100.6174 -6828.6174 -6556.6174 -6284.6174 -6012.6174 -5740.6174
22 -8850.6174 -8714.6174 -8578.6174 -8442.6174 -8306.6174 -8170.6174
   Operator Cost     rlc17      rlc18       rlc19      rlc20      rlc21
17           810 -1726.617  -910.6174   -94.61736   721.3826  1537.3826
18           675 -3205.617 -2525.6174 -1845.61736 -1165.6174  -485.6174
19           540 -4684.617 -4140.6174 -3596.61736 -3052.6174 -2508.6174
20           405 -6163.617 -5755.6174 -5347.61736 -4939.6174 -4531.6174
21           270 -7642.617 -7370.6174 -7098.61736 -6826.6174 -6554.6174
22           135 -9121.617 -8985.6174 -8849.61736 -8713.6174 -8577.6174
        rlc22     rlc223
17  2353.3826  3169.3826
18   194.3826   874.3826
19 -1964.6174 -1420.6174
20 -4123.6174 -3715.6174
21 -6282.6174 -6010.6174
22 -8441.6174 -8305.6174</code></pre>
</div>
</div>
</section>
<section id="strawberry" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="strawberry"><span class="header-section-number">2.2</span> Strawberry</h2>
<ul>
<li><p>Everything same as tomato.</p></li>
<li><p>Numbers 3 to 9 in names are price ranges for strawberry.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>strawberry <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"Parameters.xlsx"</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sheet =</span> <span class="st">"Strawberry"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">start_row =</span> <span class="dv">2</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">start_col =</span> <span class="dv">7</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">skip_empty_rows =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">skip_empty_cols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">yield =</span> Yield,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">yldvar =</span> <span class="st">`</span><span class="at">Yield Variation (%)</span><span class="st">`</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(strawberry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20 25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(strawberry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar  yield    Rev3  Rev4    Rev5  Rev6    Rev7  Rev8    Rev9 Total Cost
3    2.0 6150.0 18450.0 24600 30750.0 36900 43050.0 49200 55350.0   20190.49
4    1.9 5842.5 17527.5 23370 29212.5 35055 40897.5 46740 52582.5   19844.85
5    1.8 5535.0 16605.0 22140 27675.0 33210 38745.0 44280 49815.0   19499.20
6    1.7 5227.5 15682.5 20910 26137.5 31365 36592.5 41820 47047.5   19153.56
7    1.6 4920.0 14760.0 19680 24600.0 29520 34440.0 39360 44280.0   18807.91
8    1.5 4612.5 13837.5 18450 23062.5 27675 32287.5 36900 41512.5   18462.27
     rolac3     rolac4    rolac5   rolac6   rolac7   rolac8   rolac9
3 -1740.495 4409.50503 10559.505 16709.51 22859.51 29009.51 35159.51
4 -2317.350 3525.15003  9367.650 15210.15 21052.65 26895.15 32737.65
5 -2894.205 2640.79503  8175.795 13710.80 19245.80 24780.80 30315.80
6 -3471.060 1756.44003  6983.940 12211.44 17438.94 22666.44 27893.94
7 -4047.915  872.08503  5792.085 10712.09 15632.09 20552.09 25472.09
8 -4624.770  -12.26997  4600.230  9212.73 13825.23 18437.73 23050.23
  Operator Cost      rlc3      rlc4     rlc5      rlc6     rlc7     rlc8
3          2700 -4440.495  1709.505 7859.505 14009.505 20159.51 26309.51
4          2565 -4882.350   960.150 6802.650 12645.150 18487.65 24330.15
5          2430 -5324.205   210.795 5745.795 11280.795 16815.80 22350.80
6          2295 -5766.060  -538.560 4688.940  9916.440 15143.94 20371.44
7          2160 -6207.915 -1287.915 3632.085  8552.085 13472.09 18392.09
8          2025 -6649.770 -2037.270 2575.230  7187.730 11800.23 16412.73
      rlc9
3 32459.51
4 30172.65
5 27885.80
6 25598.94
7 23312.09
8 21025.23</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(strawberry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar  yield   Rev3 Rev4   Rev5  Rev6    Rev7  Rev8    Rev9 Total Cost
17    0.6 1845.0 5535.0 7380 9225.0 11070 12915.0 14760 16605.0   15351.46
18    0.5 1537.5 4612.5 6150 7687.5  9225 10762.5 12300 13837.5   15005.82
19    0.4 1230.0 3690.0 4920 6150.0  7380  8610.0  9840 11070.0   14660.17
20    0.3  922.5 2767.5 3690 4612.5  5535  6457.5  7380  8302.5   14314.53
21    0.2  615.0 1845.0 2460 3075.0  3690  4305.0  4920  5535.0   13968.88
22    0.1  307.5  922.5 1230 1537.5  1845  2152.5  2460  2767.5   13623.24
       rolac3     rolac4     rolac5     rolac6     rolac7     rolac8     rolac9
17  -9816.465  -7971.465  -6126.465  -4281.465  -2436.465   -591.465   1253.535
18 -10393.320  -8855.820  -7318.320  -5780.820  -4243.320  -2705.820  -1168.320
19 -10970.175  -9740.175  -8510.175  -7280.175  -6050.175  -4820.175  -3590.175
20 -11547.030 -10624.530  -9702.030  -8779.530  -7857.030  -6934.530  -6012.030
21 -12123.885 -11508.885 -10893.885 -10278.885  -9663.885  -9048.885  -8433.885
22 -12700.740 -12393.240 -12085.740 -11778.240 -11470.740 -11163.240 -10855.740
   Operator Cost      rlc3       rlc4       rlc5       rlc6       rlc7
17           810 -10626.46  -8781.465  -6936.465  -5091.465  -3246.465
18           675 -11068.32  -9530.820  -7993.320  -6455.820  -4918.320
19           540 -11510.17 -10280.175  -9050.175  -7820.175  -6590.175
20           405 -11952.03 -11029.530 -10107.030  -9184.530  -8262.030
21           270 -12393.88 -11778.885 -11163.885 -10548.885  -9933.885
22           135 -12835.74 -12528.240 -12220.740 -11913.240 -11605.740
         rlc8       rlc9
17  -1401.465    443.535
18  -3380.820  -1843.320
19  -5360.175  -4130.175
20  -7339.530  -6417.030
21  -9318.885  -8703.885
22 -11298.240 -10990.740</code></pre>
</div>
</div>
</section>
<section id="squash" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="squash"><span class="header-section-number">2.3</span> Squash</h2>
<ul>
<li><p>Everything same as tomato and strawberry.</p></li>
<li><p>Numbers 11 to 17 in names are price ranges for squash.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>squash <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"Parameters.xlsx"</span>,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">"Squash"</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">start_row =</span> <span class="dv">2</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">start_col =</span> <span class="dv">8</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">skip_empty_rows =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">skip_empty_cols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">yield =</span> Yield,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">yldvar =</span> <span class="st">`</span><span class="at">Yield Variation (%)</span><span class="st">`</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(squash)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20 25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(squash)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar yield Rev11 Rev12 Rev13 Rev14 Rev15 Rev16 Rev17 Total Cost   rolac11
3    2.0  2180 23980 26160 28340 30520 32700 34880 37060   13670.88 10309.117
4    1.9  2071 22781 24852 26923 28994 31065 33136 35207   13173.63  9607.367
5    1.8  1962 21582 23544 25506 27468 29430 31392 33354   12676.38  8905.617
6    1.7  1853 20383 22236 24089 25942 27795 29648 31501   12179.13  8203.867
7    1.6  1744 19184 20928 22672 24416 26160 27904 29648   11681.88  7502.117
8    1.5  1635 17985 19620 21255 22890 24525 26160 27795   11184.63  6800.367
    rolac12  rolac13  rolac14  rolac15  rolac16  rolac17 Operator Cost    rlc11
3 12489.117 14669.12 16849.12 19029.12 21209.12 23389.12          2700 7609.117
4 11678.367 13749.37 15820.37 17891.37 19962.37 22033.37          2565 7042.367
5 10867.617 12829.62 14791.62 16753.62 18715.62 20677.62          2430 6475.617
6 10056.867 11909.87 13762.87 15615.87 17468.87 19321.87          2295 5908.867
7  9246.117 10990.12 12734.12 14478.12 16222.12 17966.12          2160 5342.117
8  8435.367 10070.37 11705.37 13340.37 14975.37 16610.37          2025 4775.367
     rlc12     rlc13     rlc14    rlc15    rlc16    rlc17
3 9789.117 11969.117 14149.117 16329.12 18509.12 20689.12
4 9113.367 11184.367 13255.367 15326.37 17397.37 19468.37
5 8437.617 10399.617 12361.617 14323.62 16285.62 18247.62
6 7761.867  9614.867 11467.867 13320.87 15173.87 17026.87
7 7086.117  8830.117 10574.117 12318.12 14062.12 15806.12
8 6410.367  8045.367  9680.367 11315.37 12950.37 14585.37</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(squash)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar yield Rev11 Rev12 Rev13 Rev14 Rev15 Rev16 Rev17 Total Cost   rolac11
17    0.6   654  7194  7848  8502  9156  9810 10464 11118   6709.383   484.617
18    0.5   545  5995  6540  7085  7630  8175  8720  9265   6212.133  -217.133
19    0.4   436  4796  5232  5668  6104  6540  6976  7412   5714.883  -918.883
20    0.3   327  3597  3924  4251  4578  4905  5232  5559   5217.633 -1620.633
21    0.2   218  2398  2616  2834  3052  3270  3488  3706   4720.383 -2322.383
22    0.1   109  1199  1308  1417  1526  1635  1744  1853   4223.133 -3024.133
     rolac12     rolac13   rolac14   rolac15     rolac16   rolac17
17  1138.617  1792.61702  2446.617  3100.617  3754.61702  4408.617
18   327.867   872.86702  1417.867  1962.867  2507.86702  3052.867
19  -482.883   -46.88298   389.117   825.117  1261.11702  1697.117
20 -1293.633  -966.63298  -639.633  -312.633    14.36702   341.367
21 -2104.383 -1886.38298 -1668.383 -1450.383 -1232.38298 -1014.383
22 -2915.133 -2806.13298 -2697.133 -2588.133 -2479.13298 -2370.133
   Operator Cost     rlc11     rlc12     rlc13     rlc14     rlc15     rlc16
17           810  -325.383   328.617   982.617  1636.617  2290.617  2944.617
18           675  -892.133  -347.133   197.867   742.867  1287.867  1832.867
19           540 -1458.883 -1022.883  -586.883  -150.883   285.117   721.117
20           405 -2025.633 -1698.633 -1371.633 -1044.633  -717.633  -390.633
21           270 -2592.383 -2374.383 -2156.383 -1938.383 -1720.383 -1502.383
22           135 -3159.133 -3050.133 -2941.133 -2832.133 -2723.133 -2614.133
         rlc17
17  3598.61702
18  2377.86702
19  1157.11702
20   -63.63298
21 -1284.38298
22 -2505.13298</code></pre>
</div>
</div>
</section>
<section id="electricity-price" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="electricity-price"><span class="header-section-number">2.4</span> Electricity price</h2>
<p>Electricity price ranges from 1 cents to 6 cents in 0.5 cent increment. Previously, I used AL retail electricity price as described below. It’s no longer in use but I description below here for the record.</p>
<p>Electricity price ($/kWh) was retail electricity price range for Alabama based on retail electricity price in April 2023 and April 2024 taken from <a href="https://www.eia.gov/electricity/monthly/epm_table_grapher.php?t=epmt_5_6_a">DOE Database</a>. Retail electricity price range in Alabama was from 6.44 to 15.85 cents/kWh in April 2023 and April 2024 which represents industry, commercial, and residential prices.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>elec_price <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"Parameters.xlsx"</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sheet =</span> <span class="st">"Electricity Price"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">epr_kwh =</span> <span class="st">`</span><span class="at">Electricity Price ($/kWh)</span><span class="st">`</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(elec_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>elec_price</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   epr_kwh
2    0.010
3    0.015
4    0.020
5    0.025
6    0.030
7    0.035
8    0.040
9    0.045
10   0.050
11   0.055
12   0.060</code></pre>
</div>
</div>
</section>
<section id="pv-system-cost" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="pv-system-cost"><span class="header-section-number">2.5</span> PV system cost</h2>
<ul>
<li>Data taken from “<a href="https://www.nrel.gov/docs/fy21osti/77811.pdf" class="uri">Capital Costs for Dual-Use Photovoltaic Installations: 2020 Benchmark</a>” Table 1 and Figure 3.</li>
<li>This data was used to estimate CAPEX.</li>
<li>avtyps = agrivoltaic types.</li>
<li>item = itemized component of system.</li>
<li>cost = cost of each item.</li>
<li>height = ground to panel clearance height (ft.)</li>
<li>tcost = Total cost is the sum of all itemized cost for AV system. See figure 3 and table 1 in above document for more detail.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pvsc <span class="ot">&lt;-</span> <span class="fu">wb_read</span>(<span class="at">file =</span> <span class="st">"Parameters.xlsx"</span>,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">sheet =</span> <span class="st">"PV system Cost (NREL)"</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">rows =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">109</span>),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">cols =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">avtyps =</span> <span class="st">`</span><span class="at">AV Types</span><span class="st">`</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">item =</span> Item,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">cost =</span> <span class="st">`</span><span class="at">Cost ($/W)</span><span class="st">`</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">height =</span> <span class="st">`</span><span class="at">Panel Height (ft.)</span><span class="st">`</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">tcost =</span> <span class="st">`</span><span class="at">Total Cost ($/W)</span><span class="st">`</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pvsc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 108   5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pvsc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            avtyps                     item cost height tcost
2 Typical Fixed PV EPC/Developer Net Profit 0.11    4.6  1.53
3 Typical Fixed PV       Developer Overhead 0.15    4.6  1.53
4 Typical Fixed PV          Contingency(3%) 0.05    4.6  1.53
5 Typical Fixed PV      Interconnection Fee 0.03    4.6  1.53
6 Typical Fixed PV  Permitting Fee (if any) 0.02    4.6  1.53
7 Typical Fixed PV        Sale Tax (if any) 0.05    4.6  1.53</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(pvsc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                   avtyps                        item cost
104 PV + Crops (Reinforced Regular Mount)                EPC Overhead 0.25
105 PV + Crops (Reinforced Regular Mount) Installation and Labor Cost 0.32
106 PV + Crops (Reinforced Regular Mount)              Electrical BOS 0.38
107 PV + Crops (Reinforced Regular Mount)              Structural BOS 0.32
108 PV + Crops (Reinforced Regular Mount)               Inverter Only 0.08
109 PV + Crops (Reinforced Regular Mount)                      Module 0.40
    height tcost
104    8.2  2.33
105    8.2  2.33
106    8.2  2.33
107    8.2  2.33
108    8.2  2.33
109    8.2  2.33</code></pre>
</div>
</div>
</section>
<section id="capex-nrel" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="capex-nrel"><span class="header-section-number">2.6</span> Capex (NREL)</h2>
<p>Variable Descriptions:</p>
<ul>
<li><p>Capex: Capital investment cost ($/W) to develop solar energy system. Capex includes cost of physical structure, developer’s overhead and EPC/Developer’s net profit.</p></li>
<li><p>capex estimated as f(height, tracker) using OLS for 6.4 ft Tracking system.</p></li>
<li><p>Height = ground to panel clearance in ft.</p></li>
<li><p>array: Solar array. Tracker = Single axis sun tracking panels; Fixed = Non-tracking panels.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>capex <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">"CAPEX.txt"</span>,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">capex =</span> cost,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">height =</span> pheight,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">array =</span> tracker)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(capex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>capex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  height    capex    array
1    4.6 1.593333    Fixed
2    4.6 1.733333 Tracking
3    6.4 1.850000    Fixed
4    8.2 2.330000    Fixed
5    8.2 2.110000 Tracking
6    6.4 1.921667 Tracking</code></pre>
</div>
</div>
<section id="plotting-capex" class="level3" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="plotting-capex"><span class="header-section-number">2.6.1</span> Plotting capex</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>plottheme <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="at">data =</span> capex,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">mapping =</span> (<span class="fu">aes</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x =</span> height,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> capex,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> array,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> array))) <span class="sc">+</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(aes(label = "Tracker"),</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           nudge_x = 0.05,</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           nudge_y = 0.05,</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           size = 6) +</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"CAPEX Cost by Solar Panel Height"</span>,</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Panel Height (ft.)"</span>,</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"CAPEX Cost ($/W)"</span>,</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Array"</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">8.5</span>)) <span class="sc">+</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="panel-configuration" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="panel-configuration"><span class="header-section-number">2.7</span> Panel Configuration</h2>
<ul>
<li>Panel configuration and DV system output (W).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>panconf <span class="ot">&lt;-</span> <span class="fu">wb_read</span>(<span class="at">file =</span> <span class="st">"Parameters.xlsx"</span>,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">sheet =</span> <span class="st">"Panel Spacing"</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">start_row =</span> <span class="dv">2</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">start_col =</span> <span class="dv">1</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">skip_empty_rows =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">skip_empty_cols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rename(avtyps = `AV Types`,</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#        item = Item,</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#        cost = `Cost ($/W)`,</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#        height = `Panel Height (ft.)`,</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#        tcost = `Total Cost ($/W)`)</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(panconf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21 21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#head(panconf); tail(panconf)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="energy-output" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="energy-output"><span class="header-section-number">2.8</span> Energy output</h2>
<p>Energy output was simulated using NREL <a href="https://pvwatts.nrel.gov/pvwatts.php" class="uri">PV Watts Calculator</a>.</p>
<ul>
<li><p>Panels = Total number of panels in 1 acres of land.</p></li>
<li><p>datalot: 1 = first simulation done for four regions of AL; 2 = second simulation done for four regions of AL. Two simulations have two unique zipcodes for each simulated region.</p></li>
<li><p>al_regs = regions of Alabama</p></li>
<li><p>zips = zipcodes selected from each region of AL for simulation.</p></li>
<li><p>array = Fixed (open rack); 1AxisRot = 1 Axis Tracking. See above NREL tool for more detail.</p></li>
<li><p>dc_kw = DC system size, calculated for each solar panel heights considering solar panels efficiency and area covered by solar panels.</p></li>
<li><p>energy = total energy output ( kWh/Year) considering system parameters. Total hours considered by the model is 8,760 (See <a href="https://pvwatts.nrel.gov/pvwatts.php" class="uri">PV Watts Calculator</a> Results &gt; help (below the result) &gt; results &gt; download monthly or hourly results).</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>energy_output <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"Parameters.xlsx"</span>,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sheet =</span> <span class="st">"Energy Output Archived"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">panels =</span> TotalPanels,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">datalot =</span> DataLot,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">al_regs =</span> <span class="st">`</span><span class="at">Region of AL</span><span class="st">`</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">zips =</span> ZIPCODE,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">array =</span> <span class="st">`</span><span class="at">Array Type</span><span class="st">`</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">dc_kw =</span> <span class="st">`</span><span class="at">DC Size (kW)</span><span class="st">`</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">energy =</span> <span class="st">`</span><span class="at">Energy (kWh/Year)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dc_kw =</span> (<span class="fu">round</span>(dc_kw,<span class="dv">2</span>)),</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">array =</span> <span class="fu">case_when</span>(</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>           array <span class="sc">==</span> <span class="st">"1AxisRot"</span> <span class="sc">~</span> <span class="st">"Tracking"</span>,</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>           array <span class="sc">==</span> <span class="st">"FixedOpen"</span> <span class="sc">~</span> <span class="st">"Fixed"</span>,</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>           <span class="cn">TRUE</span> <span class="sc">~</span> array))</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(datalot == 2)</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(energy_output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 176   7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(energy_output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  panels datalot  al_regs  zips array  dc_kw  energy
2   1534       2 Northern 35769 Fixed 768.90 1041584
3   1416       2 Northern 35769 Fixed 692.01  937427
4   1239       2 Northern 35769 Fixed 615.12  833269
5   1062       2 Northern 35769 Fixed 538.23  729112
6    944       2 Northern 35769 Fixed 461.34  624955
7    767       2 Northern 35769 Fixed 384.45  520797</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(energy_output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    panels datalot  al_regs  zips    array  dc_kw energy
172    767       1 Southern 36525 Tracking 384.45 615098
173    590       1 Southern 36525 Tracking 307.56 492082
174    472       1 Southern 36525 Tracking 230.67 369068
175    295       1 Southern 36525 Tracking 153.78 246051
176    118       1 Southern 36525 Tracking  76.89 106008
177      0       1 Southern 36525 Tracking   0.00      0</code></pre>
</div>
</div>
<section id="energy-output-by-solar-panels-counts" class="level3" data-number="2.8.1">
<h3 data-number="2.8.1" class="anchored" data-anchor-id="energy-output-by-solar-panels-counts"><span class="header-section-number">2.8.1</span> Energy output by solar panels counts</h3>
<p>Plotting Energy output by number of solar panels in one acres of AV system from fixed and single axis rotation system for two zipcodes (1, 2) within each of the four regions of AL.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>lox <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>, <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>array_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Single Axis Rotation"</span>, <span class="st">"Fixed Open Rack"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>datalot_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Location 1"</span>, <span class="st">"Location 2"</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> energy_output,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> al_regs,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> energy,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#fill = energy,</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="fu">factor</span>(panels),</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> <span class="fu">factor</span>(panels))) <span class="sc">+</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(datalot<span class="sc">~</span>array) <span class="sc">+</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> lox) <span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="energy-output-by-dc-system-size" class="level3" data-number="2.8.2">
<h3 data-number="2.8.2" class="anchored" data-anchor-id="energy-output-by-dc-system-size"><span class="header-section-number">2.8.2</span> Energy output by DC System Size</h3>
<p>Plotting Energy output by DC System Size from fixed and single axis rotation system for two zipcodes (1, 2) within each of the four regions of AL.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> energy_output,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> al_regs,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> energy,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#fill = energy,</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="fu">factor</span>(dc_kw),</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> <span class="fu">factor</span>(dc_kw))) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(datalot<span class="sc">~</span>array) <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> lox) <span class="sc">+</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="revenue-from-energy" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Revenue from energy</h1>
<section id="simulation-1" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="simulation-1"><span class="header-section-number">3.1</span> Simulation 1</h2>
<ul>
<li><p>elcprc = electricity price. See Electricity price data for more detail.</p></li>
<li><p>elcrev = Revenue from electricity for given electricity prices. There are 176*11 = 1396 rows in this data. See “energy output” and “electricity price” dataset for more details.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frames if they are not already</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>matrix1 <span class="ot">&lt;-</span> energy_output <span class="co"># dimension of matrix is 176*7</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>matrix2 <span class="ot">&lt;-</span> elec_price <span class="co"># dimension of matrix is 11*1</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the result data frame</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co">#energy_revenue &lt;- data.frame(matrix(nrow = 1936, ncol = 9))</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>energy_revenue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">nrow</span>(matrix2)<span class="sc">*</span><span class="fu">nrow</span>(matrix1),</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">ncol =</span> <span class="dv">9</span>))</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable to keep track of the row index in the result matrix</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>row_index <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each value of the second matrix</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(matrix2)) {</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop through each value of the second matrix</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(matrix1)) {</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># First matrix, second matrix, combined two matrices.</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    new_row <span class="ot">&lt;-</span> <span class="fu">c</span>(matrix1[j, ], matrix2[i, <span class="dv">1</span>], matrix1[j, <span class="dv">7</span>] <span class="sc">*</span> matrix2[i, <span class="dv">1</span>])</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assign the new row to the result matrix</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    energy_revenue[row_index, ] <span class="ot">&lt;-</span> new_row</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Increment the row index</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>    row_index <span class="ot">&lt;-</span> row_index <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Name the columns</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(energy_revenue) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">colnames</span>(matrix1), <span class="st">"elcprc"</span>, <span class="st">"elcrev"</span>)</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result</span></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(energy_revenue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1936    9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(energy_revenue); <span class="fu">tail</span>(energy_revenue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  panels datalot  al_regs  zips array  dc_kw  energy elcprc   elcrev
1   1534       2 Northern 35769 Fixed 768.90 1041584   0.01 10415.84
2   1416       2 Northern 35769 Fixed 692.01  937427   0.01  9374.27
3   1239       2 Northern 35769 Fixed 615.12  833269   0.01  8332.69
4   1062       2 Northern 35769 Fixed 538.23  729112   0.01  7291.12
5    944       2 Northern 35769 Fixed 461.34  624955   0.01  6249.55
6    767       2 Northern 35769 Fixed 384.45  520797   0.01  5207.97</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     panels datalot  al_regs  zips    array  dc_kw energy elcprc   elcrev
1931    767       1 Southern 36525 Tracking 384.45 615098   0.06 36905.88
1932    590       1 Southern 36525 Tracking 307.56 492082   0.06 29524.92
1933    472       1 Southern 36525 Tracking 230.67 369068   0.06 22144.08
1934    295       1 Southern 36525 Tracking 153.78 246051   0.06 14763.06
1935    118       1 Southern 36525 Tracking  76.89 106008   0.06  6360.48
1936      0       1 Southern 36525 Tracking   0.00      0   0.06     0.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Check for any NAs in the result</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># if(any(is.na(energy_revenue))) {</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   na_indices &lt;- which(is.na(energy_revenue), arr.ind = TRUE)</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   print(paste("NAs found at rows:", unique(na_indices[, 1])))</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co"># } else {</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   print("No NAs found in the result data frame.")</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simulation-2" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="simulation-2"><span class="header-section-number">3.2</span> Simulation 2</h2>
<p>This simulation has same result as above (Cross checking above code and output). Code and results are suppressed but errors and warnings are not. No error and no warnings means code is working as it should.</p>
</section>
<section id="plotting-revenue-from-energy-production" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="plotting-revenue-from-energy-production"><span class="header-section-number">3.3</span> Plotting revenue from energy production</h2>
<p>I am using data from simulation 1 for this visualization. This code plots one chart per electricity cost. There are 11 electricity cost resulting into 11 charts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>lox <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>, <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>array_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Single Axis Rotation"</span>, <span class="st">"Fixed Open Rack"</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>datalot_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Location 1"</span>, <span class="st">"Location 2"</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">unique</span>(energy_revenue<span class="sc">$</span>elcprc)) {</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a> a <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> (energy_revenue <span class="sc">%&gt;%</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(elcprc <span class="sc">==</span> i)),</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span>al_regs,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> elcrev,</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#fill = energy,</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="fu">factor</span>(panels),</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> <span class="fu">factor</span>(panels)))<span class="sc">+</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(datalot<span class="sc">~</span>array) <span class="sc">+</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> lox) <span class="sc">+</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a> <span class="fu">cat</span>(<span class="st">"Electricity Price = "</span>, i)</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(a)</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.01</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.015</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.02</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-19-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.025</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-19-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.03</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-19-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.035</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-19-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.04</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-19-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.045</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-19-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.05</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-19-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.055</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-19-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.06</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-19-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="solar-system-cost" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Solar system cost</h1>
<ul>
<li><p>Cost of solar energy system in agrivoltaic setting.</p></li>
<li><p>I used DC system size (dc_kw) and capex ($/W) to get total cost for each height and panel tracking system.</p></li>
<li><p>1 kw dc system size costs x$ CAPEX for given height and tracking system.</p></li>
<li><p>y kw dc system size costs $x*y for given height and tracking system.</p></li>
<li><p>Use simulation 1 data and capex data to get solar system cost.</p></li>
<li><p>There should be 1936*3 = 5808 rows in this dataset.</p></li>
<li><p>height = height of solar panels; see capex dataset for details.</p></li>
<li><p>capex = capex from capex table; see capex dataset for details.</p></li>
<li><p>ttlcost = Total cost for given DC system size.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>expanded_data <span class="ot">&lt;-</span> energy_revenue <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">each =</span> <span class="dv">3</span>))</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>capex_height <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">unique</span>(capex<span class="sc">$</span>height),</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">length.out =</span> <span class="fu">nrow</span>(energy_revenue))</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>energy_cost <span class="ot">=</span> <span class="fu">cbind</span>(expanded_data, capex_height) <span class="sc">%&gt;%</span> </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">height =</span> capex_height)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>energy_cost <span class="ot">&lt;-</span> <span class="fu">left_join</span>(energy_cost, </span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>                         capex, </span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"array"</span>, <span class="st">"height"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ttlcost =</span> capex<span class="sc">*</span>dc_kw) <span class="co">#Convert $ in kW</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(energy_cost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5808   12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(energy_cost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  panels datalot  al_regs  zips array  dc_kw  energy elcprc   elcrev height
1   1534       2 Northern 35769 Fixed 768.90 1041584   0.01 10415.84    4.6
2   1534       2 Northern 35769 Fixed 768.90 1041584   0.01 10415.84    6.4
3   1534       2 Northern 35769 Fixed 768.90 1041584   0.01 10415.84    8.2
4   1416       2 Northern 35769 Fixed 692.01  937427   0.01  9374.27    4.6
5   1416       2 Northern 35769 Fixed 692.01  937427   0.01  9374.27    6.4
6   1416       2 Northern 35769 Fixed 692.01  937427   0.01  9374.27    8.2
     capex  ttlcost
1 1.593333 1225.114
2 1.850000 1422.465
3 2.330000 1791.537
4 1.593333 1102.603
5 1.850000 1280.218
6 2.330000 1612.383</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(energy_cost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     panels datalot  al_regs  zips    array dc_kw energy elcprc  elcrev height
5803    118       1 Southern 36525 Tracking 76.89 106008   0.06 6360.48    6.4
5804    118       1 Southern 36525 Tracking 76.89 106008   0.06 6360.48    8.2
5805    118       1 Southern 36525 Tracking 76.89 106008   0.06 6360.48    4.6
5806      0       1 Southern 36525 Tracking  0.00      0   0.06    0.00    6.4
5807      0       1 Southern 36525 Tracking  0.00      0   0.06    0.00    8.2
5808      0       1 Southern 36525 Tracking  0.00      0   0.06    0.00    4.6
        capex  ttlcost
5803 1.921667 147.7570
5804 2.110000 162.2379
5805 1.733333 133.2760
5806 1.921667   0.0000
5807 2.110000   0.0000
5808 1.733333   0.0000</code></pre>
</div>
</div>
</section>
<section id="profit-from-solar" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Profit from solar</h1>
<p>Profit from solar energy system in agrivoltaic setting</p>
<ul>
<li>eprofit = profit from electricity after subtracting total cost (ttlcost) from total revenue (elcrev).</li>
<li>Comments: Subtract annual maintenance cost and annualized CAPEX for 25 years at 5% interest rate.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>solar_profit <span class="ot">&lt;-</span> energy_cost <span class="sc">%&gt;%</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eprofit =</span> elcrev <span class="sc">-</span> ttlcost)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(solar_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5808   13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(solar_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  panels datalot  al_regs  zips array  dc_kw  energy elcprc   elcrev height
1   1534       2 Northern 35769 Fixed 768.90 1041584   0.01 10415.84    4.6
2   1534       2 Northern 35769 Fixed 768.90 1041584   0.01 10415.84    6.4
3   1534       2 Northern 35769 Fixed 768.90 1041584   0.01 10415.84    8.2
4   1416       2 Northern 35769 Fixed 692.01  937427   0.01  9374.27    4.6
5   1416       2 Northern 35769 Fixed 692.01  937427   0.01  9374.27    6.4
6   1416       2 Northern 35769 Fixed 692.01  937427   0.01  9374.27    8.2
     capex  ttlcost  eprofit
1 1.593333 1225.114 9190.726
2 1.850000 1422.465 8993.375
3 2.330000 1791.537 8624.303
4 1.593333 1102.603 8271.667
5 1.850000 1280.218 8094.052
6 2.330000 1612.383 7761.887</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(solar_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     panels datalot  al_regs  zips    array dc_kw energy elcprc  elcrev height
5803    118       1 Southern 36525 Tracking 76.89 106008   0.06 6360.48    6.4
5804    118       1 Southern 36525 Tracking 76.89 106008   0.06 6360.48    8.2
5805    118       1 Southern 36525 Tracking 76.89 106008   0.06 6360.48    4.6
5806      0       1 Southern 36525 Tracking  0.00      0   0.06    0.00    6.4
5807      0       1 Southern 36525 Tracking  0.00      0   0.06    0.00    8.2
5808      0       1 Southern 36525 Tracking  0.00      0   0.06    0.00    4.6
        capex  ttlcost  eprofit
5803 1.921667 147.7570 6212.723
5804 2.110000 162.2379 6198.242
5805 1.733333 133.2760 6227.204
5806 1.921667   0.0000    0.000
5807 2.110000   0.0000    0.000
5808 1.733333   0.0000    0.000</code></pre>
</div>
</div>
<section id="plot-profit-from-solar" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="plot-profit-from-solar"><span class="header-section-number">5.1</span> Plot profit from solar</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>lox <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>, <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>array_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Single Axis Rotation"</span>, <span class="st">"Fixed Open Rack"</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>datalot_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Location 1"</span>, <span class="st">"Location 2"</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">unique</span>(solar_profit<span class="sc">$</span>datalot)) {</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">unique</span>(solar_profit<span class="sc">$</span>elcprc)) {</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">=</span> <span class="fu">ggplot</span>(</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> (solar_profit <span class="sc">%&gt;%</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(datalot <span class="sc">==</span> i, elcprc <span class="sc">==</span> j)),</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> al_regs,</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> eprofit,</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">#fill = energy,</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="fu">factor</span>(panels),</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> <span class="fu">factor</span>(panels)</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_grid</span>(height <span class="sc">~</span> array) <span class="sc">+</span></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> lox) <span class="sc">+</span></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Datalot = "</span>, i, <span class="st">"and "</span>)</span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Electricity Price = "</span>, j)</span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(b)</span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  2 and Electricity Price =  0.01</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  2 and Electricity Price =  0.015</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  2 and Electricity Price =  0.02</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  2 and Electricity Price =  0.025</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  2 and Electricity Price =  0.03</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  2 and Electricity Price =  0.035</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  2 and Electricity Price =  0.04</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  2 and Electricity Price =  0.045</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  2 and Electricity Price =  0.05</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  2 and Electricity Price =  0.055</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  2 and Electricity Price =  0.06</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  1 and Electricity Price =  0.01</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  1 and Electricity Price =  0.015</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  1 and Electricity Price =  0.02</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  1 and Electricity Price =  0.025</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  1 and Electricity Price =  0.03</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  1 and Electricity Price =  0.035</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  1 and Electricity Price =  0.04</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  1 and Electricity Price =  0.045</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  1 and Electricity Price =  0.05</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  1 and Electricity Price =  0.055</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Datalot =  1 and Electricity Price =  0.06</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-23-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="profit-from-crops" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Profit from crops</h1>
<section id="tomato-1" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="tomato-1"><span class="header-section-number">6.1</span> Tomato</h2>
<p>Filter return to operator, land and capital profit from Tomato:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>tomato_profit <span class="ot">=</span> tomato <span class="sc">%&gt;%</span> </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(yldvar, yield, </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>         rolac17, rolac18, rolac19, rolac20, rolac21, rolac22, rolac23)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(tomato_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20  9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>tomato_profit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar yield    rolac17    rolac18    rolac19    rolac20    rolac21
3     2.0  2720 21679.3826 24399.3826 27119.3826 29839.3826 32559.3826
4     1.9  2584 20065.3826 22649.3826 25233.3826 27817.3826 30401.3826
5     1.8  2448 18451.3826 20899.3826 23347.3826 25795.3826 28243.3826
6     1.7  2312 16837.3826 19149.3826 21461.3826 23773.3826 26085.3826
7     1.6  2176 15223.3826 17399.3826 19575.3826 21751.3826 23927.3826
8     1.5  2040 13609.3826 15649.3826 17689.3826 19729.3826 21769.3826
9     1.4  1904 11995.3826 13899.3826 15803.3826 17707.3826 19611.3826
10    1.3  1768 10381.3826 12149.3826 13917.3826 15685.3826 17453.3826
11    1.2  1632  8767.3826 10399.3826 12031.3826 13663.3826 15295.3826
12    1.1  1496  7153.3826  8649.3826 10145.3826 11641.3826 13137.3826
13    1.0  1360  5539.3826  6899.3826  8259.3826  9619.3826 10979.3826
14    0.9  1224  3925.3826  5149.3826  6373.3826  7597.3826  8821.3826
15    0.8  1088  2311.3826  3399.3826  4487.3826  5575.3826  6663.3826
16    0.7   952   697.3826  1649.3826  2601.3826  3553.3826  4505.3826
17    0.6   816  -916.6174  -100.6174   715.3826  1531.3826  2347.3826
18    0.5   680 -2530.6174 -1850.6174 -1170.6174  -490.6174   189.3826
19    0.4   544 -4144.6174 -3600.6174 -3056.6174 -2512.6174 -1968.6174
20    0.3   408 -5758.6174 -5350.6174 -4942.6174 -4534.6174 -4126.6174
21    0.2   272 -7372.6174 -7100.6174 -6828.6174 -6556.6174 -6284.6174
22    0.1   136 -8986.6174 -8850.6174 -8714.6174 -8578.6174 -8442.6174
      rolac22    rolac23
3  35279.3826 37999.3826
4  32985.3826 35569.3826
5  30691.3826 33139.3826
6  28397.3826 30709.3826
7  26103.3826 28279.3826
8  23809.3826 25849.3826
9  21515.3826 23419.3826
10 19221.3826 20989.3826
11 16927.3826 18559.3826
12 14633.3826 16129.3826
13 12339.3826 13699.3826
14 10045.3826 11269.3826
15  7751.3826  8839.3826
16  5457.3826  6409.3826
17  3163.3826  3979.3826
18   869.3826  1549.3826
19 -1424.6174  -880.6174
20 -3718.6174 -3310.6174
21 -6012.6174 -5740.6174
22 -8306.6174 -8170.6174</code></pre>
</div>
</div>
<p>Convert data to long format:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign column names for clarity</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tomato_profit) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"yldvar"</span>, <span class="st">"yield"</span>,</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac17"</span>, <span class="st">"rolac18"</span>, <span class="st">"rolac19"</span>,</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac20"</span>, <span class="st">"rolac21"</span>, <span class="st">"rolac22"</span>,</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac23"</span>)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data frame from wide to long format</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>tomato_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(tomato_profit,</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"yldvar"</span>, <span class="st">"yield"</span>),</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">"rolac17"</span>, <span class="st">"rolac18"</span>, <span class="st">"rolac19"</span>,</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"rolac20"</span>, <span class="st">"rolac21"</span>, <span class="st">"rolac22"</span>,</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"rolac23"</span>),</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">variable.name =</span> <span class="st">"price"</span>,</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">value.name =</span> <span class="st">"profit"</span>)</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the 'Price' column to numeric by extracting the number</span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>tomato_long<span class="sc">$</span>price <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"rolac"</span>, <span class="st">""</span>, tomato_long<span class="sc">$</span>price))</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a><span class="co"># View the resulting data frame</span></span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(tomato_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 140   4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tomato_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar yield price   profit
1    2.0  2720    17 21679.38
2    1.9  2584    17 20065.38
3    1.8  2448    17 18451.38
4    1.7  2312    17 16837.38
5    1.6  2176    17 15223.38
6    1.5  2040    17 13609.38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(tomato_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    yldvar yield price     profit
135    0.6   816    23  3979.3826
136    0.5   680    23  1549.3826
137    0.4   544    23  -880.6174
138    0.3   408    23 -3310.6174
139    0.2   272    23 -5740.6174
140    0.1   136    23 -8170.6174</code></pre>
</div>
</div>
<section id="profit-from-tomato" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="profit-from-tomato"><span class="header-section-number">6.1.1</span> Profit from tomato</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> tomato_long,</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> price,</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> profit,</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">factor</span>(yldvar),</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="fu">factor</span>(yield))) <span class="sc">+</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> tomato_long,</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> yield,</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> profit,</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#fill = yield,</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">factor</span>(price),</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="fu">factor</span>(price))) <span class="sc">+</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vertical dashed line is 100% yield</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> tomato_long<span class="sc">$</span>yield[<span class="dv">11</span>],</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a><span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="strawberry-1" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="strawberry-1"><span class="header-section-number">6.2</span> Strawberry</h2>
<p>Filter return to operator, land and capital profit from strawberry</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>strawberry_profit <span class="ot">=</span> strawberry <span class="sc">%&gt;%</span> </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(yldvar, yield, </span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>         rolac3, rolac4, rolac5, rolac6, rolac7, rolac8, rolac9)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(strawberry_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20  9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>strawberry_profit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar  yield     rolac3       rolac4     rolac5     rolac6     rolac7
3     2.0 6150.0  -1740.495   4409.50503  10559.505  16709.505  22859.505
4     1.9 5842.5  -2317.350   3525.15003   9367.650  15210.150  21052.650
5     1.8 5535.0  -2894.205   2640.79503   8175.795  13710.795  19245.795
6     1.7 5227.5  -3471.060   1756.44003   6983.940  12211.440  17438.940
7     1.6 4920.0  -4047.915    872.08503   5792.085  10712.085  15632.085
8     1.5 4612.5  -4624.770    -12.26997   4600.230   9212.730  13825.230
9     1.4 4305.0  -5201.625   -896.62497   3408.375   7713.375  12018.375
10    1.3 3997.5  -5778.480  -1780.97997   2216.520   6214.020  10211.520
11    1.2 3690.0  -6355.335  -2665.33497   1024.665   4714.665   8404.665
12    1.1 3382.5  -6932.190  -3549.68997   -167.190   3215.310   6597.810
13    1.0 3075.0  -7509.045  -4434.04497  -1359.045   1715.955   4790.955
14    0.9 2767.5  -8085.900  -5318.39997  -2550.900    216.600   2984.100
15    0.8 2460.0  -8662.755  -6202.75497  -3742.755  -1282.755   1177.245
16    0.7 2152.5  -9239.610  -7087.10997  -4934.610  -2782.110   -629.610
17    0.6 1845.0  -9816.465  -7971.46497  -6126.465  -4281.465  -2436.465
18    0.5 1537.5 -10393.320  -8855.81997  -7318.320  -5780.820  -4243.320
19    0.4 1230.0 -10970.175  -9740.17497  -8510.175  -7280.175  -6050.175
20    0.3  922.5 -11547.030 -10624.52997  -9702.030  -8779.530  -7857.030
21    0.2  615.0 -12123.885 -11508.88497 -10893.885 -10278.885  -9663.885
22    0.1  307.5 -12700.740 -12393.23997 -12085.740 -11778.240 -11470.740
       rolac8     rolac9
3   29009.505  35159.505
4   26895.150  32737.650
5   24780.795  30315.795
6   22666.440  27893.940
7   20552.085  25472.085
8   18437.730  23050.230
9   16323.375  20628.375
10  14209.020  18206.520
11  12094.665  15784.665
12   9980.310  13362.810
13   7865.955  10940.955
14   5751.600   8519.100
15   3637.245   6097.245
16   1522.890   3675.390
17   -591.465   1253.535
18  -2705.820  -1168.320
19  -4820.175  -3590.175
20  -6934.530  -6012.030
21  -9048.885  -8433.885
22 -11163.240 -10855.740</code></pre>
</div>
</div>
<p>Convert data to long format:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign column names for clarity</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(strawberry_profit) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"yldvar"</span>, <span class="st">"yield"</span>,</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac3"</span>, <span class="st">"rolac4"</span>, <span class="st">"rolac5"</span>,</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac6"</span>, <span class="st">"rolac7"</span>, <span class="st">"rolac8"</span>,</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac9"</span>)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data frame from wide to long format</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>stberry_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(strawberry_profit,</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"yldvar"</span>, <span class="st">"yield"</span>),</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">"rolac3"</span>, <span class="st">"rolac4"</span>, <span class="st">"rolac5"</span>,</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"rolac6"</span>, <span class="st">"rolac7"</span>, <span class="st">"rolac8"</span>,</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"rolac9"</span>),</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">variable.name =</span> <span class="st">"price"</span>,</span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">value.name =</span> <span class="st">"profit"</span>)</span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the 'Price' column to numeric by extracting the number</span></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>stberry_long<span class="sc">$</span>price <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"rolac"</span>, <span class="st">""</span>, stberry_long<span class="sc">$</span>price))</span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a><span class="co"># View the resulting data frame</span></span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(stberry_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 140   4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(stberry_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar  yield price    profit
1    2.0 6150.0     3 -1740.495
2    1.9 5842.5     3 -2317.350
3    1.8 5535.0     3 -2894.205
4    1.7 5227.5     3 -3471.060
5    1.6 4920.0     3 -4047.915
6    1.5 4612.5     3 -4624.770</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(stberry_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    yldvar  yield price     profit
135    0.6 1845.0     9   1253.535
136    0.5 1537.5     9  -1168.320
137    0.4 1230.0     9  -3590.175
138    0.3  922.5     9  -6012.030
139    0.2  615.0     9  -8433.885
140    0.1  307.5     9 -10855.740</code></pre>
</div>
</div>
<section id="plot-strawberry-profit" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="plot-strawberry-profit"><span class="header-section-number">6.2.1</span> Plot Strawberry Profit</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stberry_long,</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> price,</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> profit,</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">factor</span>(yldvar),</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="fu">factor</span>(yield))) <span class="sc">+</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stberry_long,</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> yield,</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> profit,</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">factor</span>(price),</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="fu">factor</span>(price))) <span class="sc">+</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Vertical dashed line is 100% yield</span></span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> stberry_long<span class="sc">$</span>yield[<span class="dv">11</span>],</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="squash-1" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="squash-1"><span class="header-section-number">6.3</span> Squash</h2>
<p>Filter return to operator, land and capital profit from squash</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>squash_profit <span class="ot">=</span> squash <span class="sc">%&gt;%</span> </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(yldvar, yield, </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>         rolac11, rolac12, rolac13, rolac14, rolac15, rolac16, rolac17)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>squash_profit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar yield   rolac11   rolac12     rolac13   rolac14   rolac15     rolac16
3     2.0  2180 10309.117 12489.117 14669.11702 16849.117 19029.117 21209.11702
4     1.9  2071  9607.367 11678.367 13749.36702 15820.367 17891.367 19962.36702
5     1.8  1962  8905.617 10867.617 12829.61702 14791.617 16753.617 18715.61702
6     1.7  1853  8203.867 10056.867 11909.86702 13762.867 15615.867 17468.86702
7     1.6  1744  7502.117  9246.117 10990.11702 12734.117 14478.117 16222.11702
8     1.5  1635  6800.367  8435.367 10070.36702 11705.367 13340.367 14975.36702
9     1.4  1526  6098.617  7624.617  9150.61702 10676.617 12202.617 13728.61702
10    1.3  1417  5396.867  6813.867  8230.86702  9647.867 11064.867 12481.86702
11    1.2  1308  4695.117  6003.117  7311.11702  8619.117  9927.117 11235.11702
12    1.1  1199  3993.367  5192.367  6391.36702  7590.367  8789.367  9988.36702
13    1.0  1090  3291.617  4381.617  5471.61702  6561.617  7651.617  8741.61702
14    0.9   981  2589.867  3570.867  4551.86702  5532.867  6513.867  7494.86702
15    0.8   872  1888.117  2760.117  3632.11702  4504.117  5376.117  6248.11702
16    0.7   763  1186.367  1949.367  2712.36702  3475.367  4238.367  5001.36702
17    0.6   654   484.617  1138.617  1792.61702  2446.617  3100.617  3754.61702
18    0.5   545  -217.133   327.867   872.86702  1417.867  1962.867  2507.86702
19    0.4   436  -918.883  -482.883   -46.88298   389.117   825.117  1261.11702
20    0.3   327 -1620.633 -1293.633  -966.63298  -639.633  -312.633    14.36702
21    0.2   218 -2322.383 -2104.383 -1886.38298 -1668.383 -1450.383 -1232.38298
22    0.1   109 -3024.133 -2915.133 -2806.13298 -2697.133 -2588.133 -2479.13298
     rolac17
3  23389.117
4  22033.367
5  20677.617
6  19321.867
7  17966.117
8  16610.367
9  15254.617
10 13898.867
11 12543.117
12 11187.367
13  9831.617
14  8475.867
15  7120.117
16  5764.367
17  4408.617
18  3052.867
19  1697.117
20   341.367
21 -1014.383
22 -2370.133</code></pre>
</div>
</div>
<p>Convert data to long format:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign column names for clarity</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(squash_profit) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"yldvar"</span>, <span class="st">"yield"</span>,</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac11"</span>, <span class="st">"rolac12"</span>, <span class="st">"rolac13"</span>,</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac14"</span>, <span class="st">"rolac15"</span>, <span class="st">"rolac16"</span>,</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac17"</span>)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data frame from wide to long format</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>squash_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(squash_profit,</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"yldvar"</span>, <span class="st">"yield"</span>),</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">"rolac11"</span>, <span class="st">"rolac12"</span>, <span class="st">"rolac13"</span>,</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"rolac14"</span>, <span class="st">"rolac15"</span>, <span class="st">"rolac16"</span>,</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"rolac17"</span>),</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">variable.name =</span> <span class="st">"price"</span>,</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">value.name =</span> <span class="st">"profit"</span>)</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the 'Price' column to numeric by extracting the number</span></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>squash_long<span class="sc">$</span>price <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"rolac"</span>, <span class="st">""</span>, squash_long<span class="sc">$</span>price))</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a><span class="co"># View the resulting data frame</span></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(squash_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 140   4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(squash_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar yield price    profit
1    2.0  2180    11 10309.117
2    1.9  2071    11  9607.367
3    1.8  1962    11  8905.617
4    1.7  1853    11  8203.867
5    1.6  1744    11  7502.117
6    1.5  1635    11  6800.367</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(squash_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    yldvar yield price    profit
135    0.6   654    17  4408.617
136    0.5   545    17  3052.867
137    0.4   436    17  1697.117
138    0.3   327    17   341.367
139    0.2   218    17 -1014.383
140    0.1   109    17 -2370.133</code></pre>
</div>
</div>
<section id="profit-from-squash" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="profit-from-squash"><span class="header-section-number">6.3.1</span> Profit from squash:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> squash_long,</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> price,</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> profit,</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">factor</span>(yldvar),</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="fu">factor</span>(yield))) <span class="sc">+</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> squash_long,</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> yield,</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> profit,</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">factor</span>(price),</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="fu">factor</span>(price))) <span class="sc">+</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vertical dashed line is 100% yield</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> squash_long<span class="sc">$</span>yield[<span class="dv">11</span>],</span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Choice-Paper_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="profit-from-agrivoltaics" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Profit from agrivoltaics</h1>
<p>Total profit from solar and crops for all combinations of AVs simulated.</p>
<section id="profit-from-tomato-agrivoltaic-system" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="profit-from-tomato-agrivoltaic-system"><span class="header-section-number">7.1</span> Profit from tomato agrivoltaic system</h2>
<p>Joint profit from tomato (tomato_long) and solar energy production (solar_profit) from 1 acre of land.</p>
<p>WORK ON PROGRESS. NOT THE FINAL RESULT AND CODE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | results='hide'</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>matrix1 <span class="ot">&lt;-</span> energy_output <span class="co"># dimension of matrix is 176*7</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>matrix2 <span class="ot">&lt;-</span> elec_price <span class="co"># dimension of matrix is 11*1</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Initializing the result matrix</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>result_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">9</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">colnames</span>(matrix1),  <span class="st">"elcrev"</span>, <span class="st">"elcprc"</span>)</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop to multiply first and second matrices</span></span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(matrix2)) {</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>  temp_matrix <span class="ot">&lt;-</span> matrix1</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>  temp_matrix<span class="sc">$</span>E_Prc <span class="ot">&lt;-</span> matrix2[i, <span class="dv">1</span>]</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>  temp_matrix<span class="sc">$</span>E_Rev <span class="ot">&lt;-</span> matrix2[i, <span class="dv">1</span>] <span class="sc">*</span> matrix1[, <span class="dv">7</span>]</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>  result_matrix <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_matrix, temp_matrix)</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the resulting matrix</span></span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(result_matrix)</span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(result_matrix)</span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(result_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="profit-from-strawberry-agrivoltaic-system" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="profit-from-strawberry-agrivoltaic-system"><span class="header-section-number">7.2</span> Profit from strawberry agrivoltaic system</h2>
<p>Joint profit from strawberry (stberry_long) and solar energy production (solar_profit) from 1 acre of land.</p>
<p>WORK ON PROGRESS. NOT THE FINAL RESULT AND CODE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | results='hide'</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>matrix1 <span class="ot">&lt;-</span> energy_output <span class="co"># dimension of matrix is 176*7</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>matrix2 <span class="ot">&lt;-</span> elec_price <span class="co"># dimension of matrix is 11*1</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Initializing the result matrix</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>result_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">9</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">colnames</span>(matrix1),  <span class="st">"elcrev"</span>, <span class="st">"elcprc"</span>)</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop to multiply first and second matrices</span></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(matrix2)) {</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>  temp_matrix <span class="ot">&lt;-</span> matrix1</span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>  temp_matrix<span class="sc">$</span>E_Prc <span class="ot">&lt;-</span> matrix2[i, <span class="dv">1</span>]</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>  temp_matrix<span class="sc">$</span>E_Rev <span class="ot">&lt;-</span> matrix2[i, <span class="dv">1</span>] <span class="sc">*</span> matrix1[, <span class="dv">7</span>]</span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>  result_matrix <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_matrix, temp_matrix)</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the resulting matrix</span></span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(result_matrix)</span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(result_matrix)</span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(result_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="profit-from-squash-agrivoltaic-system" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="profit-from-squash-agrivoltaic-system"><span class="header-section-number">7.3</span> Profit from squash agrivoltaic system</h2>
<p>Joint profit from squash (squash_long) and solar energy production (solar_profit) from 1 acre of land.</p>
<p>WORK ON PROGRESS. NOT THE FINAL RESULT AND CODE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | results='hide'</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>matrix1 <span class="ot">&lt;-</span> energy_output <span class="co"># dimension of matrix is 176*7</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>matrix2 <span class="ot">&lt;-</span> elec_price <span class="co"># dimension of matrix is 11*1</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Initializing the result matrix</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>result_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">9</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">colnames</span>(matrix1),  <span class="st">"elcrev"</span>, <span class="st">"elcprc"</span>)</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop to multiply first and second matrices</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(matrix2)) {</span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>  temp_matrix <span class="ot">&lt;-</span> matrix1</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>  temp_matrix<span class="sc">$</span>E_Prc <span class="ot">&lt;-</span> matrix2[i, <span class="dv">1</span>]</span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>  temp_matrix<span class="sc">$</span>E_Rev <span class="ot">&lt;-</span> matrix2[i, <span class="dv">1</span>] <span class="sc">*</span> matrix1[, <span class="dv">7</span>]</span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a>  result_matrix <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_matrix, temp_matrix)</span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the resulting matrix</span></span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(result_matrix)</span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(result_matrix)</span>
<span id="cb141-22"><a href="#cb141-22" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(result_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>