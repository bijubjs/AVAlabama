<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bijesh Mishra, Ph.D.">

<title>Choice Paper Simulation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Simulation_files/libs/clipboard/clipboard.min.js"></script>
<script src="Simulation_files/libs/quarto-html/quarto.js"></script>
<script src="Simulation_files/libs/quarto-html/popper.min.js"></script>
<script src="Simulation_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Simulation_files/libs/quarto-html/anchor.min.js"></script>
<link href="Simulation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Simulation_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Simulation_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Simulation_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Simulation_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setting-up" id="toc-setting-up" class="nav-link active" data-scroll-target="#setting-up"><span class="header-section-number">1</span> Setting Up</a>
  <ul class="collapse">
  <li><a href="#housekeeping" id="toc-housekeeping" class="nav-link" data-scroll-target="#housekeeping"><span class="header-section-number">1.1</span> Housekeeping</a></li>
  <li><a href="#working-directory" id="toc-working-directory" class="nav-link" data-scroll-target="#working-directory"><span class="header-section-number">1.2</span> Working directory</a></li>
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries"><span class="header-section-number">1.3</span> Load libraries</a></li>
  <li><a href="#progress-bar" id="toc-progress-bar" class="nav-link" data-scroll-target="#progress-bar"><span class="header-section-number">1.4</span> Progress Bar</a></li>
  <li><a href="#theme-for-plots" id="toc-theme-for-plots" class="nav-link" data-scroll-target="#theme-for-plots"><span class="header-section-number">1.5</span> Theme for plots</a></li>
  </ul></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="header-section-number">2</span> Import data</a>
  <ul class="collapse">
  <li><a href="#tomato" id="toc-tomato" class="nav-link" data-scroll-target="#tomato"><span class="header-section-number">2.1</span> Tomato</a></li>
  <li><a href="#strawberry" id="toc-strawberry" class="nav-link" data-scroll-target="#strawberry"><span class="header-section-number">2.2</span> Strawberry</a></li>
  <li><a href="#squash" id="toc-squash" class="nav-link" data-scroll-target="#squash"><span class="header-section-number">2.3</span> Squash</a></li>
  <li><a href="#electricity-price" id="toc-electricity-price" class="nav-link" data-scroll-target="#electricity-price"><span class="header-section-number">2.4</span> Electricity price</a></li>
  <li><a href="#pv-system-cost" id="toc-pv-system-cost" class="nav-link" data-scroll-target="#pv-system-cost"><span class="header-section-number">2.5</span> PV system cost</a></li>
  <li><a href="#capex-nrel" id="toc-capex-nrel" class="nav-link" data-scroll-target="#capex-nrel"><span class="header-section-number">2.6</span> Capex (NREL)</a>
  <ul class="collapse">
  <li><a href="#plotting-capex" id="toc-plotting-capex" class="nav-link" data-scroll-target="#plotting-capex"><span class="header-section-number">2.6.1</span> Plotting capex</a></li>
  </ul></li>
  <li><a href="#panel-configuration" id="toc-panel-configuration" class="nav-link" data-scroll-target="#panel-configuration"><span class="header-section-number">2.7</span> Panel Configuration</a></li>
  <li><a href="#energy-output" id="toc-energy-output" class="nav-link" data-scroll-target="#energy-output"><span class="header-section-number">2.8</span> Energy output</a>
  <ul class="collapse">
  <li><a href="#energy-output-by-solar-panels-counts" id="toc-energy-output-by-solar-panels-counts" class="nav-link" data-scroll-target="#energy-output-by-solar-panels-counts"><span class="header-section-number">2.8.1</span> Energy output by solar panels counts</a></li>
  <li><a href="#energy-output-by-dc-system-size" id="toc-energy-output-by-dc-system-size" class="nav-link" data-scroll-target="#energy-output-by-dc-system-size"><span class="header-section-number">2.8.2</span> Energy output by DC System Size</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#solar-energy-calculation" id="toc-solar-energy-calculation" class="nav-link" data-scroll-target="#solar-energy-calculation"><span class="header-section-number">3</span> Solar Energy Calculation</a>
  <ul class="collapse">
  <li><a href="#simulation-1-for-energy-revenue" id="toc-simulation-1-for-energy-revenue" class="nav-link" data-scroll-target="#simulation-1-for-energy-revenue"><span class="header-section-number">3.1</span> Simulation 1 for energy revenue</a></li>
  <li><a href="#simulation-2-for-energy-revenue" id="toc-simulation-2-for-energy-revenue" class="nav-link" data-scroll-target="#simulation-2-for-energy-revenue"><span class="header-section-number">3.2</span> Simulation 2 for energy revenue</a></li>
  <li><a href="#plotting-revenue-from-energy-production" id="toc-plotting-revenue-from-energy-production" class="nav-link" data-scroll-target="#plotting-revenue-from-energy-production"><span class="header-section-number">3.3</span> Plotting revenue from energy production</a>
  <ul class="collapse">
  <li><a href="#breakdown-by-number-of-solar-panels" id="toc-breakdown-by-number-of-solar-panels" class="nav-link" data-scroll-target="#breakdown-by-number-of-solar-panels"><span class="header-section-number">3.3.1</span> Breakdown by number of solar panels</a></li>
  <li><a href="#breakdown-by-proportion-of-land-under-solar-panels" id="toc-breakdown-by-proportion-of-land-under-solar-panels" class="nav-link" data-scroll-target="#breakdown-by-proportion-of-land-under-solar-panels"><span class="header-section-number">3.3.2</span> Breakdown by proportion of land under solar panels</a></li>
  </ul></li>
  <li><a href="#solar-system-cost" id="toc-solar-system-cost" class="nav-link" data-scroll-target="#solar-system-cost"><span class="header-section-number">3.4</span> Solar system cost</a></li>
  <li><a href="#profit-from-solar" id="toc-profit-from-solar" class="nav-link" data-scroll-target="#profit-from-solar"><span class="header-section-number">3.5</span> Profit from solar</a>
  <ul class="collapse">
  <li><a href="#plot-solar-profit" id="toc-plot-solar-profit" class="nav-link" data-scroll-target="#plot-solar-profit"><span class="header-section-number">3.5.1</span> Plot Solar profit</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#profit-from-crops" id="toc-profit-from-crops" class="nav-link" data-scroll-target="#profit-from-crops"><span class="header-section-number">4</span> Profit from crops</a>
  <ul class="collapse">
  <li><a href="#tomato-1" id="toc-tomato-1" class="nav-link" data-scroll-target="#tomato-1"><span class="header-section-number">4.1</span> Tomato</a>
  <ul class="collapse">
  <li><a href="#plot-tomato-profit" id="toc-plot-tomato-profit" class="nav-link" data-scroll-target="#plot-tomato-profit"><span class="header-section-number">4.1.1</span> Plot Tomato Profit</a></li>
  </ul></li>
  <li><a href="#strawberry-1" id="toc-strawberry-1" class="nav-link" data-scroll-target="#strawberry-1"><span class="header-section-number">4.2</span> Strawberry</a>
  <ul class="collapse">
  <li><a href="#plot-strawberry-profit" id="toc-plot-strawberry-profit" class="nav-link" data-scroll-target="#plot-strawberry-profit"><span class="header-section-number">4.2.1</span> Plot Strawberry Profit</a></li>
  </ul></li>
  <li><a href="#squash-1" id="toc-squash-1" class="nav-link" data-scroll-target="#squash-1"><span class="header-section-number">4.3</span> Squash</a>
  <ul class="collapse">
  <li><a href="#profit-from-squash" id="toc-profit-from-squash" class="nav-link" data-scroll-target="#profit-from-squash"><span class="header-section-number">4.3.1</span> Profit from squash:</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#profit-from-agrivoltaics" id="toc-profit-from-agrivoltaics" class="nav-link" data-scroll-target="#profit-from-agrivoltaics"><span class="header-section-number">5</span> Profit from agrivoltaics</a>
  <ul class="collapse">
  <li><a href="#profit-from-tomato-agrivoltaic-system" id="toc-profit-from-tomato-agrivoltaic-system" class="nav-link" data-scroll-target="#profit-from-tomato-agrivoltaic-system"><span class="header-section-number">5.1</span> Profit from tomato agrivoltaic system</a>
  <ul class="collapse">
  <li><a href="#saving-results-locally" id="toc-saving-results-locally" class="nav-link" data-scroll-target="#saving-results-locally"><span class="header-section-number">5.1.1</span> Saving results locally</a></li>
  </ul></li>
  <li><a href="#profit-from-strawberry-agrivoltaic-system" id="toc-profit-from-strawberry-agrivoltaic-system" class="nav-link" data-scroll-target="#profit-from-strawberry-agrivoltaic-system"><span class="header-section-number">5.2</span> Profit from strawberry agrivoltaic system</a>
  <ul class="collapse">
  <li><a href="#saving-results-locally-1" id="toc-saving-results-locally-1" class="nav-link" data-scroll-target="#saving-results-locally-1"><span class="header-section-number">5.2.1</span> Saving results locally</a></li>
  </ul></li>
  <li><a href="#profit-from-squash-agrivoltaic-system" id="toc-profit-from-squash-agrivoltaic-system" class="nav-link" data-scroll-target="#profit-from-squash-agrivoltaic-system"><span class="header-section-number">5.3</span> Profit from squash agrivoltaic system</a>
  <ul class="collapse">
  <li><a href="#saving-results-locally-2" id="toc-saving-results-locally-2" class="nav-link" data-scroll-target="#saving-results-locally-2"><span class="header-section-number">5.3.1</span> Saving results locally</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Simulation.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li><li><a href="Simulation.ipynb" download="Simulation.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Choice Paper Simulation</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bijesh Mishra, Ph.D. </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div style="page-break-after: always;"></div>
<p>Techno-economic analysis of agrivoltaic systems in Alabama. A paper for <a href="https://www.aaea.org/publications/choices-magazine" class="uri">Choice Magazine</a>, AAEA.</p>
<section id="setting-up" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Setting Up</h1>
<section id="housekeeping" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="housekeeping"><span class="header-section-number">1.1</span> Housekeeping</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clean the environment.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">warn=</span><span class="dv">0</span>, <span class="co"># Warnings. options(warn=-1) / options(warn=0)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">scipen=</span><span class="dv">999</span> <span class="co"># No scientific notations.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="working-directory" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="working-directory"><span class="header-section-number">1.2</span> Working directory</h2>
<p>Codes and output are suppressed. Errors and warnings are visible. No warning and no error means code is working as it should.</p>
</section>
<section id="load-libraries" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="load-libraries"><span class="header-section-number">1.3</span> Load libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(likert,  <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Likert Items</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice,  <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx2, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Scatter plot</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels,  <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Crosstab</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Reshape data</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman,  <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Package Management</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(progress, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co">#progress bar</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arrow, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co">#progress bar</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some features are not enabled in this build of Arrow. Run `arrow_info()` for more information.
The repository you retrieved Arrow from did not include all of Arrow's features.
You can install a fully-featured version by running:
`install.packages('arrow', repos = 'https://apache.r-universe.dev')`.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_loaded</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "arrow"     "progress"  "pacman"    "reshape2"  "gmodels"   "ggpubr"   
 [7] "openxlsx2" "mice"      "likert"    "xtable"    "psych"     "lubridate"
[13] "forcats"   "stringr"   "dplyr"     "purrr"     "readr"     "tidyr"    
[19] "tibble"    "ggplot2"   "tidyverse"</code></pre>
</div>
</div>
</section>
<section id="progress-bar" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="progress-bar"><span class="header-section-number">1.4</span> Progress Bar</h2>
<p>Tracking data processing progress. Code and results supressed.</p>
</section>
<section id="theme-for-plots" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="theme-for-plots"><span class="header-section-number">1.5</span> Theme for plots</h2>
<p>Setting theme for plots:</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2
3.5.0.
ℹ Please use the `legend.position.inside` argument of `theme()` instead.</code></pre>
</div>
</div>
</section>
</section>
<section id="import-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Import data</h1>
<p>Import necessary data.</p>
<section id="tomato" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="tomato"><span class="header-section-number">2.1</span> Tomato</h2>
<ul>
<li><p>Yield = Total tomato production (total bucket of 25 lb) from 1 acres of land which varies from 10% to 200% of total production (100%). The range was simulated by multiplying 100% yield by yldvar.</p></li>
<li><p>yldvar = Yield variation parameter ranges from 10% to 200%.</p></li>
<li><p>Rev17 to Rev23 = Revenue for price ranges of $17 to $23 per bucket of tomato.</p></li>
<li><p>Total cost = Total cost of production for the given yield.</p></li>
<li><p>rolac17 to rolac23= Return to operator, labor and capital for price range of $17 to $23.</p></li>
<li><p>operator Cost = Operator labor cost at $15/hour for given yield. For 100% yield, total hours = 90.</p></li>
<li><p>rlc17 to 23 = Return to land and capital after subtracting operator cost from total revenue.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tomato <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"Data/Parameters.xlsx"</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">"Tomato"</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">start_row =</span> <span class="dv">2</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">start_col =</span> <span class="dv">9</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">skip_empty_rows =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">skip_empty_cols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">yield =</span> Yield,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">yldvar =</span> <span class="st">`</span><span class="at">Yield Variation (%)</span><span class="st">`</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(tomato)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21 25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tomato)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   21 obs. of  25 variables:
 $ yldvar       : num  2 1.9 1.8 1.7 1.6 1.5 1.4 1.3 1.2 1.1 ...
 $ yield        : num  2720 2584 2448 2312 2176 ...
 $ Rev17        : num  46240 43928 41616 39304 36992 ...
 $ Rev18        : num  48960 46512 44064 41616 39168 ...
 $ Rev19        : num  51680 49096 46512 43928 41344 ...
 $ Rev20        : num  54400 51680 48960 46240 43520 ...
 $ Rev21        : num  57120 54264 51408 48552 45696 ...
 $ Rev22        : num  59840 56848 53856 50864 47872 ...
 $ Rev23        : num  62560 59432 56304 53176 50048 ...
 $ Total Cost   : num  24561 23863 23165 22467 21769 ...
 $ rolac17      : num  21679 20065 18451 16837 15223 ...
 $ rolac18      : num  24399 22649 20899 19149 17399 ...
 $ rolac19      : num  27119 25233 23347 21461 19575 ...
 $ rolac20      : num  29839 27817 25795 23773 21751 ...
 $ rolac21      : num  32559 30401 28243 26085 23927 ...
 $ rolac22      : num  35279 32985 30691 28397 26103 ...
 $ rolac23      : num  37999 35569 33139 30709 28279 ...
 $ Operator Cost: num  2700 2565 2430 2295 2160 ...
 $ rlc17        : num  18979 17500 16021 14542 13063 ...
 $ rlc18        : num  21699 20084 18469 16854 15239 ...
 $ rlc19        : num  24419 22668 20917 19166 17415 ...
 $ rlc20        : num  27139 25252 23365 21478 19591 ...
 $ rlc21        : num  29859 27836 25813 23790 21767 ...
 $ rlc22        : num  32579 30420 28261 26102 23943 ...
 $ rlc223       : num  35299 33004 30709 28414 26119 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tomato)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar yield Rev17 Rev18 Rev19 Rev20 Rev21 Rev22 Rev23 Total Cost  rolac17
3    2.0  2720 46240 48960 51680 54400 57120 59840 62560   24560.62 21679.38
4    1.9  2584 43928 46512 49096 51680 54264 56848 59432   23862.62 20065.38
5    1.8  2448 41616 44064 46512 48960 51408 53856 56304   23164.62 18451.38
6    1.7  2312 39304 41616 43928 46240 48552 50864 53176   22466.62 16837.38
7    1.6  2176 36992 39168 41344 43520 45696 47872 50048   21768.62 15223.38
8    1.5  2040 34680 36720 38760 40800 42840 44880 46920   21070.62 13609.38
   rolac18  rolac19  rolac20  rolac21  rolac22  rolac23 Operator Cost    rlc17
3 24399.38 27119.38 29839.38 32559.38 35279.38 37999.38          2700 18979.38
4 22649.38 25233.38 27817.38 30401.38 32985.38 35569.38          2565 17500.38
5 20899.38 23347.38 25795.38 28243.38 30691.38 33139.38          2430 16021.38
6 19149.38 21461.38 23773.38 26085.38 28397.38 30709.38          2295 14542.38
7 17399.38 19575.38 21751.38 23927.38 26103.38 28279.38          2160 13063.38
8 15649.38 17689.38 19729.38 21769.38 23809.38 25849.38          2025 11584.38
     rlc18    rlc19    rlc20    rlc21    rlc22   rlc223
3 21699.38 24419.38 27139.38 29859.38 32579.38 35299.38
4 20084.38 22668.38 25252.38 27836.38 30420.38 33004.38
5 18469.38 20917.38 23365.38 25813.38 28261.38 30709.38
6 16854.38 19166.38 21478.38 23790.38 26102.38 28414.38
7 15239.38 17415.38 19591.38 21767.38 23943.38 26119.38
8 13624.38 15664.38 17704.38 19744.38 21784.38 23824.38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(tomato)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar yield Rev17 Rev18 Rev19 Rev20 Rev21 Rev22 Rev23 Total Cost    rolac17
18    0.5   680 11560 12240 12920 13600 14280 14960 15640   14090.62  -2530.617
19    0.4   544  9248  9792 10336 10880 11424 11968 12512   13392.62  -4144.617
20    0.3   408  6936  7344  7752  8160  8568  8976  9384   12694.62  -5758.617
21    0.2   272  4624  4896  5168  5440  5712  5984  6256   11996.62  -7372.617
22    0.1   136  2312  2448  2584  2720  2856  2992  3128   11298.62  -8986.617
23    0.0     0     0     0     0     0     0     0     0   10600.62 -10600.617
      rolac18    rolac19     rolac20     rolac21     rolac22     rolac23
18  -1850.617  -1170.617   -490.6174    189.3826    869.3826   1549.3826
19  -3600.617  -3056.617  -2512.6174  -1968.6174  -1424.6174   -880.6174
20  -5350.617  -4942.617  -4534.6174  -4126.6174  -3718.6174  -3310.6174
21  -7100.617  -6828.617  -6556.6174  -6284.6174  -6012.6174  -5740.6174
22  -8850.617  -8714.617  -8578.6174  -8442.6174  -8306.6174  -8170.6174
23 -10600.617 -10600.617 -10600.6174 -10600.6174 -10600.6174 -10600.6174
   Operator Cost      rlc17      rlc18      rlc19      rlc20       rlc21
18           675  -3205.617  -2525.617  -1845.617  -1165.617   -485.6174
19           540  -4684.617  -4140.617  -3596.617  -3052.617  -2508.6174
20           405  -6163.617  -5755.617  -5347.617  -4939.617  -4531.6174
21           270  -7642.617  -7370.617  -7098.617  -6826.617  -6554.6174
22           135  -9121.617  -8985.617  -8849.617  -8713.617  -8577.6174
23             0 -10600.617 -10600.617 -10600.617 -10600.617 -10600.6174
         rlc22      rlc223
18    194.3826    874.3826
19  -1964.6174  -1420.6174
20  -4123.6174  -3715.6174
21  -6282.6174  -6010.6174
22  -8441.6174  -8305.6174
23 -10600.6174 -10600.6174</code></pre>
</div>
</div>
</section>
<section id="strawberry" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="strawberry"><span class="header-section-number">2.2</span> Strawberry</h2>
<ul>
<li><p>Everything same as tomato.</p></li>
<li><p>Numbers 3 to 9 in names are price ranges for strawberry.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>strawberry <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"Data/Parameters.xlsx"</span>,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sheet =</span> <span class="st">"Strawberry"</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">start_row =</span> <span class="dv">2</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">start_col =</span> <span class="dv">7</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">skip_empty_rows =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">skip_empty_cols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">yield =</span> Yield,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">yldvar =</span> <span class="st">`</span><span class="at">Yield Variation (%)</span><span class="st">`</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(strawberry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21 25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(strawberry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   21 obs. of  25 variables:
 $ yldvar       : num  2 1.9 1.8 1.7 1.6 1.5 1.4 1.3 1.2 1.1 ...
 $ yield        : num  6150 5842 5535 5228 4920 ...
 $ Rev3         : num  18450 17528 16605 15682 14760 ...
 $ Rev4         : num  24600 23370 22140 20910 19680 ...
 $ Rev5         : num  30750 29212 27675 26138 24600 ...
 $ Rev6         : num  36900 35055 33210 31365 29520 ...
 $ Rev7         : num  43050 40898 38745 36592 34440 ...
 $ Rev8         : num  49200 46740 44280 41820 39360 ...
 $ Rev9         : num  55350 52582 49815 47048 44280 ...
 $ Total Cost   : num  20190 19845 19499 19154 18808 ...
 $ rolac3       : num  -1740 -2317 -2894 -3471 -4048 ...
 $ rolac4       : num  4410 3525 2641 1756 872 ...
 $ rolac5       : num  10560 9368 8176 6984 5792 ...
 $ rolac6       : num  16710 15210 13711 12211 10712 ...
 $ rolac7       : num  22860 21053 19246 17439 15632 ...
 $ rolac8       : num  29010 26895 24781 22666 20552 ...
 $ rolac9       : num  35160 32738 30316 27894 25472 ...
 $ Operator Cost: num  2700 2565 2430 2295 2160 ...
 $ rlc3         : num  -4440 -4882 -5324 -5766 -6208 ...
 $ rlc4         : num  1710 960 211 -539 -1288 ...
 $ rlc5         : num  7860 6803 5746 4689 3632 ...
 $ rlc6         : num  14010 12645 11281 9916 8552 ...
 $ rlc7         : num  20160 18488 16816 15144 13472 ...
 $ rlc8         : num  26310 24330 22351 20371 18392 ...
 $ rlc9         : num  32460 30173 27886 25599 23312 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(strawberry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar  yield    Rev3  Rev4    Rev5  Rev6    Rev7  Rev8    Rev9 Total Cost
3    2.0 6150.0 18450.0 24600 30750.0 36900 43050.0 49200 55350.0   20190.49
4    1.9 5842.5 17527.5 23370 29212.5 35055 40897.5 46740 52582.5   19844.85
5    1.8 5535.0 16605.0 22140 27675.0 33210 38745.0 44280 49815.0   19499.20
6    1.7 5227.5 15682.5 20910 26137.5 31365 36592.5 41820 47047.5   19153.56
7    1.6 4920.0 14760.0 19680 24600.0 29520 34440.0 39360 44280.0   18807.91
8    1.5 4612.5 13837.5 18450 23062.5 27675 32287.5 36900 41512.5   18462.27
     rolac3     rolac4    rolac5   rolac6   rolac7   rolac8   rolac9
3 -1740.495 4409.50503 10559.505 16709.51 22859.51 29009.51 35159.51
4 -2317.350 3525.15003  9367.650 15210.15 21052.65 26895.15 32737.65
5 -2894.205 2640.79503  8175.795 13710.80 19245.80 24780.80 30315.80
6 -3471.060 1756.44003  6983.940 12211.44 17438.94 22666.44 27893.94
7 -4047.915  872.08503  5792.085 10712.09 15632.09 20552.09 25472.09
8 -4624.770  -12.26997  4600.230  9212.73 13825.23 18437.73 23050.23
  Operator Cost      rlc3      rlc4     rlc5      rlc6     rlc7     rlc8
3          2700 -4440.495  1709.505 7859.505 14009.505 20159.51 26309.51
4          2565 -4882.350   960.150 6802.650 12645.150 18487.65 24330.15
5          2430 -5324.205   210.795 5745.795 11280.795 16815.80 22350.80
6          2295 -5766.060  -538.560 4688.940  9916.440 15143.94 20371.44
7          2160 -6207.915 -1287.915 3632.085  8552.085 13472.09 18392.09
8          2025 -6649.770 -2037.270 2575.230  7187.730 11800.23 16412.73
      rlc9
3 32459.51
4 30172.65
5 27885.80
6 25598.94
7 23312.09
8 21025.23</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(strawberry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar  yield   Rev3 Rev4   Rev5 Rev6    Rev7  Rev8    Rev9 Total Cost
18    0.5 1537.5 4612.5 6150 7687.5 9225 10762.5 12300 13837.5   15005.82
19    0.4 1230.0 3690.0 4920 6150.0 7380  8610.0  9840 11070.0   14660.17
20    0.3  922.5 2767.5 3690 4612.5 5535  6457.5  7380  8302.5   14314.53
21    0.2  615.0 1845.0 2460 3075.0 3690  4305.0  4920  5535.0   13968.88
22    0.1  307.5  922.5 1230 1537.5 1845  2152.5  2460  2767.5   13623.24
23    0.0    0.0    0.0    0    0.0    0     0.0     0     0.0   13277.59
      rolac3     rolac4     rolac5     rolac6     rolac7     rolac8     rolac9
18 -10393.32  -8855.820  -7318.320  -5780.820  -4243.320  -2705.820  -1168.320
19 -10970.17  -9740.175  -8510.175  -7280.175  -6050.175  -4820.175  -3590.175
20 -11547.03 -10624.530  -9702.030  -8779.530  -7857.030  -6934.530  -6012.030
21 -12123.88 -11508.885 -10893.885 -10278.885  -9663.885  -9048.885  -8433.885
22 -12700.74 -12393.240 -12085.740 -11778.240 -11470.740 -11163.240 -10855.740
23 -13277.59 -13277.595 -13277.595 -13277.595 -13277.595 -13277.595 -13277.595
   Operator Cost      rlc3      rlc4       rlc5       rlc6       rlc7
18           675 -11068.32  -9530.82  -7993.320  -6455.820  -4918.320
19           540 -11510.17 -10280.17  -9050.175  -7820.175  -6590.175
20           405 -11952.03 -11029.53 -10107.030  -9184.530  -8262.030
21           270 -12393.88 -11778.88 -11163.885 -10548.885  -9933.885
22           135 -12835.74 -12528.24 -12220.740 -11913.240 -11605.740
23             0 -13277.59 -13277.59 -13277.595 -13277.595 -13277.595
         rlc8       rlc9
18  -3380.820  -1843.320
19  -5360.175  -4130.175
20  -7339.530  -6417.030
21  -9318.885  -8703.885
22 -11298.240 -10990.740
23 -13277.595 -13277.595</code></pre>
</div>
</div>
</section>
<section id="squash" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="squash"><span class="header-section-number">2.3</span> Squash</h2>
<ul>
<li><p>Everything same as tomato and strawberry.</p></li>
<li><p>Numbers 11 to 17 in names are price ranges for squash.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>squash <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"Data/Parameters.xlsx"</span>,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">"Squash"</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">start_row =</span> <span class="dv">2</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">start_col =</span> <span class="dv">8</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">skip_empty_rows =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">skip_empty_cols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">yield =</span> Yield,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">yldvar =</span> <span class="st">`</span><span class="at">Yield Variation (%)</span><span class="st">`</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(squash)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21 25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(squash)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar yield Rev11 Rev12 Rev13 Rev14 Rev15 Rev16 Rev17 Total Cost   rolac11
3    2.0  2180 23980 26160 28340 30520 32700 34880 37060   13670.88 10309.117
4    1.9  2071 22781 24852 26923 28994 31065 33136 35207   13173.63  9607.367
5    1.8  1962 21582 23544 25506 27468 29430 31392 33354   12676.38  8905.617
6    1.7  1853 20383 22236 24089 25942 27795 29648 31501   12179.13  8203.867
7    1.6  1744 19184 20928 22672 24416 26160 27904 29648   11681.88  7502.117
8    1.5  1635 17985 19620 21255 22890 24525 26160 27795   11184.63  6800.367
    rolac12  rolac13  rolac14  rolac15  rolac16  rolac17 Operator Cost    rlc11
3 12489.117 14669.12 16849.12 19029.12 21209.12 23389.12          2700 7609.117
4 11678.367 13749.37 15820.37 17891.37 19962.37 22033.37          2565 7042.367
5 10867.617 12829.62 14791.62 16753.62 18715.62 20677.62          2430 6475.617
6 10056.867 11909.87 13762.87 15615.87 17468.87 19321.87          2295 5908.867
7  9246.117 10990.12 12734.12 14478.12 16222.12 17966.12          2160 5342.117
8  8435.367 10070.37 11705.37 13340.37 14975.37 16610.37          2025 4775.367
     rlc12     rlc13     rlc14    rlc15    rlc16    rlc17
3 9789.117 11969.117 14149.117 16329.12 18509.12 20689.12
4 9113.367 11184.367 13255.367 15326.37 17397.37 19468.37
5 8437.617 10399.617 12361.617 14323.62 16285.62 18247.62
6 7761.867  9614.867 11467.867 13320.87 15173.87 17026.87
7 7086.117  8830.117 10574.117 12318.12 14062.12 15806.12
8 6410.367  8045.367  9680.367 11315.37 12950.37 14585.37</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(squash)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar yield Rev11 Rev12 Rev13 Rev14 Rev15 Rev16 Rev17 Total Cost   rolac11
18    0.5   545  5995  6540  7085  7630  8175  8720  9265   6212.133  -217.133
19    0.4   436  4796  5232  5668  6104  6540  6976  7412   5714.883  -918.883
20    0.3   327  3597  3924  4251  4578  4905  5232  5559   5217.633 -1620.633
21    0.2   218  2398  2616  2834  3052  3270  3488  3706   4720.383 -2322.383
22    0.1   109  1199  1308  1417  1526  1635  1744  1853   4223.133 -3024.133
23    0.0     0     0     0     0     0     0     0     0   3725.883 -3725.883
     rolac12     rolac13   rolac14   rolac15     rolac16   rolac17
18   327.867   872.86702  1417.867  1962.867  2507.86702  3052.867
19  -482.883   -46.88298   389.117   825.117  1261.11702  1697.117
20 -1293.633  -966.63298  -639.633  -312.633    14.36702   341.367
21 -2104.383 -1886.38298 -1668.383 -1450.383 -1232.38298 -1014.383
22 -2915.133 -2806.13298 -2697.133 -2588.133 -2479.13298 -2370.133
23 -3725.883 -3725.88298 -3725.883 -3725.883 -3725.88298 -3725.883
   Operator Cost     rlc11     rlc12     rlc13     rlc14     rlc15     rlc16
18           675  -892.133  -347.133   197.867   742.867  1287.867  1832.867
19           540 -1458.883 -1022.883  -586.883  -150.883   285.117   721.117
20           405 -2025.633 -1698.633 -1371.633 -1044.633  -717.633  -390.633
21           270 -2592.383 -2374.383 -2156.383 -1938.383 -1720.383 -1502.383
22           135 -3159.133 -3050.133 -2941.133 -2832.133 -2723.133 -2614.133
23             0 -3725.883 -3725.883 -3725.883 -3725.883 -3725.883 -3725.883
         rlc17
18  2377.86702
19  1157.11702
20   -63.63298
21 -1284.38298
22 -2505.13298
23 -3725.88298</code></pre>
</div>
</div>
</section>
<section id="electricity-price" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="electricity-price"><span class="header-section-number">2.4</span> Electricity price</h2>
<p>Electricity price ranges from 1 cents to 6 cents in 0.5 cent increment. Previously, I used AL retail electricity price as described below. It’s no longer in use but I put description below for the record.</p>
<p>Electricity price ($/kWh) was retail electricity price range for Alabama based on retail electricity price in April 2023 and April 2024 taken from <a href="https://www.eia.gov/electricity/monthly/epm_table_grapher.php?t=epmt_5_6_a">DOE Database</a>. Retail electricity price range in Alabama was from 6.44 to 15.85 cents/kWh in April 2023 and April 2024 which represents industry, commercial, and residential prices.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>elec_price <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"Data/Parameters.xlsx"</span>,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sheet =</span> <span class="st">"Electricity Price"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">epr_kwh =</span> <span class="st">`</span><span class="at">Electricity Price ($/kWh)</span><span class="st">`</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(elec_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(elec_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   11 obs. of  1 variable:
 $ epr_kwh: num  0.01 0.015 0.02 0.025 0.03 0.035 0.04 0.045 0.05 0.055 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>elec_price</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   epr_kwh
2    0.010
3    0.015
4    0.020
5    0.025
6    0.030
7    0.035
8    0.040
9    0.045
10   0.050
11   0.055
12   0.060</code></pre>
</div>
</div>
</section>
<section id="pv-system-cost" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="pv-system-cost"><span class="header-section-number">2.5</span> PV system cost</h2>
<ul>
<li>Data taken from “<a href="https://www.nrel.gov/docs/fy21osti/77811.pdf" class="uri">Capital Costs for Dual-Use Photovoltaic Installations: 2020 Benchmark</a>” Table 1 and Figure 3.</li>
<li>This data was used to estimate CAPEX.</li>
<li>avtyps = agrivoltaic types.</li>
<li>item = itemized component of system.</li>
<li>cost = cost of each item.</li>
<li>height = ground to panel clearance height (ft.)</li>
<li>tcost = Total cost is the sum of all itemized cost for AV system. See figure 3 and table 1 in above document for more detail.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>pvsc <span class="ot">&lt;-</span> <span class="fu">wb_read</span>(<span class="at">file =</span> <span class="st">"Data/Parameters.xlsx"</span>,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">sheet =</span> <span class="st">"PV system Cost (NREL)"</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">rows =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">109</span>),</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">cols =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">avtyps =</span> <span class="st">`</span><span class="at">AV Types</span><span class="st">`</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">item =</span> Item,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">cost =</span> <span class="st">`</span><span class="at">Cost ($/W)</span><span class="st">`</span>,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">height =</span> <span class="st">`</span><span class="at">Panel Height (ft.)</span><span class="st">`</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">tcost =</span> <span class="st">`</span><span class="at">Total Cost ($/W)</span><span class="st">`</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pvsc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 108   5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(pvsc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   108 obs. of  5 variables:
 $ avtyps: chr  "Typical Fixed PV" "Typical Fixed PV" "Typical Fixed PV" "Typical Fixed PV" ...
 $ item  : chr  "EPC/Developer Net Profit" "Developer Overhead" "Contingency(3%)" "Interconnection Fee" ...
 $ cost  : num  0.11 0.15 0.05 0.03 0.02 0.05 0.12 0.18 0.24 0.11 ...
 $ height: num  4.6 4.6 4.6 4.6 4.6 4.6 4.6 4.6 4.6 4.6 ...
 $ tcost : num  1.53 1.53 1.53 1.53 1.53 1.53 1.53 1.53 1.53 1.53 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pvsc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            avtyps                     item cost height tcost
2 Typical Fixed PV EPC/Developer Net Profit 0.11    4.6  1.53
3 Typical Fixed PV       Developer Overhead 0.15    4.6  1.53
4 Typical Fixed PV          Contingency(3%) 0.05    4.6  1.53
5 Typical Fixed PV      Interconnection Fee 0.03    4.6  1.53
6 Typical Fixed PV  Permitting Fee (if any) 0.02    4.6  1.53
7 Typical Fixed PV        Sale Tax (if any) 0.05    4.6  1.53</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(pvsc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                   avtyps                        item cost
104 PV + Crops (Reinforced Regular Mount)                EPC Overhead 0.25
105 PV + Crops (Reinforced Regular Mount) Installation and Labor Cost 0.32
106 PV + Crops (Reinforced Regular Mount)              Electrical BOS 0.38
107 PV + Crops (Reinforced Regular Mount)              Structural BOS 0.32
108 PV + Crops (Reinforced Regular Mount)               Inverter Only 0.08
109 PV + Crops (Reinforced Regular Mount)                      Module 0.40
    height tcost
104    8.2  2.33
105    8.2  2.33
106    8.2  2.33
107    8.2  2.33
108    8.2  2.33
109    8.2  2.33</code></pre>
</div>
</div>
</section>
<section id="capex-nrel" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="capex-nrel"><span class="header-section-number">2.6</span> Capex (NREL)</h2>
<p>Variable Descriptions:</p>
<ul>
<li><p>Capex: Capital investment cost ($/W) to develop solar energy system. Capex includes cost of physical structure, developer’s overhead and EPC/Developer’s net profit.</p></li>
<li><p>capex estimated as f(height, tracker) using OLS for 6.4 ft Tracking system.</p></li>
<li><p>Height = ground to panel clearance in ft.</p></li>
<li><p>array: Solar array. Tracker = Single axis sun tracking panels; Fixed = Non-tracking panels.</p></li>
<li><p>Source: <a href="https://www.nrel.gov/docs/fy21osti/77811.pdf">Horowitz, 2020. CAPEX AV.</a></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>capex <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">"Data/CAPEX.txt"</span>,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">capex =</span> cost,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">height =</span> pheight,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">array =</span> tracker)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(capex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(capex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   6 obs. of  3 variables:
 $ height: num  4.6 4.6 6.4 8.2 8.2 6.4
 $ capex : num  1.59 1.73 1.85 2.33 2.11 ...
 $ array : chr  "Fixed" "Tracking" "Fixed" "Fixed" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>capex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  height    capex    array
1    4.6 1.593333    Fixed
2    4.6 1.733333 Tracking
3    6.4 1.850000    Fixed
4    8.2 2.330000    Fixed
5    8.2 2.110000 Tracking
6    6.4 1.921667 Tracking</code></pre>
</div>
</div>
<section id="plotting-capex" class="level3" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="plotting-capex"><span class="header-section-number">2.6.1</span> Plotting capex</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>capex <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> height,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> capex,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> array,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> array</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the rounded capex values</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, capex)),</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.8</span>,</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">0.8</span>,</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">check_overlap =</span> <span class="cn">TRUE</span>,</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">+</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#title = "CAPEX Cost by Solar Panel Height",</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Solar Panel Clearance Height (ft.)"</span>,</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"CAPEX Cost ($/W)"</span>,</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Array Types:"</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">8.5</span>)) <span class="sc">+</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"grey"</span>,</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>),</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Fixed"</span> <span class="ot">=</span> <span class="st">"blue"</span>,</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Tracking"</span> <span class="ot">=</span> <span class="st">"red"</span>),</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Fixed Open Rack"</span>,</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Single Axis Rotation"</span>)</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/CpxPlt-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the plot</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"Plots/CAPEX Solar Panels.png"</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">8</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">6</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"in"</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="panel-configuration" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="panel-configuration"><span class="header-section-number">2.7</span> Panel Configuration</h2>
<ul>
<li>Panel configuration and DV system output (W).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>panconf <span class="ot">&lt;-</span> <span class="fu">wb_read</span>(<span class="at">file =</span> <span class="st">"Data/Parameters.xlsx"</span>,</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">sheet =</span> <span class="st">"Panel Spacing"</span>,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">start_row =</span> <span class="dv">2</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">start_col =</span> <span class="dv">1</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">skip_empty_rows =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">skip_empty_cols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rename(avtyps = `AV Types`,</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#        item = Item,</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#        cost = `Cost ($/W)`,</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#        height = `Panel Height (ft.)`,</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#        tcost = `Total Cost ($/W)`)</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(panconf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21 21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(panconf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   21 obs. of  21 variables:
 $ Total Area (Acre)              : num  1 1 1 1 1 1 1 1 1 1 ...
 $ Total Area (Sq. Ft.)           : num  43560 43560 43560 43560 43560 ...
 $ Solar Proportion               : num  1 0.95 0.9 0.85 0.8 0.75 0.7 0.65 0.6 0.55 ...
 $ Solar Proportion Area (Sq. Ft.): num  43560 41382 39204 37026 34848 ...
 $ Solar Proportion Area (Sq.M.)  : num  4047 3845 3642 3440 3237 ...
 $ Side Length (ft.)              : num  209 209 209 209 209 ...
 $ YSide Length (ft.)             : num  209 209 209 209 209 ...
 $ XSide length (ft.)             : num  209 198 188 177 167 ...
 $ Panel Length (ft.)             : num  7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 ...
 $ Row Seperator (ft.)            : num  6 6 6 6 6 6 6 6 6 6 ...
 $ Panel Width(ft.)               : num  3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 ...
 $ Panel Area (Sq. ft.)           : num  27.1 27.1 27.1 27.1 27.1 ...
 $ Panels/Row                     : num  59 59 59 59 59 59 59 59 59 59 ...
 $ Total Rows                     : num  15 14 13 12 12 11 10 9 9 8 ...
 $ Total Panels                   : num  885 826 767 708 708 649 590 531 531 472 ...
 $ Array Area (Sq. Ft.)           : num  24006 22405 20805 19204 19204 ...
 $ Array Area (Sq. M.)            : num  2230 2082 1933 1784 1784 ...
 $ XSide Open Length (ft)         : num  92 100 107 115 115 123 131 138 138 146 ...
 $ Inter Panel Spacing (ft)       : num  6 7 8 10 10 12 14 17 17 20 ...
 $ Panel Efficienfy               : num  0.19 0.19 0.19 0.19 0.19 0.19 0.19 0.19 0.19 0.19 ...
 $ DC System Size (kW)            : num  424 395 367 339 339 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(panconf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Total Area (Acre) Total Area (Sq. Ft.) Solar Proportion
3                 1                43560             1.00
4                 1                43560             0.95
5                 1                43560             0.90
6                 1                43560             0.85
7                 1                43560             0.80
8                 1                43560             0.75
  Solar Proportion Area (Sq. Ft.) Solar Proportion Area (Sq.M.)
3                           43560                      4046.856
4                           41382                      3844.513
5                           39204                      3642.170
6                           37026                      3439.828
7                           34848                      3237.485
8                           32670                      3035.142
  Side Length (ft.) YSide Length (ft.) XSide length (ft.) Panel Length (ft.)
3          208.7103           208.7103           208.7103               7.75
4          208.7103           208.7103           198.2748               7.75
5          208.7103           208.7103           187.8393               7.75
6          208.7103           208.7103           177.4038               7.75
7          208.7103           208.7103           166.9683               7.75
8          208.7103           208.7103           156.5327               7.75
  Row Seperator (ft.) Panel Width(ft.) Panel Area (Sq. ft.) Panels/Row
3                   6              3.5               27.125         59
4                   6              3.5               27.125         59
5                   6              3.5               27.125         59
6                   6              3.5               27.125         59
7                   6              3.5               27.125         59
8                   6              3.5               27.125         59
  Total Rows Total Panels Array Area (Sq. Ft.) Array Area (Sq. M.)
3         15          885             24005.62            2230.195
4         14          826             22405.25            2081.516
5         13          767             20804.88            1932.836
6         12          708             19204.50            1784.156
7         12          708             19204.50            1784.156
8         11          649             17604.12            1635.477
  XSide Open Length (ft) Inter Panel Spacing (ft) Panel Efficienfy
3                     92                        6             0.19
4                    100                        7             0.19
5                    107                        8             0.19
6                    115                       10             0.19
7                    115                       10             0.19
8                    123                       12             0.19
  DC System Size (kW)
3            423.7371
4            395.4880
5            367.2388
6            338.9897
7            338.9897
8            310.7405</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(panconf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Total Area (Acre) Total Area (Sq. Ft.) Solar Proportion
18                 1                43560             0.25
19                 1                43560             0.20
20                 1                43560             0.15
21                 1                43560             0.10
22                 1                43560             0.05
23                 1                43560             0.00
   Solar Proportion Area (Sq. Ft.) Solar Proportion Area (Sq.M.)
18                           10890                     1011.7140
19                            8712                      809.3712
20                            6534                      607.0284
21                            4356                      404.6856
22                            2178                      202.3428
23                               0                        0.0000
   Side Length (ft.) YSide Length (ft.) XSide length (ft.) Panel Length (ft.)
18          208.7103           208.7103           52.17758               7.75
19          208.7103           208.7103           41.74207               7.75
20          208.7103           208.7103           31.30655               7.75
21          208.7103           208.7103           20.87103               7.75
22          208.7103           208.7103           10.43552               7.75
23          208.7103           208.7103            0.00000               7.75
   Row Seperator (ft.) Panel Width(ft.) Panel Area (Sq. ft.) Panels/Row
18                   6              3.5               27.125         59
19                   6              3.5               27.125         59
20                   6              3.5               27.125         59
21                   6              3.5               27.125         59
22                   6              3.5               27.125         59
23                   6              3.5               27.125         59
   Total Rows Total Panels Array Area (Sq. Ft.) Array Area (Sq. M.)
18          3          177             4801.125            446.0391
19          3          177             4801.125            446.0391
20          2          118             3200.750            297.3594
21          1           59             1600.375            148.6797
22          0            0                0.000              0.0000
23          0            0                0.000              0.0000
   XSide Open Length (ft) Inter Panel Spacing (ft) Panel Efficienfy
18                    185                       92             0.19
19                    185                       92             0.19
20                    193                      193             0.19
21                    200                       NA             0.19
22                    208                       NA             0.19
23                    208                       NA             0.19
   DC System Size (kW)
18            84.74742
19            84.74742
20            56.49828
21            28.24914
22             0.00000
23             0.00000</code></pre>
</div>
</div>
</section>
<section id="energy-output" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="energy-output"><span class="header-section-number">2.8</span> Energy output</h2>
<p>Energy output was simulated using NREL <a href="https://pvwatts.nrel.gov/pvwatts.php" class="uri">PV Watts Calculator</a>.</p>
<ul>
<li><p>sprop = land proportion covered by solar in 1 acres. Value ranges from 0 to 1.</p></li>
<li><p>Panels = Total number of panels in 1 acres of land.</p></li>
<li><p>datalot: 1 = first simulation done for four regions of AL; 2 = second simulation done for four regions of AL. Two simulations have two unique zipcodes for each simulated region.</p></li>
<li><p>al_regs = regions of Alabama</p></li>
<li><p>zips = zipcodes selected from each region of AL for simulation.</p></li>
<li><p>array = Fixed (open rack); 1AxisRot = 1 Axis Tracking. See above NREL tool for more detail.</p></li>
<li><p>dc_kw = DC system size, calculated for each solar panel heights considering solar panels efficiency and area covered by solar panels.</p></li>
<li><p>energy = total energy output ( kWh/Year) considering system parameters. Total hours considered by the model is 8,760 (See <a href="https://pvwatts.nrel.gov/pvwatts.php" class="uri">PV Watts Calculator</a> Results &gt; help (below the result) &gt; results &gt; download monthly or hourly results).</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>energy_output <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"Data/Parameters.xlsx"</span>, </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sheet =</span> <span class="st">"Energy Output"</span>,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">start_row =</span> <span class="dv">1</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">start_col =</span> <span class="dv">1</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">skip_empty_rows =</span> <span class="cn">TRUE</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">skip_empty_cols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sprop =</span> <span class="st">`</span><span class="at">Solar Proportion</span><span class="st">`</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">panels =</span> <span class="st">`</span><span class="at">Total Panels</span><span class="st">`</span>,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">datalot =</span> DataLot,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">al_regs =</span> <span class="st">`</span><span class="at">Region of AL</span><span class="st">`</span>,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">zips =</span> ZIPCODE,</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">array =</span> <span class="st">`</span><span class="at">Array Type</span><span class="st">`</span>,</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">dc_kw =</span> <span class="st">`</span><span class="at">DC System Size (kW)</span><span class="st">`</span>,</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">energy =</span> <span class="st">`</span><span class="at">Energy (kWh/Year)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">dc_kw =</span> <span class="fu">round</span>(dc_kw, <span class="dv">2</span>),</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#energy = energy*1000,  #kWh/Year converted to Wh/Year.</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">array =</span> <span class="fu">case_when</span>(</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>      array <span class="sc">==</span> <span class="st">"1AxisRot"</span> <span class="sc">~</span> <span class="st">"Tracking"</span>,</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>      array <span class="sc">==</span> <span class="st">"FixedOpen"</span> <span class="sc">~</span> <span class="st">"Fixed"</span>,</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> array)</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(energy_output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 336   8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(energy_output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   336 obs. of  8 variables:
 $ sprop  : num  1 1 1 1 1 1 1 1 0.95 0.95 ...
 $ panels : num  885 885 885 885 885 885 885 885 826 826 ...
 $ datalot: num  1 1 1 1 1 1 1 1 1 1 ...
 $ al_regs: chr  "Northern" "Northern" "Central" "Central" ...
 $ zips   : num  35801 35801 35223 35223 36117 ...
 $ array  : chr  "Tracking" "Fixed" "Tracking" "Fixed" ...
 $ dc_kw  : num  424 424 424 424 424 ...
 $ energy : num  672887 585225 668895 579758 728181 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(energy_output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop panels datalot    al_regs  zips    array  dc_kw energy
2     1    885       1   Northern 35801 Tracking 423.74 672887
3     1    885       1   Northern 35801    Fixed 423.74 585225
4     1    885       1    Central 35223 Tracking 423.74 668895
5     1    885       1    Central 35223    Fixed 423.74 579758
6     1    885       1 Black Belt 36117 Tracking 423.74 728181
7     1    885       1 Black Belt 36117    Fixed 423.74 629523</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(energy_output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    sprop panels datalot    al_regs  zips    array dc_kw energy
332     0      0       2    Central 35136 Tracking     0      0
333     0      0       2    Central 35136    Fixed     0      0
334     0      0       2 Black Belt 36040 Tracking     0      0
335     0      0       2 Black Belt 36040    Fixed     0      0
336     0      0       2   Southern 36507 Tracking     0      0
337     0      0       2   Southern 36507    Fixed     0      0</code></pre>
</div>
</div>
<section id="energy-output-by-solar-panels-counts" class="level3" data-number="2.8.1">
<h3 data-number="2.8.1" class="anchored" data-anchor-id="energy-output-by-solar-panels-counts"><span class="header-section-number">2.8.1</span> Energy output by solar panels counts</h3>
<p>Plotting Energy output by number of solar panels in one acres of AV system from fixed and single axis rotation system for two zipcodes (1, 2) within each of the four regions of AL.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>lox <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>, <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>array_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Single Axis Rotation"</span>, <span class="st">"Fixed Open Rack"</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>datalot_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Location 1"</span>, <span class="st">"Location 2"</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> energy_output,</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> al_regs,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> energy,</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#fill = energy,</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="fu">factor</span>(panels),</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> <span class="fu">factor</span>(panels))) <span class="sc">+</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(datalot<span class="sc">~</span>array) <span class="sc">+</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> lox,</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"Center"</span>, <span class="st">"B Belt"</span>, <span class="st">"South"</span>)) <span class="sc">+</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/EOBSPC-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="energy-output-by-dc-system-size" class="level3" data-number="2.8.2">
<h3 data-number="2.8.2" class="anchored" data-anchor-id="energy-output-by-dc-system-size"><span class="header-section-number">2.8.2</span> Energy output by DC System Size</h3>
<p>Plotting Energy output by DC System Size from fixed and single axis rotation system for two zipcodes (1, 2) within each of the four regions of AL.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>lox <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>, <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> energy_output,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> al_regs,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> energy,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#fill = energy,</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="fu">factor</span>(dc_kw),</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> <span class="fu">factor</span>(dc_kw))) <span class="sc">+</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(datalot<span class="sc">~</span>array) <span class="sc">+</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> lox,</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"Center"</span>, <span class="st">"B Belt"</span>, <span class="st">"South"</span>)) <span class="sc">+</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span><span class="dv">2</span>, <span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/EOBDCSS-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="solar-energy-calculation" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Solar Energy Calculation</h1>
<section id="simulation-1-for-energy-revenue" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="simulation-1-for-energy-revenue"><span class="header-section-number">3.1</span> Simulation 1 for energy revenue</h2>
<ul>
<li><p>elcprc = electricity price. See Electricity price data for more detail.</p></li>
<li><p>elcrev = Revenue from electricity for given electricity prices. See “energy output” and “electricity price” dataset for more details.</p></li>
<li><p>I filtered datalot 2–I did not take average of “energy” from datalot 1 and datalot 2– to minimize computation time.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frames if they are not already</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>matrix1 <span class="ot">&lt;-</span> energy_output  <span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sprop, al_regs, array, dc_kw, panels) <span class="sc">%&gt;%</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(datalot <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute mean of datalot 1 and datalot 2:</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">energy =</span> <span class="fu">mean</span>(energy),</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="co"># dimension of matrix is 168*6</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>matrix2 <span class="ot">&lt;-</span> elec_price <span class="co"># dimension of matrix is 11*1</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the result data frame</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="co"># energy_revenue &lt;- data.frame(matrix(nrow = 1848, ncol = 9))</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>energy_revenue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">nrow</span>(matrix2)<span class="sc">*</span><span class="fu">nrow</span>(matrix1),</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">ncol =</span> <span class="fu">ncol</span>(matrix2)<span class="sc">+</span><span class="fu">ncol</span>(matrix1)<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable to keep track of the row index in the result matrix</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>row_index <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each value of the second matrix</span></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(matrix2)) {</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop through each value of the second matrix</span></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(matrix1)) {</span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># First matrix, second matrix, combined two matrices.</span></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>    new_row <span class="ot">&lt;-</span> <span class="fu">c</span>(matrix1[j, ], </span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>                 matrix2[i, ], </span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>                 matrix1<span class="sc">$</span>energy[j] <span class="sc">*</span> matrix2<span class="sc">$</span>epr_kwh[i])</span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assign the new row to the result matrix</span></span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a>    energy_revenue[row_index, ] <span class="ot">&lt;-</span> new_row</span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Increment the row index</span></span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>    row_index <span class="ot">&lt;-</span> row_index <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Name the columns</span></span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(energy_revenue) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">colnames</span>(matrix1), <span class="st">"elcprc"</span>, <span class="st">"elcrev"</span>)</span>
<span id="cb71-37"><a href="#cb71-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-38"><a href="#cb71-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result</span></span>
<span id="cb71-39"><a href="#cb71-39" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(energy_revenue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1848    8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(energy_revenue); <span class="fu">tail</span>(energy_revenue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop    al_regs    array dc_kw panels energy elcprc elcrev
1     0 Black Belt    Fixed     0      0      0   0.01      0
2     0 Black Belt Tracking     0      0      0   0.01      0
3     0    Central    Fixed     0      0      0   0.01      0
4     0    Central Tracking     0      0      0   0.01      0
5     0   Northern    Fixed     0      0      0   0.01      0
6     0   Northern Tracking     0      0      0   0.01      0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     sprop  al_regs    array  dc_kw panels energy elcprc   elcrev
1843     1  Central    Fixed 423.74    885 594824   0.06 35689.44
1844     1  Central Tracking 423.74    885 688037   0.06 41282.22
1845     1 Northern    Fixed 423.74    885 574020   0.06 34441.20
1846     1 Northern Tracking 423.74    885 656889   0.06 39413.34
1847     1 Southern    Fixed 423.74    885 613342   0.06 36800.52
1848     1 Southern Tracking 423.74    885 712873   0.06 42772.38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for any NAs in the result</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">is.na</span>(energy_revenue))) {</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  na_indices <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">is.na</span>(energy_revenue), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"NAs found at rows:"</span>, <span class="fu">unique</span>(na_indices[, <span class="dv">1</span>])))</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"No NAs found in the result data frame."</span>)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "No NAs found in the result data frame."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(energy_revenue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1848    8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(energy_revenue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1848 obs. of  8 variables:
 $ sprop  : num  0 0 0 0 0 0 0 0 0.05 0.05 ...
 $ al_regs: chr  "Black Belt" "Black Belt" "Central" "Central" ...
 $ array  : chr  "Fixed" "Tracking" "Fixed" "Tracking" ...
 $ dc_kw  : num  0 0 0 0 0 0 0 0 0 0 ...
 $ panels : num  0 0 0 0 0 0 0 0 0 0 ...
 $ energy : num  0 0 0 0 0 0 0 0 0 0 ...
 $ elcprc : num  0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 ...
 $ elcrev : num  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(energy_revenue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop    al_regs    array dc_kw panels energy elcprc elcrev
1     0 Black Belt    Fixed     0      0      0   0.01      0
2     0 Black Belt Tracking     0      0      0   0.01      0
3     0    Central    Fixed     0      0      0   0.01      0
4     0    Central Tracking     0      0      0   0.01      0
5     0   Northern    Fixed     0      0      0   0.01      0
6     0   Northern Tracking     0      0      0   0.01      0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(energy_revenue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     sprop  al_regs    array  dc_kw panels energy elcprc   elcrev
1843     1  Central    Fixed 423.74    885 594824   0.06 35689.44
1844     1  Central Tracking 423.74    885 688037   0.06 41282.22
1845     1 Northern    Fixed 423.74    885 574020   0.06 34441.20
1846     1 Northern Tracking 423.74    885 656889   0.06 39413.34
1847     1 Southern    Fixed 423.74    885 613342   0.06 36800.52
1848     1 Southern Tracking 423.74    885 712873   0.06 42772.38</code></pre>
</div>
</div>
</section>
<section id="simulation-2-for-energy-revenue" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="simulation-2-for-energy-revenue"><span class="header-section-number">3.2</span> Simulation 2 for energy revenue</h2>
<p>This simulation has same result as above (Cross checking above code and output). Results are suppressed but errors and warnings are not. No error and no warnings means code is working as it should.</p>
</section>
<section id="plotting-revenue-from-energy-production" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="plotting-revenue-from-energy-production"><span class="header-section-number">3.3</span> Plotting revenue from energy production</h2>
<section id="breakdown-by-number-of-solar-panels" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="breakdown-by-number-of-solar-panels"><span class="header-section-number">3.3.1</span> Breakdown by number of solar panels</h3>
<p>I am using data from simulation 1 for this visualization. This code plots one chart per electricity cost. There are 11 electricity cost resulting into 11 charts. Electricity revenue is average revenue of first and second lots of simulation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>lox <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>, <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>array_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Single Axis Rotation"</span>, <span class="st">"Fixed Open Rack"</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>datalot_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Location 1"</span>, <span class="st">"Location 2"</span>)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">unique</span>(energy_revenue<span class="sc">$</span>elcprc)) {</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a> a <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> (energy_revenue <span class="sc">%&gt;%</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(elcprc <span class="sc">==</span> i)),</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span>al_regs,</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> elcrev,</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#fill = energy,</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="fu">factor</span>(panels),</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> <span class="fu">factor</span>(panels)))<span class="sc">+</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>array) <span class="sc">+</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> lox,</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"Center"</span>, <span class="st">"B Belt"</span>, <span class="st">"South"</span>)) <span class="sc">+</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span><span class="dv">2</span>, <span class="at">reverse =</span> <span class="cn">TRUE</span>))</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a> <span class="fu">cat</span>(<span class="st">"Electricity Price = "</span>, i)</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(a)</span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.01</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/BDBNSPs-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.015</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/BDBNSPs-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.02</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/BDBNSPs-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.025</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/BDBNSPs-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.03</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/BDBNSPs-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.035</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/BDBNSPs-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.04</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/BDBNSPs-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.045</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/BDBNSPs-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.05</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/BDBNSPs-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.055</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/BDBNSPs-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity Price =  0.06</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/BDBNSPs-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="breakdown-by-proportion-of-land-under-solar-panels" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="breakdown-by-proportion-of-land-under-solar-panels"><span class="header-section-number">3.3.2</span> Breakdown by proportion of land under solar panels</h3>
<ul>
<li>Two proportions may have same number of solar panels (Eg. 0.80 and 0.85, 0.20 and 0.25). So, total lines in the chart may not match with total number of legend levels. Some proportions are overlapping in the chart. See panel configuration for more detail.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>lox <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>, <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>array_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Single Axis Rotation"</span>, <span class="st">"Fixed Open Rack"</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>datalot_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Location 1"</span>, <span class="st">"Location 2"</span>)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">unique</span>(energy_revenue<span class="sc">$</span>elcprc)) {</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a> a <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> (energy_revenue <span class="sc">%&gt;%</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(elcprc <span class="sc">==</span> i)),</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span>al_regs,</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> elcrev,</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#fill = energy,</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="fu">factor</span>(sprop),</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> <span class="fu">factor</span>(sprop)))<span class="sc">+</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>array) <span class="sc">+</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> lox,</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"Center"</span>, <span class="st">"B Belt"</span>, <span class="st">"South"</span>)) <span class="sc">+</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">reverse =</span> <span class="cn">TRUE</span>))</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a> <span class="fu">cat</span>(<span class="st">"Electricity Price = "</span>, i)</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(a)</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="solar-system-cost" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="solar-system-cost"><span class="header-section-number">3.4</span> Solar system cost</h2>
<ul>
<li><p>Cost of solar energy system in agrivoltaic setting.</p></li>
<li><p>I used energy output per 7.75 ft.*3.5 ft. panel (545 w), capex ($/w), and total number of panels to get total cost for each height and panel tracking system.</p></li>
<li><p>height = height of solar panels; see capex dataset for details.</p></li>
<li><p>capex = capex from capex table; see capex dataset for details.</p></li>
<li><p>opex = Operational cost ($15/kW/Year); Source: <a href="https://www.nrel.gov/docs/fy22osti/83586.pdf">Ramasamy, 2022. PV Cost Benchmark</a></p></li>
<li><p>ttlcost = Total cost for given DC system size.</p></li>
<li><p>anncost = Annual payment to repay loan (<span class="math inline">\(P_{ann}\)</span>) = <span class="math inline">\(\frac{P_o(i(1 + i)^t)}{(1+i)^t - 1)}\)</span> , where <span class="math inline">\(P_o\)</span> = CAPEX loan burrowed to repay in <span class="math inline">\(t\)</span> years; <span class="math inline">\(t = 25\)</span>, and <span class="math inline">\(i\)</span> = annual interest rate at <span class="math inline">\(5\%\)</span>.</p></li>
<li><p>moncost = Monthly payment to repay loan (<span class="math inline">\(P_{mon}\)</span>) = <span class="math inline">\(\frac{P_o((i/12)(1 + (i/12))^{t*12})}{(1+(i/12))^{t*12} - 1)}\)</span>, where <span class="math inline">\(P_o\)</span> = CAPEX loan burrowed to repay in <span class="math inline">\(t\)</span> years; <span class="math inline">\(t = 25\)</span>, and <span class="math inline">\(i\)</span> = annual interest rate at <span class="math inline">\(5\%\)</span>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"energy_revenue dimension = "</span>, <span class="fu">dim</span>(energy_revenue)) <span class="co"># 1936*9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>energy_revenue dimension =  1848 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(energy_revenue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sprop"   "al_regs" "array"   "dc_kw"   "panels"  "energy"  "elcprc" 
[8] "elcrev" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"capex = "</span>, <span class="fu">dim</span>(capex)) <span class="co"># 6*3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>capex =  6 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(capex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "height" "capex"  "array" </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fl">0.07</span> <span class="co"># Discount/interest Rate</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">30</span> <span class="co"># Life Span of solar panels (Years)</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>expanded_data <span class="ot">&lt;-</span> energy_revenue <span class="sc">%&gt;%</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">each =</span> <span class="dv">3</span>))</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>capex_height <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">unique</span>(capex<span class="sc">$</span>height),</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">length.out =</span> <span class="fu">nrow</span>(energy_revenue))</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>energy_cost <span class="ot">=</span> <span class="fu">cbind</span>(expanded_data, capex_height) <span class="sc">%&gt;%</span> </span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">height =</span> capex_height)</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>energy_cost <span class="ot">&lt;-</span> <span class="fu">left_join</span>(energy_cost, </span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>                         capex, </span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"array"</span>, <span class="st">"height"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">landlease =</span> <span class="dv">1000</span>, <span class="co">#$/Acre/Year</span></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 7.75*3.5 sq.ft. panel energy output = 545 W.</span></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Operational cost (OPEX) = $15/kW-yr; 1 kW = 1,000W.</span></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Opex = 545*15/1000*panels,</span></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">ttlcost =</span> capex<span class="sc">*</span><span class="dv">545</span><span class="sc">*</span>panels,</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Renewable energy credit 6.60 $/MWh</span></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">recredit =</span> <span class="fl">6.60</span><span class="sc">/</span><span class="dv">1000</span><span class="sc">*</span>energy,</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Annualized using annual discount rate:</span></span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">annualizedcost =</span> ttlcost<span class="sc">*</span>(r<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>r)<span class="sc">**</span>n)<span class="sc">/</span>((<span class="dv">1</span><span class="sc">+</span>r)<span class="sc">**</span>n<span class="dv">-1</span>),</span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">monthlycost =</span> ttlcost<span class="sc">*</span></span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>      ((r<span class="sc">/</span><span class="dv">12</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>(r<span class="sc">/</span>n))<span class="sc">^</span>(n<span class="sc">*</span><span class="dv">12</span>))<span class="sc">/</span>((<span class="dv">1</span><span class="sc">+</span>(r<span class="sc">/</span><span class="dv">12</span>))<span class="sc">^</span>(n<span class="sc">*</span><span class="dv">12</span>)<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cost of Insurance = $5/$1000/Yr annualized capex</span></span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">inscst =</span> annualizedcost<span class="sc">*</span><span class="dv">5</span><span class="sc">/</span><span class="dv">1000</span>, <span class="co">#Cost </span></span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Operational cost = 3% of annualized capex</span></span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">opex =</span> <span class="dv">3</span><span class="sc">*</span>annualizedcost<span class="sc">/</span><span class="dv">100</span>, <span class="co"># Cost</span></span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># REAP Program = 50% of annualized capex</span></span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">reap =</span> <span class="dv">50</span><span class="sc">*</span>annualizedcost<span class="sc">/</span><span class="dv">100</span>, <span class="co"># Return</span></span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tax credit = 30% of annualized capex</span></span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">taxcredit =</span> <span class="dv">30</span><span class="sc">*</span>annualizedcost<span class="sc">/</span><span class="dv">100</span>, <span class="co"># Return </span></span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Monthalized using monthly discount rate:</span></span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">anncost =</span> annualizedcost <span class="sc">+</span> inscst <span class="sc">+</span> opex <span class="sc">-</span> reap <span class="sc">-</span> recredit,</span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">moncost =</span> monthlycost <span class="sc">+</span> (inscst <span class="sc">+</span> opex <span class="sc">-</span> reap <span class="sc">-</span> reccredit)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `mutate()`:
ℹ In argument: `moncost = monthlycost + (inscst + opex - reap -
  reccredit)/12`.
Caused by error:
! object 'reccredit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(energy_cost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5544    9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(energy_cost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   5544 obs. of  9 variables:
 $ sprop  : num  0 0 0 0 0 0 0 0 0 0 ...
 $ al_regs: chr  "Black Belt" "Black Belt" "Black Belt" "Black Belt" ...
 $ array  : chr  "Fixed" "Fixed" "Fixed" "Tracking" ...
 $ dc_kw  : num  0 0 0 0 0 0 0 0 0 0 ...
 $ panels : num  0 0 0 0 0 0 0 0 0 0 ...
 $ energy : num  0 0 0 0 0 0 0 0 0 0 ...
 $ elcprc : num  0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 ...
 $ elcrev : num  0 0 0 0 0 0 0 0 0 0 ...
 $ height : num  4.6 6.4 8.2 4.6 6.4 8.2 4.6 6.4 8.2 4.6 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(energy_cost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop    al_regs    array dc_kw panels energy elcprc elcrev height
1     0 Black Belt    Fixed     0      0      0   0.01      0    4.6
2     0 Black Belt    Fixed     0      0      0   0.01      0    6.4
3     0 Black Belt    Fixed     0      0      0   0.01      0    8.2
4     0 Black Belt Tracking     0      0      0   0.01      0    4.6
5     0 Black Belt Tracking     0      0      0   0.01      0    6.4
6     0 Black Belt Tracking     0      0      0   0.01      0    8.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(energy_cost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     sprop  al_regs    array  dc_kw panels energy elcprc   elcrev height
5539     1 Southern    Fixed 423.74    885 613342   0.06 36800.52    4.6
5540     1 Southern    Fixed 423.74    885 613342   0.06 36800.52    6.4
5541     1 Southern    Fixed 423.74    885 613342   0.06 36800.52    8.2
5542     1 Southern Tracking 423.74    885 712873   0.06 42772.38    4.6
5543     1 Southern Tracking 423.74    885 712873   0.06 42772.38    6.4
5544     1 Southern Tracking 423.74    885 712873   0.06 42772.38    8.2</code></pre>
</div>
</div>
</section>
<section id="profit-from-solar" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="profit-from-solar"><span class="header-section-number">3.5</span> Profit from solar</h2>
<p>Profit from solar energy system in agrivoltaic setting</p>
<ul>
<li>eprofit = profit from electricity after subtracting total cost (ttlcost) from total revenue (elcrev).</li>
<li>eannprof = annual profit from solar after subtracting annual loan repayment distributed over 25 years.</li>
<li>emonprof = monthly profit from solar after subtracting monthly loan repayment distributed over 25 years.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>solar_profit <span class="ot">&lt;-</span> energy_cost <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">eprofit =</span> elcrev <span class="sc">-</span> ttlcost,</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">eannprof =</span> elcrev <span class="sc">-</span> anncost <span class="sc">+</span> recredit,</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">emonprof =</span> elcrev<span class="sc">/</span><span class="dv">12</span> <span class="sc">-</span> moncost <span class="sc">+</span> recredit<span class="sc">/</span><span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `mutate()`:
ℹ In argument: `eprofit = elcrev - ttlcost`.
Caused by error:
! object 'ttlcost' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(solar_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'solar_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(solar_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in str(solar_profit): object 'solar_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(solar_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in head(solar_profit): object 'solar_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(solar_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in tail(solar_profit): object 'solar_profit' not found</code></pre>
</div>
</div>
<section id="plot-solar-profit" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="plot-solar-profit"><span class="header-section-number">3.5.1</span> Plot Solar profit</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>lox <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>, <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>array_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Single Axis Rotation"</span>, <span class="st">"Fixed Open Rack"</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>datalot_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Location 1"</span>, <span class="st">"Location 2"</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">unique</span>(solar_profit<span class="sc">$</span>elcprc)) {</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">=</span> <span class="fu">ggplot</span>(</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> (solar_profit <span class="sc">%&gt;%</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(elcprc <span class="sc">==</span> i)),</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> al_regs,</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> eannprof, <span class="co">#Annual Profit</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">#fill = energy,</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="fu">factor</span>(panels),</span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> <span class="fu">factor</span>(panels)</span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_grid</span>(height <span class="sc">~</span> array) <span class="sc">+</span></span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> lox,</span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"Center"</span>, </span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"B Belt"</span>, <span class="st">"South"</span>)) <span class="sc">+</span></span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">reverse =</span> <span class="cn">TRUE</span>))</span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Electricity Price = "</span>, i)</span>
<span id="cb127-25"><a href="#cb127-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(b)</span>
<span id="cb127-26"><a href="#cb127-26" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in unique(solar_profit$elcprc): object 'solar_profit' not found</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>lox <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>, <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>array_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Single Axis Rotation"</span>, <span class="st">"Fixed Open Rack"</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>datalot_levs <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Location 1"</span>, <span class="st">"Location 2"</span>)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">unique</span>(solar_profit<span class="sc">$</span>elcprc)) {</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">=</span> <span class="fu">ggplot</span>(</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> (solar_profit <span class="sc">%&gt;%</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(elcprc <span class="sc">==</span> i)),</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> al_regs,</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> emonprof, <span class="co">#Monthly Profit.</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">#fill = energy,</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="fu">factor</span>(panels),</span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> <span class="fu">factor</span>(panels)</span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_grid</span>(height <span class="sc">~</span> array) <span class="sc">+</span></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> lox,</span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"Center"</span>, </span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"B Belt"</span>, <span class="st">"South"</span>)) <span class="sc">+</span></span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">reverse =</span> <span class="cn">TRUE</span>))</span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Electricity Price = "</span>, i)</span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(b)</span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in unique(solar_profit$elcprc): object 'solar_profit' not found</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="profit-from-crops" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Profit from crops</h1>
<section id="tomato-1" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="tomato-1"><span class="header-section-number">4.1</span> Tomato</h2>
<p>Filter return to operator, land and capital profit from Tomato:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>tomato_profit <span class="ot">=</span> tomato <span class="sc">%&gt;%</span> </span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(yldvar, yield, </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>         rolac17, rolac18, rolac19, rolac20, </span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>         rolac21, rolac22, rolac23)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(tomato_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21  9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>tomato_profit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar yield     rolac17     rolac18     rolac19     rolac20     rolac21
3     2.0  2720  21679.3826  24399.3826  27119.3826  29839.3826  32559.3826
4     1.9  2584  20065.3826  22649.3826  25233.3826  27817.3826  30401.3826
5     1.8  2448  18451.3826  20899.3826  23347.3826  25795.3826  28243.3826
6     1.7  2312  16837.3826  19149.3826  21461.3826  23773.3826  26085.3826
7     1.6  2176  15223.3826  17399.3826  19575.3826  21751.3826  23927.3826
8     1.5  2040  13609.3826  15649.3826  17689.3826  19729.3826  21769.3826
9     1.4  1904  11995.3826  13899.3826  15803.3826  17707.3826  19611.3826
10    1.3  1768  10381.3826  12149.3826  13917.3826  15685.3826  17453.3826
11    1.2  1632   8767.3826  10399.3826  12031.3826  13663.3826  15295.3826
12    1.1  1496   7153.3826   8649.3826  10145.3826  11641.3826  13137.3826
13    1.0  1360   5539.3826   6899.3826   8259.3826   9619.3826  10979.3826
14    0.9  1224   3925.3826   5149.3826   6373.3826   7597.3826   8821.3826
15    0.8  1088   2311.3826   3399.3826   4487.3826   5575.3826   6663.3826
16    0.7   952    697.3826   1649.3826   2601.3826   3553.3826   4505.3826
17    0.6   816   -916.6174   -100.6174    715.3826   1531.3826   2347.3826
18    0.5   680  -2530.6174  -1850.6174  -1170.6174   -490.6174    189.3826
19    0.4   544  -4144.6174  -3600.6174  -3056.6174  -2512.6174  -1968.6174
20    0.3   408  -5758.6174  -5350.6174  -4942.6174  -4534.6174  -4126.6174
21    0.2   272  -7372.6174  -7100.6174  -6828.6174  -6556.6174  -6284.6174
22    0.1   136  -8986.6174  -8850.6174  -8714.6174  -8578.6174  -8442.6174
23    0.0     0 -10600.6174 -10600.6174 -10600.6174 -10600.6174 -10600.6174
       rolac22     rolac23
3   35279.3826  37999.3826
4   32985.3826  35569.3826
5   30691.3826  33139.3826
6   28397.3826  30709.3826
7   26103.3826  28279.3826
8   23809.3826  25849.3826
9   21515.3826  23419.3826
10  19221.3826  20989.3826
11  16927.3826  18559.3826
12  14633.3826  16129.3826
13  12339.3826  13699.3826
14  10045.3826  11269.3826
15   7751.3826   8839.3826
16   5457.3826   6409.3826
17   3163.3826   3979.3826
18    869.3826   1549.3826
19  -1424.6174   -880.6174
20  -3718.6174  -3310.6174
21  -6012.6174  -5740.6174
22  -8306.6174  -8170.6174
23 -10600.6174 -10600.6174</code></pre>
</div>
</div>
<p>Convert data to long format:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign column names for clarity</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tomato_profit) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"yldvar"</span>, <span class="st">"yield"</span>,</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac17"</span>, <span class="st">"rolac18"</span>, <span class="st">"rolac19"</span>,</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac20"</span>, <span class="st">"rolac21"</span>, <span class="st">"rolac22"</span>,</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac23"</span>)</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data frame from wide to long format</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>tomato_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(tomato_profit,</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"yldvar"</span>, <span class="st">"yield"</span>),</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">"rolac17"</span>, <span class="st">"rolac18"</span>, <span class="st">"rolac19"</span>,</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"rolac20"</span>, <span class="st">"rolac21"</span>, <span class="st">"rolac22"</span>,</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"rolac23"</span>),</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">variable.name =</span> <span class="st">"price"</span>,</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">value.name =</span> <span class="st">"profit"</span>)</span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the 'Price' column to numeric by extracting the number</span></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>tomato_long<span class="sc">$</span>price <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"rolac"</span>, <span class="st">""</span>, tomato_long<span class="sc">$</span>price))</span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a><span class="co"># View the resulting data frame</span></span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(tomato_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 147   4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tomato_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   147 obs. of  4 variables:
 $ yldvar: num  2 1.9 1.8 1.7 1.6 1.5 1.4 1.3 1.2 1.1 ...
 $ yield : num  2720 2584 2448 2312 2176 ...
 $ price : num  17 17 17 17 17 17 17 17 17 17 ...
 $ profit: num  21679 20065 18451 16837 15223 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tomato_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar yield price   profit
1    2.0  2720    17 21679.38
2    1.9  2584    17 20065.38
3    1.8  2448    17 18451.38
4    1.7  2312    17 16837.38
5    1.6  2176    17 15223.38
6    1.5  2040    17 13609.38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(tomato_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    yldvar yield price      profit
142    0.5   680    23   1549.3826
143    0.4   544    23   -880.6174
144    0.3   408    23  -3310.6174
145    0.2   272    23  -5740.6174
146    0.1   136    23  -8170.6174
147    0.0     0    23 -10600.6174</code></pre>
</div>
</div>
<section id="plot-tomato-profit" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="plot-tomato-profit"><span class="header-section-number">4.1.1</span> Plot Tomato Profit</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> tomato_long,</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> price,</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> profit,</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">factor</span>(yldvar),</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="fu">factor</span>(yield))) <span class="sc">+</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/PFT-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> tomato_long,</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> yield,</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> profit,</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#fill = yield,</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">factor</span>(price),</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="fu">factor</span>(price))) <span class="sc">+</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vertical dashed line is 100% yield</span></span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> tomato_long<span class="sc">$</span>yield[<span class="dv">11</span>],</span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a><span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="strawberry-1" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="strawberry-1"><span class="header-section-number">4.2</span> Strawberry</h2>
<p>Filter return to operator, land and capital profit from strawberry</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>strawberry_profit <span class="ot">=</span> strawberry <span class="sc">%&gt;%</span> </span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(yldvar, yield, </span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>         rolac3, rolac4, rolac5, rolac6, </span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>         rolac7, rolac8, rolac9)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(strawberry_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21  9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>strawberry_profit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar  yield     rolac3       rolac4     rolac5     rolac6     rolac7
3     2.0 6150.0  -1740.495   4409.50503  10559.505  16709.505  22859.505
4     1.9 5842.5  -2317.350   3525.15003   9367.650  15210.150  21052.650
5     1.8 5535.0  -2894.205   2640.79503   8175.795  13710.795  19245.795
6     1.7 5227.5  -3471.060   1756.44003   6983.940  12211.440  17438.940
7     1.6 4920.0  -4047.915    872.08503   5792.085  10712.085  15632.085
8     1.5 4612.5  -4624.770    -12.26997   4600.230   9212.730  13825.230
9     1.4 4305.0  -5201.625   -896.62497   3408.375   7713.375  12018.375
10    1.3 3997.5  -5778.480  -1780.97997   2216.520   6214.020  10211.520
11    1.2 3690.0  -6355.335  -2665.33497   1024.665   4714.665   8404.665
12    1.1 3382.5  -6932.190  -3549.68997   -167.190   3215.310   6597.810
13    1.0 3075.0  -7509.045  -4434.04497  -1359.045   1715.955   4790.955
14    0.9 2767.5  -8085.900  -5318.39997  -2550.900    216.600   2984.100
15    0.8 2460.0  -8662.755  -6202.75497  -3742.755  -1282.755   1177.245
16    0.7 2152.5  -9239.610  -7087.10997  -4934.610  -2782.110   -629.610
17    0.6 1845.0  -9816.465  -7971.46497  -6126.465  -4281.465  -2436.465
18    0.5 1537.5 -10393.320  -8855.81997  -7318.320  -5780.820  -4243.320
19    0.4 1230.0 -10970.175  -9740.17497  -8510.175  -7280.175  -6050.175
20    0.3  922.5 -11547.030 -10624.52997  -9702.030  -8779.530  -7857.030
21    0.2  615.0 -12123.885 -11508.88497 -10893.885 -10278.885  -9663.885
22    0.1  307.5 -12700.740 -12393.23997 -12085.740 -11778.240 -11470.740
23    0.0    0.0 -13277.595 -13277.59497 -13277.595 -13277.595 -13277.595
       rolac8     rolac9
3   29009.505  35159.505
4   26895.150  32737.650
5   24780.795  30315.795
6   22666.440  27893.940
7   20552.085  25472.085
8   18437.730  23050.230
9   16323.375  20628.375
10  14209.020  18206.520
11  12094.665  15784.665
12   9980.310  13362.810
13   7865.955  10940.955
14   5751.600   8519.100
15   3637.245   6097.245
16   1522.890   3675.390
17   -591.465   1253.535
18  -2705.820  -1168.320
19  -4820.175  -3590.175
20  -6934.530  -6012.030
21  -9048.885  -8433.885
22 -11163.240 -10855.740
23 -13277.595 -13277.595</code></pre>
</div>
</div>
<p>Convert data to long format:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign column names for clarity</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(strawberry_profit) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"yldvar"</span>, <span class="st">"yield"</span>,</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac3"</span>, <span class="st">"rolac4"</span>, <span class="st">"rolac5"</span>,</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac6"</span>, <span class="st">"rolac7"</span>, <span class="st">"rolac8"</span>,</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac9"</span>)</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data frame from wide to long format</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>stberry_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(strawberry_profit,</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"yldvar"</span>, <span class="st">"yield"</span>),</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">"rolac3"</span>, <span class="st">"rolac4"</span>, <span class="st">"rolac5"</span>,</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"rolac6"</span>, <span class="st">"rolac7"</span>, <span class="st">"rolac8"</span>,</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"rolac9"</span>),</span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">variable.name =</span> <span class="st">"price"</span>,</span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">value.name =</span> <span class="st">"profit"</span>)</span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the 'Price' column to numeric by extracting the number</span></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>stberry_long<span class="sc">$</span>price <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"rolac"</span>, <span class="st">""</span>, stberry_long<span class="sc">$</span>price))</span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a><span class="co"># View the resulting data frame</span></span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(stberry_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 147   4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(stberry_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   147 obs. of  4 variables:
 $ yldvar: num  2 1.9 1.8 1.7 1.6 1.5 1.4 1.3 1.2 1.1 ...
 $ yield : num  6150 5842 5535 5228 4920 ...
 $ price : num  3 3 3 3 3 3 3 3 3 3 ...
 $ profit: num  -1740 -2317 -2894 -3471 -4048 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(stberry_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar  yield price    profit
1    2.0 6150.0     3 -1740.495
2    1.9 5842.5     3 -2317.350
3    1.8 5535.0     3 -2894.205
4    1.7 5227.5     3 -3471.060
5    1.6 4920.0     3 -4047.915
6    1.5 4612.5     3 -4624.770</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(stberry_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    yldvar  yield price     profit
142    0.5 1537.5     9  -1168.320
143    0.4 1230.0     9  -3590.175
144    0.3  922.5     9  -6012.030
145    0.2  615.0     9  -8433.885
146    0.1  307.5     9 -10855.740
147    0.0    0.0     9 -13277.595</code></pre>
</div>
</div>
<section id="plot-strawberry-profit" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="plot-strawberry-profit"><span class="header-section-number">4.2.1</span> Plot Strawberry Profit</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stberry_long,</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> price,</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> profit,</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">factor</span>(yldvar),</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="fu">factor</span>(yield))) <span class="sc">+</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/PlotSBPBYv-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stberry_long,</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> yield,</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> profit,</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">factor</span>(price),</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="fu">factor</span>(price))) <span class="sc">+</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Vertical dashed line is 100% yield</span></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> stberry_long<span class="sc">$</span>yield[<span class="dv">11</span>],</span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/PlotSBPBP-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="squash-1" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="squash-1"><span class="header-section-number">4.3</span> Squash</h2>
<p>Filter return to operator, land and capital profit from squash</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>squash_profit <span class="ot">=</span> squash <span class="sc">%&gt;%</span> </span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(yldvar, yield, </span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>         rolac11, rolac12, rolac13, rolac14, </span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>         rolac15, rolac16, rolac17)</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>squash_profit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar yield   rolac11   rolac12     rolac13   rolac14   rolac15     rolac16
3     2.0  2180 10309.117 12489.117 14669.11702 16849.117 19029.117 21209.11702
4     1.9  2071  9607.367 11678.367 13749.36702 15820.367 17891.367 19962.36702
5     1.8  1962  8905.617 10867.617 12829.61702 14791.617 16753.617 18715.61702
6     1.7  1853  8203.867 10056.867 11909.86702 13762.867 15615.867 17468.86702
7     1.6  1744  7502.117  9246.117 10990.11702 12734.117 14478.117 16222.11702
8     1.5  1635  6800.367  8435.367 10070.36702 11705.367 13340.367 14975.36702
9     1.4  1526  6098.617  7624.617  9150.61702 10676.617 12202.617 13728.61702
10    1.3  1417  5396.867  6813.867  8230.86702  9647.867 11064.867 12481.86702
11    1.2  1308  4695.117  6003.117  7311.11702  8619.117  9927.117 11235.11702
12    1.1  1199  3993.367  5192.367  6391.36702  7590.367  8789.367  9988.36702
13    1.0  1090  3291.617  4381.617  5471.61702  6561.617  7651.617  8741.61702
14    0.9   981  2589.867  3570.867  4551.86702  5532.867  6513.867  7494.86702
15    0.8   872  1888.117  2760.117  3632.11702  4504.117  5376.117  6248.11702
16    0.7   763  1186.367  1949.367  2712.36702  3475.367  4238.367  5001.36702
17    0.6   654   484.617  1138.617  1792.61702  2446.617  3100.617  3754.61702
18    0.5   545  -217.133   327.867   872.86702  1417.867  1962.867  2507.86702
19    0.4   436  -918.883  -482.883   -46.88298   389.117   825.117  1261.11702
20    0.3   327 -1620.633 -1293.633  -966.63298  -639.633  -312.633    14.36702
21    0.2   218 -2322.383 -2104.383 -1886.38298 -1668.383 -1450.383 -1232.38298
22    0.1   109 -3024.133 -2915.133 -2806.13298 -2697.133 -2588.133 -2479.13298
23    0.0     0 -3725.883 -3725.883 -3725.88298 -3725.883 -3725.883 -3725.88298
     rolac17
3  23389.117
4  22033.367
5  20677.617
6  19321.867
7  17966.117
8  16610.367
9  15254.617
10 13898.867
11 12543.117
12 11187.367
13  9831.617
14  8475.867
15  7120.117
16  5764.367
17  4408.617
18  3052.867
19  1697.117
20   341.367
21 -1014.383
22 -2370.133
23 -3725.883</code></pre>
</div>
</div>
<p>Convert data to long format:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign column names for clarity</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(squash_profit) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"yldvar"</span>, <span class="st">"yield"</span>,</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac11"</span>, <span class="st">"rolac12"</span>, <span class="st">"rolac13"</span>,</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac14"</span>, <span class="st">"rolac15"</span>, <span class="st">"rolac16"</span>,</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"rolac17"</span>)</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data frame from wide to long format</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>squash_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(squash_profit,</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"yldvar"</span>, <span class="st">"yield"</span>),</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">"rolac11"</span>, <span class="st">"rolac12"</span>, <span class="st">"rolac13"</span>,</span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"rolac14"</span>, <span class="st">"rolac15"</span>, <span class="st">"rolac16"</span>,</span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"rolac17"</span>),</span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">variable.name =</span> <span class="st">"price"</span>,</span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">value.name =</span> <span class="st">"profit"</span>)</span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the 'Price' column to numeric by extracting the number</span></span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>squash_long<span class="sc">$</span>price <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"rolac"</span>, <span class="st">""</span>, squash_long<span class="sc">$</span>price))</span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a><span class="co"># View the resulting data frame</span></span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(squash_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 147   4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(squash_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   147 obs. of  4 variables:
 $ yldvar: num  2 1.9 1.8 1.7 1.6 1.5 1.4 1.3 1.2 1.1 ...
 $ yield : num  2180 2071 1962 1853 1744 ...
 $ price : num  11 11 11 11 11 11 11 11 11 11 ...
 $ profit: num  10309 9607 8906 8204 7502 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(squash_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar yield price    profit
1    2.0  2180    11 10309.117
2    1.9  2071    11  9607.367
3    1.8  1962    11  8905.617
4    1.7  1853    11  8203.867
5    1.6  1744    11  7502.117
6    1.5  1635    11  6800.367</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(squash_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    yldvar yield price    profit
142    0.5   545    17  3052.867
143    0.4   436    17  1697.117
144    0.3   327    17   341.367
145    0.2   218    17 -1014.383
146    0.1   109    17 -2370.133
147    0.0     0    17 -3725.883</code></pre>
</div>
</div>
<section id="profit-from-squash" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="profit-from-squash"><span class="header-section-number">4.3.1</span> Profit from squash:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> squash_long,</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> price,</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> profit,</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">factor</span>(yldvar),</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="fu">factor</span>(yield))) <span class="sc">+</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/PrftSQuash-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> squash_long,</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> yield,</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> profit,</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">factor</span>(price),</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="fu">factor</span>(price))) <span class="sc">+</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vertical dashed line is 100% yield</span></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> squash_long<span class="sc">$</span>yield[<span class="dv">11</span>],</span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Simulation_files/figure-html/SPFFTBP-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="profit-from-agrivoltaics" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Profit from agrivoltaics</h1>
<p>Total profit from solar and crops for all combinations of AVs simulated.</p>
<section id="profit-from-tomato-agrivoltaic-system" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="profit-from-tomato-agrivoltaic-system"><span class="header-section-number">5.1</span> Profit from tomato agrivoltaic system</h2>
<ul>
<li>Joint profit from tomato (tomato_long) and solar energy production (solar_profit) from 1 acre of land.</li>
<li>The last variable (tav_profit) is the final profit from tomato agrivoltaic system which is the result of our interest.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate all combinations of rows from both matrices in a vectorized way</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>solar_expanded <span class="ot">&lt;-</span> solar_profit[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(solar_profit), </span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">each =</span> <span class="fu">nrow</span>(tomato_long)), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'solar_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>tomato_expanded <span class="ot">&lt;-</span> tomato_long[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(tomato_long), </span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">times =</span> <span class="fu">nrow</span>(solar_profit)), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in nrow(solar_profit): object 'solar_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the new column for tav_profit directly</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>tav_profit_values <span class="ot">&lt;-</span> solar_expanded<span class="sc">$</span>eannprof <span class="sc">+</span> tomato_expanded<span class="sc">$</span>profit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'solar_expanded' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the matrices and the calculated tav_profit column</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>tav_profit <span class="ot">&lt;-</span> <span class="fu">cbind</span>(solar_expanded, </span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>                     tomato_expanded, </span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">tav_profit =</span> tav_profit_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in cbind(solar_expanded, tomato_expanded, tav_profit = tav_profit_values): object 'solar_expanded' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a data frame and ensure the correct format</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>tav_profit <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in as.data.frame(tav_profit): object 'tav_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>tav_profit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(tav_profit, unlist))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in lapply(tav_profit, unlist): object 'tav_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect the structure and data</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(tav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'tav_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in str(tav_profit): object 'tav_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in head(tav_profit): object 'tav_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(tav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in tail(tav_profit): object 'tav_profit' not found</code></pre>
</div>
</div>
<section id="saving-results-locally" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="saving-results-locally"><span class="header-section-number">5.1.1</span> Saving results locally</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_csv(tav_profit, "tav_profit.csv")</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_feather</span>(tav_profit,</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sink =</span> <span class="st">"Data/tav_profit.feather"</span>,</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">version =</span> <span class="dv">2</span>,</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">chunk_size =</span> <span class="dv">65536</span>L,</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">compression =</span> <span class="fu">c</span>(<span class="st">"default"</span>),</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#compression = c("default", "lz4", "lz4_frame", "uncompressed", "zstd"),</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">compression_level =</span> <span class="cn">NULL</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in write_feather(tav_profit, sink = "Data/tav_profit.feather", version = 2, : object 'tav_profit' not found</code></pre>
</div>
</div>
</section>
</section>
<section id="profit-from-strawberry-agrivoltaic-system" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="profit-from-strawberry-agrivoltaic-system"><span class="header-section-number">5.2</span> Profit from strawberry agrivoltaic system</h2>
<ul>
<li>Joint profit from strawberry (stberry_long) and solar energy production (solar_profit) from 1 acre of land.</li>
<li>The last variable (sbav_profit) is the final profit from strawberry agrivoltaic system which is the result of our interest.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate all combinations of rows from both matrices in a vectorized way</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>solar_expanded <span class="ot">&lt;-</span> solar_profit[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(solar_profit), </span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">each =</span> <span class="fu">nrow</span>(stberry_long)), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'solar_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>stberry_expanded <span class="ot">&lt;-</span> stberry_long[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(stberry_long),</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">times =</span> <span class="fu">nrow</span>(solar_profit)), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in nrow(solar_profit): object 'solar_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the new column for sbav_profit directly</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>sbav_profit_values <span class="ot">&lt;-</span> solar_expanded<span class="sc">$</span>eannprof <span class="sc">+</span> stberry_expanded<span class="sc">$</span>profit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'solar_expanded' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the matrices and the calculated sbav_profit column</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>sbav_profit <span class="ot">&lt;-</span> <span class="fu">cbind</span>(solar_expanded, </span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>                     stberry_expanded, </span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sbav_profit =</span> sbav_profit_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in cbind(solar_expanded, stberry_expanded, sbav_profit = sbav_profit_values): object 'solar_expanded' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a data frame and ensure the correct format</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>sbav_profit <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(sbav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in as.data.frame(sbav_profit): object 'sbav_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>sbav_profit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(sbav_profit, unlist))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in lapply(sbav_profit, unlist): object 'sbav_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect the structure and data</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sbav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'sbav_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(sbav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in str(sbav_profit): object 'sbav_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sbav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in head(sbav_profit): object 'sbav_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(sbav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in tail(sbav_profit): object 'sbav_profit' not found</code></pre>
</div>
</div>
<section id="saving-results-locally-1" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="saving-results-locally-1"><span class="header-section-number">5.2.1</span> Saving results locally</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_csv(sbav_profit, "tav_profit.csv")</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_feather</span>(sbav_profit,</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sink =</span> <span class="st">"Data/sbav_profit.feather"</span>,</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">version =</span> <span class="dv">2</span>,</span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">chunk_size =</span> <span class="dv">65536</span>L,</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">compression =</span> <span class="fu">c</span>(<span class="st">"default"</span>),</span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#compression = c("default", "lz4", "lz4_frame", "uncompressed", "zstd"),</span></span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">compression_level =</span> <span class="cn">NULL</span></span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in write_feather(sbav_profit, sink = "Data/sbav_profit.feather", : object 'sbav_profit' not found</code></pre>
</div>
</div>
</section>
</section>
<section id="profit-from-squash-agrivoltaic-system" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="profit-from-squash-agrivoltaic-system"><span class="header-section-number">5.3</span> Profit from squash agrivoltaic system</h2>
<ul>
<li>Joint profit from squash (squash_long) and solar energy production (solar_profit) from 1 acre of land.</li>
<li>The last variable (sqav_profit) is the final profit from squash agrivoltaic system which is the result of our interest.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Efficient calculation of all combinations of rows from both matrices</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>solar_expanded <span class="ot">&lt;-</span> solar_profit[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(solar_profit), </span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">each =</span> <span class="fu">nrow</span>(squash_long)), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'solar_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>squash_expanded <span class="ot">&lt;-</span> squash_long[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(squash_long), </span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">times =</span> <span class="fu">nrow</span>(solar_profit)), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in nrow(solar_profit): object 'solar_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the new column for sqav_profit directly</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>sqav_profit_values <span class="ot">&lt;-</span> solar_expanded<span class="sc">$</span>eannprof <span class="sc">+</span> squash_expanded<span class="sc">$</span>profit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'solar_expanded' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the matrices and the calculated sqav_profit column</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>sqav_profit <span class="ot">&lt;-</span> <span class="fu">cbind</span>(solar_expanded, </span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>                     squash_expanded, </span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sqav_profit =</span> sqav_profit_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in cbind(solar_expanded, squash_expanded, sqav_profit = sqav_profit_values): object 'solar_expanded' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a data frame and ensure the correct format</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>sqav_profit <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(sqav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in as.data.frame(sqav_profit): object 'sqav_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>sqav_profit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(sqav_profit, unlist))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in lapply(sqav_profit, unlist): object 'sqav_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect the structure and data</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sqav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'sqav_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(sqav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in str(sqav_profit): object 'sqav_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sqav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in head(sqav_profit): object 'sqav_profit' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(sqav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in tail(sqav_profit): object 'sqav_profit' not found</code></pre>
</div>
</div>
<section id="saving-results-locally-2" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="saving-results-locally-2"><span class="header-section-number">5.3.1</span> Saving results locally</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_csv(sqav_profit, "tav_profit.csv")</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_feather</span>(sqav_profit,</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sink =</span> <span class="st">"Data/sqav_profit.feather"</span>,</span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">version =</span> <span class="dv">2</span>,</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">chunk_size =</span> <span class="dv">65536</span>L,</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">compression =</span> <span class="fu">c</span>(<span class="st">"default"</span>),</span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#compression = c("default", "lz4", "lz4_frame", "uncompressed", "zstd"),</span></span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">compression_level =</span> <span class="cn">NULL</span></span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in write_feather(sqav_profit, sink = "Data/sqav_profit.feather", : object 'sqav_profit' not found</code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>