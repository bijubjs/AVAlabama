<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bijesh Mishra, Ph.D.">

<title>AV Profit</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="AV Profit_files/libs/clipboard/clipboard.min.js"></script>
<script src="AV Profit_files/libs/quarto-html/quarto.js"></script>
<script src="AV Profit_files/libs/quarto-html/popper.min.js"></script>
<script src="AV Profit_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="AV Profit_files/libs/quarto-html/anchor.min.js"></script>
<link href="AV Profit_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="AV Profit_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="AV Profit_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="AV Profit_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="AV Profit_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setting-up" id="toc-setting-up" class="nav-link active" data-scroll-target="#setting-up"><span class="header-section-number">1</span> Setting Up</a>
  <ul class="collapse">
  <li><a href="#housekeeping" id="toc-housekeeping" class="nav-link" data-scroll-target="#housekeeping"><span class="header-section-number">1.1</span> Housekeeping</a></li>
  <li><a href="#working-directory" id="toc-working-directory" class="nav-link" data-scroll-target="#working-directory"><span class="header-section-number">1.2</span> Working directory</a></li>
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries"><span class="header-section-number">1.3</span> Load libraries</a></li>
  <li><a href="#theme-for-plots" id="toc-theme-for-plots" class="nav-link" data-scroll-target="#theme-for-plots"><span class="header-section-number">1.4</span> Theme for plots</a></li>
  </ul></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="header-section-number">2</span> Import data</a>
  <ul class="collapse">
  <li><a href="#tomato-av" id="toc-tomato-av" class="nav-link" data-scroll-target="#tomato-av"><span class="header-section-number">2.1</span> Tomato AV</a></li>
  <li><a href="#calculate-tavp_wocp" id="toc-calculate-tavp_wocp" class="nav-link" data-scroll-target="#calculate-tavp_wocp"><span class="header-section-number">2.2</span> Calculate tavp_wocp</a></li>
  <li><a href="#strawberry-av" id="toc-strawberry-av" class="nav-link" data-scroll-target="#strawberry-av"><span class="header-section-number">2.3</span> Strawberry AV</a></li>
  <li><a href="#calculate-sbvp_wocp" id="toc-calculate-sbvp_wocp" class="nav-link" data-scroll-target="#calculate-sbvp_wocp"><span class="header-section-number">2.4</span> Calculate sbvp_wocp</a></li>
  <li><a href="#squash-av" id="toc-squash-av" class="nav-link" data-scroll-target="#squash-av"><span class="header-section-number">2.5</span> Squash AV</a></li>
  <li><a href="#calculate-sqvp_wocp" id="toc-calculate-sqvp_wocp" class="nav-link" data-scroll-target="#calculate-sqvp_wocp"><span class="header-section-number">2.6</span> Calculate sqvp_wocp</a></li>
  </ul></li>
  <li><a href="#tomato-av-results" id="toc-tomato-av-results" class="nav-link" data-scroll-target="#tomato-av-results"><span class="header-section-number">3</span> Tomato AV Results</a>
  <ul class="collapse">
  <li><a href="#tav_profit-crosstab" id="toc-tav_profit-crosstab" class="nav-link" data-scroll-target="#tav_profit-crosstab"><span class="header-section-number">3.1</span> tav_profit Crosstab</a></li>
  <li><a href="#tav_profit-heatmap" id="toc-tav_profit-heatmap" class="nav-link" data-scroll-target="#tav_profit-heatmap"><span class="header-section-number">3.2</span> tav_profit Heatmap</a></li>
  <li><a href="#tavp_wocp-crosstab" id="toc-tavp_wocp-crosstab" class="nav-link" data-scroll-target="#tavp_wocp-crosstab"><span class="header-section-number">3.3</span> tavp_wocp Crosstab</a></li>
  <li><a href="#tavp_wocp-heatmap" id="toc-tavp_wocp-heatmap" class="nav-link" data-scroll-target="#tavp_wocp-heatmap"><span class="header-section-number">3.4</span> tavp_wocp Heatmap</a></li>
  <li><a href="#plotting-tomato-profits-by-panels" id="toc-plotting-tomato-profits-by-panels" class="nav-link" data-scroll-target="#plotting-tomato-profits-by-panels"><span class="header-section-number">3.5</span> Plotting Tomato Profits by Panels</a></li>
  <li><a href="#plotting-tomato-profits-by-yields" id="toc-plotting-tomato-profits-by-yields" class="nav-link" data-scroll-target="#plotting-tomato-profits-by-yields"><span class="header-section-number">3.6</span> Plotting Tomato Profits by Yields</a></li>
  </ul></li>
  <li><a href="#strawberry-av-results" id="toc-strawberry-av-results" class="nav-link" data-scroll-target="#strawberry-av-results"><span class="header-section-number">4</span> Strawberry AV Results</a>
  <ul class="collapse">
  <li><a href="#sbav_profit-crosstab" id="toc-sbav_profit-crosstab" class="nav-link" data-scroll-target="#sbav_profit-crosstab"><span class="header-section-number">4.1</span> sbav_profit Crosstab</a></li>
  <li><a href="#sbav_profit-heatmap" id="toc-sbav_profit-heatmap" class="nav-link" data-scroll-target="#sbav_profit-heatmap"><span class="header-section-number">4.2</span> sbav_profit Heatmap</a></li>
  <li><a href="#sbavp_wocp-crosstab" id="toc-sbavp_wocp-crosstab" class="nav-link" data-scroll-target="#sbavp_wocp-crosstab"><span class="header-section-number">4.3</span> sbavp_wocp Crosstab</a></li>
  <li><a href="#sbavp_wocp-heatmap" id="toc-sbavp_wocp-heatmap" class="nav-link" data-scroll-target="#sbavp_wocp-heatmap"><span class="header-section-number">4.4</span> sbavp_wocp Heatmap</a></li>
  <li><a href="#plotting-strawberry-profit-by-panels" id="toc-plotting-strawberry-profit-by-panels" class="nav-link" data-scroll-target="#plotting-strawberry-profit-by-panels"><span class="header-section-number">4.5</span> Plotting Strawberry Profit by Panels</a></li>
  <li><a href="#plotting-strawberry-profit-by-yields" id="toc-plotting-strawberry-profit-by-yields" class="nav-link" data-scroll-target="#plotting-strawberry-profit-by-yields"><span class="header-section-number">4.6</span> Plotting Strawberry Profit by Yields</a></li>
  </ul></li>
  <li><a href="#squash-av-results" id="toc-squash-av-results" class="nav-link" data-scroll-target="#squash-av-results"><span class="header-section-number">5</span> Squash AV Results</a>
  <ul class="collapse">
  <li><a href="#sqav_profit-crosstab" id="toc-sqav_profit-crosstab" class="nav-link" data-scroll-target="#sqav_profit-crosstab"><span class="header-section-number">5.1</span> sqav_profit Crosstab</a></li>
  <li><a href="#sqav_profit-heatmap" id="toc-sqav_profit-heatmap" class="nav-link" data-scroll-target="#sqav_profit-heatmap"><span class="header-section-number">5.2</span> sqav_profit Heatmap</a></li>
  <li><a href="#sqavp_wocp-crosstab" id="toc-sqavp_wocp-crosstab" class="nav-link" data-scroll-target="#sqavp_wocp-crosstab"><span class="header-section-number">5.3</span> sqavp_wocp Crosstab</a></li>
  <li><a href="#sqavp_wocp-heatmap" id="toc-sqavp_wocp-heatmap" class="nav-link" data-scroll-target="#sqavp_wocp-heatmap"><span class="header-section-number">5.4</span> sqavp_wocp Heatmap</a></li>
  <li><a href="#plotting-squash-profit-by-panels" id="toc-plotting-squash-profit-by-panels" class="nav-link" data-scroll-target="#plotting-squash-profit-by-panels"><span class="header-section-number">5.5</span> Plotting Squash Profit by Panels</a></li>
  <li><a href="#plotting-squash-profit-by-yields" id="toc-plotting-squash-profit-by-yields" class="nav-link" data-scroll-target="#plotting-squash-profit-by-yields"><span class="header-section-number">5.6</span> Plotting Squash Profit by Yields</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="AV-Profit.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li><li><a href="AV Profit.ipynb" download="AV Profit.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">AV Profit</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bijesh Mishra, Ph.D. </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div style="page-break-after: always;"></div>
<p>Analysis in this file start by loading data saved after simulating tomato, strawberry, and squash AV profits. See simulation file for more details. The result tables I have here are quite big. Results are summarized in separate excel file (Results.xlsx).</p>
<section id="setting-up" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Setting Up</h1>
<section id="housekeeping" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="housekeeping"><span class="header-section-number">1.1</span> Housekeeping</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| echo: TRUE</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clean the environment.</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">warn=</span><span class="dv">0</span>, <span class="co"># Warnings. options(warn=-1) / options(warn=0)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scipen=</span><span class="dv">999</span> <span class="co"># No scientific notations.</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="working-directory" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="working-directory"><span class="header-section-number">1.2</span> Working directory</h2>
<p>Codes and output are suppressed. Errors and warnings are visible. No warning and no error means code is working as it should.</p>
</section>
<section id="load-libraries" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="load-libraries"><span class="header-section-number">1.3</span> Load libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(likert,  <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Likert Items</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice,  <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx2, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Scatter plot</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels,  <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Crosstab</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Reshape data</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman,  <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Package Management</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(progress, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Progress bar</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arrow, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># Feather</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some features are not enabled in this build of Arrow. Run `arrow_info()` for more information.
The repository you retrieved Arrow from did not include all of Arrow's features.
You can install a fully-featured version by running:
`install.packages('arrow', repos = 'https://apache.r-universe.dev')`.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plot3D, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># 3D plotting</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_loaded</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "pheatmap"  "lattice"   "plotly"    "plot3D"    "arrow"     "progress" 
 [7] "pacman"    "reshape2"  "gmodels"   "ggpubr"    "openxlsx2" "mice"     
[13] "likert"    "xtable"    "psych"     "lubridate" "forcats"   "stringr"  
[19] "dplyr"     "purrr"     "readr"     "tidyr"     "tibble"    "ggplot2"  
[25] "tidyverse"</code></pre>
</div>
</div>
</section>
<section id="theme-for-plots" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="theme-for-plots"><span class="header-section-number">1.4</span> Theme for plots</h2>
<p>Setting theme for plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">####### Plotting Data: #####</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Map Theme:</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>plottheme <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mapping theme:</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">r =</span> <span class="dv">0</span>, </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">b =</span> <span class="dv">0</span>, </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">l =</span> <span class="dv">0</span>, </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">unit =</span> <span class="st">"cm"</span>),</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"lightgrey"</span>,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"lightgrey"</span>,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x.top =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y.right =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x.bottom =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linetype =</span> <span class="dv">1</span>,</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y.left =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">linetype =</span> <span class="dv">1</span>,</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">linewidth =</span> <span class="dv">0</span>),</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Text formatting:</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="co"># font</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>                            <span class="at">size =</span> <span class="dv">12</span>, <span class="co"># font size</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>                            <span class="at">colour =</span> <span class="st">"black"</span><span class="co"># font color</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="sc">-</span><span class="fl">0.05</span>),</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">fill =</span> <span class="cn">NA</span>, </span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">linewidth =</span> <span class="fl">0.05</span>, </span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">linetype =</span> <span class="dv">1</span>),</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">"right"</span>,</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="import-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Import data</h1>
<p>Import necessary data.</p>
<section id="tomato-av" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="tomato-av"><span class="header-section-number">2.1</span> Tomato AV</h2>
<p>Parameters defining agrivoltaic systems:</p>
<ul>
<li><p>sprop = proportion of solar in agrivoltaic system (0 to 1 in 0.5 increment.) Length = 21.</p></li>
<li><p>panels = number of solar panels. Length = 16. Some sprop have same number of panels.</p></li>
<li><p>al_regs = four regions of Alabama. Northern, Central, Black Belt, Southern. Length = 4.</p></li>
<li><p>array = Solar array; Sun tracking (Tracking) and non-tracking (Fixed). Length = 2.</p></li>
<li><p>elecprc = electricity price (1 cents to 6 cents). Length = 6.</p></li>
<li><p>height = clearance height of solar panels. 4.6 ft., 6.4 ft., and 8.2 ft. Length = 3.</p></li>
<li><p>yldvar = crop yield variation (10% to 200%) = Length 21.</p></li>
<li><p>yield = crop yield variation based on yldvar. (same as yldvar) = Length = 21.</p></li>
</ul>
<p>Calculated results using above parameters:</p>
<ul>
<li><p>dc_kw = DC system size (kW) See <a href="https://pvwatts.nrel.gov/pvwatts.php">PVWatts® Calculator</a>.</p></li>
<li><p>energy = total energy generated from solar system. See: <a href="https://pvwatts.nrel.gov/pvwatts.php">PVWatts® Calculator</a>.</p></li>
<li><p>capex = AV system capex per kW. See: <a href="https://www.nrel.gov/docs/fy21osti/77811.pdf">Capex Cost for AV</a> table 1 and table 3.</p></li>
<li><p>ttlcost = total solar system cost in AV. See: <a href="https://www.nrel.gov/docs/fy21osti/77811.pdf">Capex Cost for AV</a> table 1 and table 3.</p></li>
<li><p>anncost = annualized total cost.</p></li>
<li><p>moncost = monthly total cost.</p></li>
<li><p>price = crop yield price per bucket.</p></li>
<li><p>eprofit = profit from electricity.</p></li>
</ul>
<p>Result of Interests:</p>
<ul>
<li><p>eannprof = annualized total profit from electricity.</p></li>
<li><p>emonprof = monthly total profit from electricity.</p></li>
<li><p>profit = profit from crops.</p></li>
<li><p>tav_profit = total profit from solar and tomato.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tav_profit <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_feather</span>(<span class="at">file =</span> <span class="st">"tav_profit.feather"</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#str(tav_profit)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#head(tav_profit); head(tav_profit)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(tav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 776160     21</code></pre>
</div>
</div>
</section>
<section id="calculate-tavp_wocp" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="calculate-tavp_wocp"><span class="header-section-number">2.2</span> Calculate tavp_wocp</h2>
<ul>
<li><p>Profit at 100% crop at their respective price is subtracted from tav_profit.</p></li>
<li><p>tavp_wocp = tav_profit - profit from 100% crop at their respective prices. This variable gives an idea where av profit stands in relation to crop profit. It helps to identify relative profitability of agrivoltaic system compared to crop only.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the profit:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Filter the dataframe to get the unique profit values for each price when yldvar is 1</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>unique_profits <span class="ot">&lt;-</span> <span class="fu">unique</span>(tav_profit[tav_profit<span class="sc">$</span>yldvar <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="st">"price"</span>, <span class="st">"profit"</span>)])</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Create a lookup table for unique profits by price</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>profit_lookup <span class="ot">&lt;-</span> <span class="fu">setNames</span>(unique_profits<span class="sc">$</span>profit, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                          unique_profits<span class="sc">$</span>price)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Create the new variable tavp_wocp by subtracting the unique profit from tav_profit</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>tav_profit<span class="sc">$</span>tavp_wocp <span class="ot">&lt;-</span> <span class="fu">mapply</span>(<span class="cf">function</span>(tav_profit, price) {</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  profit_to_subtract <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(price <span class="sc">%in%</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">names</span>(profit_lookup), </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>                               profit_lookup[<span class="fu">as.character</span>(price)], <span class="dv">0</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tav_profit <span class="sc">-</span> profit_to_subtract)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>}, tav_profit<span class="sc">$</span>tav_profit, tav_profit<span class="sc">$</span>price)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the dataframe to check the result</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>tav_profit <span class="sc">%&gt;%</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  sprop <span class="sc">==</span> <span class="fu">unique</span>(sprop[<span class="dv">1</span>]),</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  al_regs <span class="sc">==</span> <span class="fu">unique</span>(al_regs[<span class="dv">1</span>]),</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  array <span class="sc">==</span> <span class="fu">unique</span>(array[<span class="dv">1</span>]),</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  elcprc <span class="sc">==</span> <span class="fu">unique</span>(elcprc[<span class="dv">1</span>]),</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">==</span> <span class="fu">unique</span>(height[<span class="dv">1</span>]),</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  price <span class="sc">==</span> <span class="fu">unique</span>(price[<span class="dv">1</span>])</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop    al_regs array dc_kw panels energy elcprc elcrev height    capex
1      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
2      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
3      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
4      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
5      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
6      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
7      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
8      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
9      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
10     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
11     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
12     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
13     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
14     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
15     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
16     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
17     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
18     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
19     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
20     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
   ttlcost anncost moncost eprofit eannprof emonprof yldvar yield price
1        0       0       0       0        0        0    2.0  2720    17
2        0       0       0       0        0        0    1.9  2584    17
3        0       0       0       0        0        0    1.8  2448    17
4        0       0       0       0        0        0    1.7  2312    17
5        0       0       0       0        0        0    1.6  2176    17
6        0       0       0       0        0        0    1.5  2040    17
7        0       0       0       0        0        0    1.4  1904    17
8        0       0       0       0        0        0    1.3  1768    17
9        0       0       0       0        0        0    1.2  1632    17
10       0       0       0       0        0        0    1.1  1496    17
11       0       0       0       0        0        0    1.0  1360    17
12       0       0       0       0        0        0    0.9  1224    17
13       0       0       0       0        0        0    0.8  1088    17
14       0       0       0       0        0        0    0.7   952    17
15       0       0       0       0        0        0    0.6   816    17
16       0       0       0       0        0        0    0.5   680    17
17       0       0       0       0        0        0    0.4   544    17
18       0       0       0       0        0        0    0.3   408    17
19       0       0       0       0        0        0    0.2   272    17
20       0       0       0       0        0        0    0.1   136    17
       profit tav_profit tavp_wocp
1  21679.3826 21679.3826     16140
2  20065.3826 20065.3826     14526
3  18451.3826 18451.3826     12912
4  16837.3826 16837.3826     11298
5  15223.3826 15223.3826      9684
6  13609.3826 13609.3826      8070
7  11995.3826 11995.3826      6456
8  10381.3826 10381.3826      4842
9   8767.3826  8767.3826      3228
10  7153.3826  7153.3826      1614
11  5539.3826  5539.3826         0
12  3925.3826  3925.3826     -1614
13  2311.3826  2311.3826     -3228
14   697.3826   697.3826     -4842
15  -916.6174  -916.6174     -6456
16 -2530.6174 -2530.6174     -8070
17 -4144.6174 -4144.6174     -9684
18 -5758.6174 -5758.6174    -11298
19 -7372.6174 -7372.6174    -12912
20 -8986.6174 -8986.6174    -14526</code></pre>
</div>
</div></li>
</ul>
</section>
<section id="strawberry-av" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="strawberry-av"><span class="header-section-number">2.3</span> Strawberry AV</h2>
<p>See tomato for variable descriptions.</p>
<p>sbav_profit = total profit from solar and strawberry.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sbav_profit <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_feather</span>(<span class="at">file =</span> <span class="st">"sbav_profit.feather"</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#str(sbav_profit)</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#head(sbav_profit); tail(sbav_profit)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sbav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 776160     21</code></pre>
</div>
</div>
</section>
<section id="calculate-sbvp_wocp" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="calculate-sbvp_wocp"><span class="header-section-number">2.4</span> Calculate sbvp_wocp</h2>
<ul>
<li><p>Profit at 100% crop at their respective price is subtracted from sbav_profit.</p></li>
<li><p>sbavp_wocp = sbav_profit - profit from 100% crop at their respective prices. This variable gives an idea where av profit stands in relation to crop profit. It helps to identify relative profitability of agrivoltaic system compared to crop only.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the profit:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Filter the dataframe to get the unique profit values for each price when yldvar is 1</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>unique_profits <span class="ot">&lt;-</span> <span class="fu">unique</span>(sbav_profit[sbav_profit<span class="sc">$</span>yldvar <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="st">"price"</span>, <span class="st">"profit"</span>)])</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Create a lookup table for unique profits by price</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>profit_lookup <span class="ot">&lt;-</span> <span class="fu">setNames</span>(unique_profits<span class="sc">$</span>profit, </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                          unique_profits<span class="sc">$</span>price)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Create the new variable sbavp_wocp by subtracting the unique profit from sqav_profit</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>sbav_profit<span class="sc">$</span>sbavp_wocp <span class="ot">&lt;-</span> <span class="fu">mapply</span>(<span class="cf">function</span>(sbav_profit, price) {</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  profit_to_subtract <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(price <span class="sc">%in%</span> </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">names</span>(profit_lookup), </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>                               profit_lookup[<span class="fu">as.character</span>(price)], <span class="dv">0</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sbav_profit <span class="sc">-</span> profit_to_subtract)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>}, sbav_profit<span class="sc">$</span>sbav_profit, sbav_profit<span class="sc">$</span>price)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the dataframe to check the result</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>sbav_profit <span class="sc">%&gt;%</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  sprop <span class="sc">==</span> <span class="fu">unique</span>(sprop[<span class="dv">1</span>]),</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  al_regs <span class="sc">==</span> <span class="fu">unique</span>(al_regs[<span class="dv">1</span>]),</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  array <span class="sc">==</span> <span class="fu">unique</span>(array[<span class="dv">1</span>]),</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  elcprc <span class="sc">==</span> <span class="fu">unique</span>(elcprc[<span class="dv">1</span>]),</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">==</span> <span class="fu">unique</span>(height[<span class="dv">1</span>]),</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  price <span class="sc">==</span> <span class="fu">unique</span>(price[<span class="dv">1</span>])</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop    al_regs array dc_kw panels energy elcprc elcrev height    capex
1      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
2      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
3      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
4      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
5      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
6      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
7      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
8      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
9      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
10     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
11     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
12     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
13     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
14     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
15     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
16     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
17     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
18     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
19     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
20     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
   ttlcost anncost moncost eprofit eannprof emonprof yldvar  yield price
1        0       0       0       0        0        0    2.0 6150.0     3
2        0       0       0       0        0        0    1.9 5842.5     3
3        0       0       0       0        0        0    1.8 5535.0     3
4        0       0       0       0        0        0    1.7 5227.5     3
5        0       0       0       0        0        0    1.6 4920.0     3
6        0       0       0       0        0        0    1.5 4612.5     3
7        0       0       0       0        0        0    1.4 4305.0     3
8        0       0       0       0        0        0    1.3 3997.5     3
9        0       0       0       0        0        0    1.2 3690.0     3
10       0       0       0       0        0        0    1.1 3382.5     3
11       0       0       0       0        0        0    1.0 3075.0     3
12       0       0       0       0        0        0    0.9 2767.5     3
13       0       0       0       0        0        0    0.8 2460.0     3
14       0       0       0       0        0        0    0.7 2152.5     3
15       0       0       0       0        0        0    0.6 1845.0     3
16       0       0       0       0        0        0    0.5 1537.5     3
17       0       0       0       0        0        0    0.4 1230.0     3
18       0       0       0       0        0        0    0.3  922.5     3
19       0       0       0       0        0        0    0.2  615.0     3
20       0       0       0       0        0        0    0.1  307.5     3
       profit sbav_profit sbavp_wocp
1   -1740.495   -1740.495   5768.550
2   -2317.350   -2317.350   5191.695
3   -2894.205   -2894.205   4614.840
4   -3471.060   -3471.060   4037.985
5   -4047.915   -4047.915   3461.130
6   -4624.770   -4624.770   2884.275
7   -5201.625   -5201.625   2307.420
8   -5778.480   -5778.480   1730.565
9   -6355.335   -6355.335   1153.710
10  -6932.190   -6932.190    576.855
11  -7509.045   -7509.045      0.000
12  -8085.900   -8085.900   -576.855
13  -8662.755   -8662.755  -1153.710
14  -9239.610   -9239.610  -1730.565
15  -9816.465   -9816.465  -2307.420
16 -10393.320  -10393.320  -2884.275
17 -10970.175  -10970.175  -3461.130
18 -11547.030  -11547.030  -4037.985
19 -12123.885  -12123.885  -4614.840
20 -12700.740  -12700.740  -5191.695</code></pre>
</div>
</div></li>
</ul>
</section>
<section id="squash-av" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="squash-av"><span class="header-section-number">2.5</span> Squash AV</h2>
<ul>
<li><p>See tomato for variable descriptions.</p></li>
<li><p>sqav_profit = total profit from solar and squash.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sqav_profit <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_feather</span>(<span class="at">file =</span> <span class="st">"sqav_profit.feather"</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#head(sqav_profit); tail(sqav_profit)</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sqav_profit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 776160     21</code></pre>
</div>
</div>
</section>
<section id="calculate-sqvp_wocp" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="calculate-sqvp_wocp"><span class="header-section-number">2.6</span> Calculate sqvp_wocp</h2>
<ul>
<li><p>Profit at 100% crop at their respective price is subtracted from sqav_profit.</p></li>
<li><p>sqavp_wocp = sbav_profit - profit from 100% crop at their respective prices. This variable gives an idea where av profit stands in relation to crop profit. It helps to identify relative profitability of agrivoltaic system compared to crop only.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the profit:</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Filter the dataframe to get the unique profit values for each price when yldvar is 1</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>unique_profits <span class="ot">&lt;-</span> <span class="fu">unique</span>(sqav_profit[sqav_profit<span class="sc">$</span>yldvar <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="st">"price"</span>, <span class="st">"profit"</span>)])</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Create a lookup table for unique profits by price</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>profit_lookup <span class="ot">&lt;-</span> <span class="fu">setNames</span>(unique_profits<span class="sc">$</span>profit, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                          unique_profits<span class="sc">$</span>price)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Create the new variable sqavp_wocp by subtracting the unique profit from sqav_profit</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>sqav_profit<span class="sc">$</span>sqavp_wocp <span class="ot">&lt;-</span> <span class="fu">mapply</span>(<span class="cf">function</span>(sqav_profit, price) {</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  profit_to_subtract <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(price <span class="sc">%in%</span> </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">names</span>(profit_lookup), </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                               profit_lookup[<span class="fu">as.character</span>(price)], <span class="dv">0</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sqav_profit <span class="sc">-</span> profit_to_subtract)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>}, sqav_profit<span class="sc">$</span>sqav_profit, sqav_profit<span class="sc">$</span>price)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the dataframe to check the result</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>sqav_profit <span class="sc">%&gt;%</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  sprop <span class="sc">==</span> <span class="fu">unique</span>(sprop[<span class="dv">1</span>]),</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  al_regs <span class="sc">==</span> <span class="fu">unique</span>(al_regs[<span class="dv">1</span>]),</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  array <span class="sc">==</span> <span class="fu">unique</span>(array[<span class="dv">1</span>]),</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  elcprc <span class="sc">==</span> <span class="fu">unique</span>(elcprc[<span class="dv">1</span>]),</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">==</span> <span class="fu">unique</span>(height[<span class="dv">1</span>]),</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  price <span class="sc">==</span> <span class="fu">unique</span>(price[<span class="dv">1</span>])</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop    al_regs array dc_kw panels energy elcprc elcrev height    capex
1      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
2      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
3      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
4      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
5      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
6      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
7      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
8      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
9      0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
10     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
11     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
12     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
13     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
14     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
15     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
16     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
17     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
18     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
19     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
20     0 Black Belt Fixed     0      0      0   0.01      0    4.6 1.593333
   ttlcost anncost moncost eprofit eannprof emonprof yldvar yield price
1        0       0       0       0        0        0    2.0  2180    11
2        0       0       0       0        0        0    1.9  2071    11
3        0       0       0       0        0        0    1.8  1962    11
4        0       0       0       0        0        0    1.7  1853    11
5        0       0       0       0        0        0    1.6  1744    11
6        0       0       0       0        0        0    1.5  1635    11
7        0       0       0       0        0        0    1.4  1526    11
8        0       0       0       0        0        0    1.3  1417    11
9        0       0       0       0        0        0    1.2  1308    11
10       0       0       0       0        0        0    1.1  1199    11
11       0       0       0       0        0        0    1.0  1090    11
12       0       0       0       0        0        0    0.9   981    11
13       0       0       0       0        0        0    0.8   872    11
14       0       0       0       0        0        0    0.7   763    11
15       0       0       0       0        0        0    0.6   654    11
16       0       0       0       0        0        0    0.5   545    11
17       0       0       0       0        0        0    0.4   436    11
18       0       0       0       0        0        0    0.3   327    11
19       0       0       0       0        0        0    0.2   218    11
20       0       0       0       0        0        0    0.1   109    11
      profit sqav_profit sqavp_wocp
1  10309.117   10309.117    7017.50
2   9607.367    9607.367    6315.75
3   8905.617    8905.617    5614.00
4   8203.867    8203.867    4912.25
5   7502.117    7502.117    4210.50
6   6800.367    6800.367    3508.75
7   6098.617    6098.617    2807.00
8   5396.867    5396.867    2105.25
9   4695.117    4695.117    1403.50
10  3993.367    3993.367     701.75
11  3291.617    3291.617       0.00
12  2589.867    2589.867    -701.75
13  1888.117    1888.117   -1403.50
14  1186.367    1186.367   -2105.25
15   484.617     484.617   -2807.00
16  -217.133    -217.133   -3508.75
17  -918.883    -918.883   -4210.50
18 -1620.633   -1620.633   -4912.25
19 -2322.383   -2322.383   -5614.00
20 -3024.133   -3024.133   -6315.75</code></pre>
</div>
</div></li>
</ul>
</section>
</section>
<section id="tomato-av-results" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Tomato AV Results</h1>
<section id="tav_profit-crosstab" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="tav_profit-crosstab"><span class="header-section-number">3.1</span> tav_profit Crosstab</h2>
<ul>
<li><p>Row naming: Electricity Price_Crop Price_Solar Proportion_Alabama Regions.</p></li>
<li><p>Column naming: Solar Proportion_Array Types_Solar Panel Height.</p></li>
<li><p>Solar Proportion can be converted to total number of panels.</p></li>
<li><p>Only selected values from each variables are extracted for tabulation purpose.</p></li>
<li><p>Values displayed in the table are profit from Tomato AV system.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the values for each variable</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>sprop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="fl">1.00</span>) <span class="co"># Land Proportion</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>array <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Fixed"</span>, <span class="st">"Tracking"</span>) <span class="co"># Solar Array</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.6</span>, <span class="fl">6.4</span>, <span class="fl">8.2</span>) <span class="co"># Panel height</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>yldvar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.30</span>, <span class="fl">0.50</span>, <span class="fl">0.70</span>, <span class="fl">1.00</span>, <span class="fl">1.20</span>, <span class="fl">1.50</span>, <span class="fl">1.80</span>, <span class="fl">2.00</span>) <span class="co"># Yield Variation</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>al_regs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>, <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>) <span class="co"># Regions of AL</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">23</span>) <span class="co"># Crop Price</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>elcprc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>) <span class="co"># Electricity Price</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the required columns</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>required_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sprop"</span>, <span class="st">"array"</span>, <span class="st">"height"</span>, </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"al_regs"</span>, <span class="st">"yldvar"</span>, <span class="st">"price"</span>, <span class="st">"elcprc"</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the columns exist in tav_profit</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>missing_columns <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(required_columns, </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">names</span>(tav_profit))</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(missing_columns) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Missing columns in tav_profit: "</span>,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>       <span class="fu">paste</span>(missing_columns, <span class="at">collapse =</span> <span class="st">", "</span>))</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate column names using reversed order of expand.grid</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>col_names <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">expand.grid</span>(height, array, sprop), <span class="dv">1</span>,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">3</span>], x[<span class="dv">2</span>], x[<span class="dv">1</span>]))</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate row names using reversed order of expand.grid</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>row_names <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">expand.grid</span>(elcprc, </span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>                               price,</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>                               yldvar, </span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>                               al_regs), <span class="dv">1</span>, </span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty matrix to store the results</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>result_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(row_names), </span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">length</span>(col_names))</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_matrix) <span class="ot">&lt;-</span> col_names</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result_matrix) <span class="ot">&lt;-</span> row_names</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with </span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a><span class="co"># all combinations of parameters in reversed order</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>param_combinations <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">elcprc =</span> elcprc, </span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">price =</span> price, </span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">yldvar =</span> yldvar, </span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">al_regs =</span> al_regs,</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">height =</span> height, </span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">array =</span> array, </span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sprop =</span> sprop)</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with tav_profit to get tav_profit values for each combination</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(param_combinations, </span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>                     tav_profit, </span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by =</span> required_columns,</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape merged_data to fill result_matrix with </span></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a><span class="co"># reversed column and row names</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>merged_data<span class="sc">$</span>col_name <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>  merged_data[, <span class="fu">c</span>(<span class="st">"sprop"</span>, <span class="st">"array"</span>, <span class="st">"height"</span>)], <span class="dv">1</span>,</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">1</span>], x[<span class="dv">2</span>], x[<span class="dv">3</span>]))</span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>merged_data<span class="sc">$</span>row_name <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>  merged_data[, <span class="fu">c</span>(<span class="st">"al_regs"</span>, <span class="st">"yldvar"</span>, <span class="st">"price"</span>, <span class="st">"elcprc"</span>)], <span class="dv">1</span>,</span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">4</span>],</span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">3</span>],</span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">2</span>],</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">1</span>]))</span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill the matrix with tav_profit values</span></span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(result_matrix))) {</span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>  row_condition <span class="ot">&lt;-</span> <span class="fu">rownames</span>(result_matrix)[i]</span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>  row_data <span class="ot">&lt;-</span> merged_data[</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>    merged_data<span class="sc">$</span>row_name <span class="sc">==</span> row_condition, ]</span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(row_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>    result_matrix[i, </span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">match</span>(row_data<span class="sc">$</span>col_name, </span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">colnames</span>(result_matrix))] <span class="ot">&lt;-</span> <span class="fu">round</span>(</span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>                          row_data<span class="sc">$</span>tav_profit, <span class="dv">2</span>)</span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a>ct_tav_pft <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(result_matrix) <span class="co"># Table in Excel.</span></span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(result_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">as.data.frame</span>(ct_tav_pft),</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"ct_tav_profit.csv"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ct_tav_pft)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 324  30</code></pre>
</div>
</div>
</section>
<section id="tav_profit-heatmap" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="tav_profit-heatmap"><span class="header-section-number">3.2</span> tav_profit Heatmap</h2>
<ul>
<li>Heatmap of 324*30 dimension matrix</li>
<li>Tomato profit.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>colorcount <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">as.vector</span>(<span class="fu">as.matrix</span>(ct_tav_pft[<span class="sc">-</span><span class="dv">1</span>]))))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>colorcount</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7800</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>heatmap_plot <span class="ot">&lt;-</span> <span class="fu">pheatmap</span>(<span class="fu">t</span>(ct_tav_pft),</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                         <span class="co">#clustering_distance_rows = "correlation",</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_distance_rows =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_distance_cols =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_method =</span> <span class="st">"complete"</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"red"</span>, </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"yellow"</span>, </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"green"</span>))(colorcount),</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cutree_rows =</span> <span class="dv">5</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cutree_cols =</span> <span class="dv">4</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">show_rownames =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">show_colnames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">display_numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">number_format =</span> <span class="st">"%.2f"</span>,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cellheight =</span><span class="dv">15</span>,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cellwidth =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(heatmap_plot,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">8</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">16</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"Plots/gp_tav_pft"</span>, <span class="st">".png"</span>))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(colorcount)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(heatmap_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tavp_wocp-crosstab" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="tavp_wocp-crosstab"><span class="header-section-number">3.3</span> tavp_wocp Crosstab</h2>
<ul>
<li><p>Heatmap of 324*30 dimension matrix.</p></li>
<li><p>See tav_profit for variable naming convention.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the values for each variable</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>sprop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="fl">1.00</span>) <span class="co"># Land Proportion</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>array <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Fixed"</span>, <span class="st">"Tracking"</span>) <span class="co"># Solar Array</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.6</span>, <span class="fl">6.4</span>, <span class="fl">8.2</span>) <span class="co"># Panel height</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>yldvar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.30</span>, <span class="fl">0.50</span>, <span class="fl">0.70</span>, <span class="fl">1.00</span>, <span class="fl">1.20</span>, <span class="fl">1.50</span>, <span class="fl">1.80</span>, <span class="fl">2.00</span>) <span class="co"># Crop Yield Variation</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>al_regs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>, <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>) <span class="co"># Regions of AL</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">23</span>) <span class="co"># Crop Price</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>elcprc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>) <span class="co"># Electricity Price</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the required columns</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>required_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sprop"</span>, <span class="st">"array"</span>, <span class="st">"height"</span>, </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"al_regs"</span>, <span class="st">"yldvar"</span>, <span class="st">"price"</span>, <span class="st">"elcprc"</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the columns exist in tav_profit</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>missing_columns <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(required_columns, </span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">names</span>(tav_profit))</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(missing_columns) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Missing columns in tavp_wocp: "</span>,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>       <span class="fu">paste</span>(missing_columns, <span class="at">collapse =</span> <span class="st">", "</span>))</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate column names using reversed order of expand.grid</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>col_names <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">expand.grid</span>(height, array, sprop), <span class="dv">1</span>,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">3</span>], x[<span class="dv">2</span>], x[<span class="dv">1</span>]))</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate row names using reversed order of expand.grid</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>row_names <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">expand.grid</span>(elcprc, </span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>                               price,</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>                               yldvar, </span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>                               al_regs), <span class="dv">1</span>, </span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty matrix to store the results</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>result_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(row_names), </span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">length</span>(col_names))</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_matrix) <span class="ot">&lt;-</span> col_names</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result_matrix) <span class="ot">&lt;-</span> row_names</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with </span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a><span class="co"># all combinations of parameters in reversed order</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>param_combinations <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">elcprc =</span> elcprc, </span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">price =</span> price, </span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">yldvar =</span> yldvar, </span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">al_regs =</span> al_regs,</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">height =</span> height, </span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">array =</span> array, </span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sprop =</span> sprop)</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with tav_profit to get tav_profit values for each combination</span></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(param_combinations, </span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>                     tav_profit, </span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by =</span> required_columns,</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape merged_data to fill result_matrix with </span></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a><span class="co"># reversed column and row names</span></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>merged_data<span class="sc">$</span>col_name <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>  merged_data[, <span class="fu">c</span>(<span class="st">"sprop"</span>, <span class="st">"array"</span>, <span class="st">"height"</span>)], <span class="dv">1</span>,</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">1</span>], x[<span class="dv">2</span>], x[<span class="dv">3</span>]))</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>merged_data<span class="sc">$</span>row_name <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>  merged_data[, <span class="fu">c</span>(<span class="st">"al_regs"</span>, <span class="st">"yldvar"</span>, <span class="st">"price"</span>, <span class="st">"elcprc"</span>)], <span class="dv">1</span>,</span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">4</span>],</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">3</span>],</span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">2</span>],</span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">1</span>]))</span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill the matrix with tav_profit values</span></span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(result_matrix))) {</span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>  row_condition <span class="ot">&lt;-</span> <span class="fu">rownames</span>(result_matrix)[i]</span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>  row_data <span class="ot">&lt;-</span> merged_data[</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>    merged_data<span class="sc">$</span>row_name <span class="sc">==</span> row_condition, ]</span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(row_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>    result_matrix[i, </span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">match</span>(row_data<span class="sc">$</span>col_name, </span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">colnames</span>(result_matrix))] <span class="ot">&lt;-</span> <span class="fu">round</span>(</span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>                          row_data<span class="sc">$</span>tavp_wocp, <span class="dv">2</span>)</span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a>ct_tavp_wocp <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(result_matrix) <span class="co"># Table in Excel.</span></span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(result_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ct_tavp_wocp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 324  30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">as.data.frame</span>(ct_tavp_wocp),</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"ct_tavp_wocp.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tavp_wocp-heatmap" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="tavp_wocp-heatmap"><span class="header-section-number">3.4</span> tavp_wocp Heatmap</h2>
<ul>
<li>Heatmap of 324*30 dimension matrix.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>colorcount <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">as.vector</span>(<span class="fu">as.matrix</span>(ct_tavp_wocp[<span class="sc">-</span><span class="dv">1</span>]))))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>colorcount</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7224</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>heatmap_plot <span class="ot">&lt;-</span> <span class="fu">pheatmap</span>(<span class="fu">t</span>(ct_tavp_wocp),</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                         <span class="co">#clustering_distance_rows = "correlation",</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_distance_rows =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_distance_cols =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_method =</span> <span class="st">"complete"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"red"</span>, </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"yellow"</span>, </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"green"</span>))(colorcount),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cutree_rows =</span> <span class="dv">5</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cutree_cols =</span> <span class="dv">4</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">show_rownames =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">show_colnames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">display_numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">number_format =</span> <span class="st">"%.2f"</span>,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cellheight =</span> <span class="dv">15</span>,</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cellwidth =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(heatmap_plot,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">8</span>,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">16</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"Plots/gp_tavp_wocp"</span>, <span class="st">".png"</span>))</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(heatmap_plot)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(colorcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-tomato-profits-by-panels" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="plotting-tomato-profits-by-panels"><span class="header-section-number">3.5</span> Plotting Tomato Profits by Panels</h2>
<p>You can see plot breakdown based on yield variation, crop price, and electricity price. You can see variation for all solar proportion in one facet of the chart. Each facet of the chart contain av profit three heights of solar panels, four regions of AL, two array types.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>combinations <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">yldvar =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="fl">1.20</span>, <span class="fl">1.5</span>, <span class="fl">1.80</span>, <span class="dv">2</span>), <span class="co"># Yield variation</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">price =</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">23</span>), <span class="co"># Tomato price</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">elcprc =</span> <span class="fu">c</span>(<span class="fl">0.03</span>, <span class="fl">0.04</span>, <span class="fl">0.05</span>) <span class="co">#Electricity price</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over the combinations and create the plots</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (combo <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(combinations))) {</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  filtered_data <span class="ot">&lt;-</span> tav_profit <span class="sc">%&gt;%</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>      yldvar <span class="sc">==</span> combinations<span class="sc">$</span>yldvar[combo],</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>      price <span class="sc">==</span> combinations<span class="sc">$</span>price[combo],</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>      elcprc <span class="sc">==</span> combinations<span class="sc">$</span>elcprc[combo]</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If by panel, put panels below in color and group.</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  tav_sp_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> filtered_data,</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> al_regs,</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">y =</span> tav_profit,</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">color =</span> <span class="fu">factor</span>(panels),</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">group =</span> <span class="fu">factor</span>(panels))) <span class="sc">+</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(height <span class="sc">~</span> array,</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"4.6"</span> <span class="ot">=</span> <span class="st">"4.6 ft. Height"</span>,</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"6.4"</span> <span class="ot">=</span> <span class="st">"6.4 ft. Height"</span>,</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"8.2"</span> <span class="ot">=</span> <span class="st">"8.2 ft. Height"</span>,</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Tracking =</span> <span class="st">"Single Axis Rotation"</span>, </span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Fixed =</span> <span class="st">"Fixed Open Rack"</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>                   ))) <span class="sc">+</span></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">1</span>, </span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>                                <span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>,</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>), </span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"Center"</span>, </span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"B Belt"</span>, <span class="st">"South"</span>)) <span class="sc">+</span></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>                                <span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Regions of Alabama"</span>,</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Profit ($) from Tomato Agrivoltaic System"</span>,</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"Number of Solar </span><span class="sc">\n</span><span class="st"> Panels per Acre"</span>,</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> (<span class="fu">list</span>(combinations[combo,]))</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">+</span></span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>())</span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add horizontal line at y = 0 if y has both positive and negative values</span></span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">min</span>(filtered_data<span class="sc">$</span>tav_profit) <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(filtered_data<span class="sc">$</span>tav_profit) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a>    tav_sp_plot <span class="ot">&lt;-</span> tav_sp_plot <span class="sc">+</span> </span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, </span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linewidth =</span> <span class="fl">0.30</span>, </span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(combinations[combo,])</span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(tav_sp_plot)</span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"Plots/tav_sp_"</span>, combo, <span class="st">".png"</span>))</span>
<span id="cb37-59"><a href="#cb37-59" aria-hidden="true" tabindex="-1"></a>  <span class="co">#break</span></span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
1    0.1    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
2    0.3    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
3    0.5    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
4    0.7    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
5      1    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
6    1.2    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
7    1.5    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
8    1.8    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
9      2    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
10    0.1    20   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
11    0.3    20   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
12    0.5    20   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
13    0.7    20   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
14      1    20   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
15    1.2    20   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
16    1.5    20   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
17    1.8    20   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
18      2    20   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
19    0.1    23   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
20    0.3    23   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
21    0.5    23   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
22    0.7    23   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
23      1    23   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-23.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
24    1.2    23   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-24.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
25    1.5    23   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-25.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
26    1.8    23   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-26.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
27      2    23   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-27.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
28    0.1    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-28.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
29    0.3    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-29.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
30    0.5    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-30.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
31    0.7    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-31.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
32      1    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-32.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
33    1.2    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-33.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
34    1.5    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-34.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
35    1.8    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-35.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
36      2    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-36.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
37    0.1    20   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-37.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
38    0.3    20   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-38.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
39    0.5    20   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-39.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
40    0.7    20   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-40.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
41      1    20   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-41.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
42    1.2    20   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-42.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
43    1.5    20   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-43.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
44    1.8    20   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-44.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
45      2    20   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-45.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
46    0.1    23   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-46.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
47    0.3    23   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-47.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
48    0.5    23   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-48.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
49    0.7    23   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-49.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
50      1    23   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-50.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
51    1.2    23   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-51.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
52    1.5    23   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-52.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
53    1.8    23   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-53.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
54      2    23   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-54.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
55    0.1    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-55.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
56    0.3    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-56.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
57    0.5    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-57.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
58    0.7    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-58.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
59      1    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-59.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
60    1.2    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-60.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
61    1.5    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-61.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
62    1.8    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-62.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
63      2    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-63.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
64    0.1    20   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-64.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
65    0.3    20   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-65.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
66    0.5    20   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-66.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
67    0.7    20   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-67.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
68      1    20   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-68.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
69    1.2    20   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-69.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
70    1.5    20   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-70.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
71    1.8    20   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-71.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
72      2    20   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-72.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
73    0.1    23   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-73.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
74    0.3    23   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-74.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
75    0.5    23   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-75.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
76    0.7    23   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-76.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
77      1    23   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-77.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
78    1.2    23   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-78.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
79    1.5    23   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-79.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
80    1.8    23   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-80.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
81      2    23   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-20-81.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plotting-tomato-profits-by-yields" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="plotting-tomato-profits-by-yields"><span class="header-section-number">3.6</span> Plotting Tomato Profits by Yields</h2>
<p>You can see plot breakdown based on solar proportion, crop price, and electricity price. You can see variation for all crop yield variation in one facet of the chart. Each facet of the chart contain av profit three heights of solar panels, four regions of AL, two array types.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>combinations <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sprop =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="fl">1.00</span>), <span class="co"># Solar proportion</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">price =</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">23</span>), <span class="co"># Tomato price</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">elcprc =</span> <span class="fu">c</span>(<span class="fl">0.03</span>, <span class="fl">0.04</span>, <span class="fl">0.05</span>) <span class="co">#Electricity price</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over the combinations and create the plots</span></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (combo <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(combinations))) {</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>  filtered_data <span class="ot">&lt;-</span> tav_profit <span class="sc">%&gt;%</span></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a>      sprop <span class="sc">==</span> combinations<span class="sc">$</span>sprop[combo],</span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a>      price <span class="sc">==</span> combinations<span class="sc">$</span>price[combo],</span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a>      elcprc <span class="sc">==</span> combinations<span class="sc">$</span>elcprc[combo]</span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If by yield, put yield below in color and group.</span></span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a>  tav_yv_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> filtered_data,</span>
<span id="cb200-17"><a href="#cb200-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> al_regs,</span>
<span id="cb200-18"><a href="#cb200-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">y =</span> tav_profit,</span>
<span id="cb200-19"><a href="#cb200-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">color =</span> <span class="fu">factor</span>(yield),</span>
<span id="cb200-20"><a href="#cb200-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">group =</span> <span class="fu">factor</span>(yield))) <span class="sc">+</span></span>
<span id="cb200-21"><a href="#cb200-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb200-22"><a href="#cb200-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb200-23"><a href="#cb200-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(height <span class="sc">~</span> array,</span>
<span id="cb200-24"><a href="#cb200-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb200-25"><a href="#cb200-25" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(</span>
<span id="cb200-26"><a href="#cb200-26" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"4.6"</span> <span class="ot">=</span> <span class="st">"4.6 ft. Height"</span>,</span>
<span id="cb200-27"><a href="#cb200-27" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"6.4"</span> <span class="ot">=</span> <span class="st">"6.4 ft. Height"</span>,</span>
<span id="cb200-28"><a href="#cb200-28" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"8.2"</span> <span class="ot">=</span> <span class="st">"8.2 ft. Height"</span>,</span>
<span id="cb200-29"><a href="#cb200-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Tracking =</span> <span class="st">"Single Axis Rotation"</span>, </span>
<span id="cb200-30"><a href="#cb200-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Fixed =</span> <span class="st">"Fixed Open Rack"</span></span>
<span id="cb200-31"><a href="#cb200-31" aria-hidden="true" tabindex="-1"></a>                   ))) <span class="sc">+</span></span>
<span id="cb200-32"><a href="#cb200-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">1</span>, </span>
<span id="cb200-33"><a href="#cb200-33" aria-hidden="true" tabindex="-1"></a>                                <span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb200-34"><a href="#cb200-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>,</span>
<span id="cb200-35"><a href="#cb200-35" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>), </span>
<span id="cb200-36"><a href="#cb200-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"Center"</span>, </span>
<span id="cb200-37"><a href="#cb200-37" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"B Belt"</span>, <span class="st">"South"</span>)) <span class="sc">+</span></span>
<span id="cb200-38"><a href="#cb200-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb200-39"><a href="#cb200-39" aria-hidden="true" tabindex="-1"></a>                                <span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb200-40"><a href="#cb200-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Regions of Alabama"</span>,</span>
<span id="cb200-41"><a href="#cb200-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Profit ($) from Tomato Agrivoltaic System"</span>,</span>
<span id="cb200-42"><a href="#cb200-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"Tomato Yield </span><span class="sc">\n</span><span class="st"> (25 Lb Buckets)"</span>,</span>
<span id="cb200-43"><a href="#cb200-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> (<span class="fu">list</span>(combinations[combo,]))</span>
<span id="cb200-44"><a href="#cb200-44" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">+</span></span>
<span id="cb200-45"><a href="#cb200-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>())</span>
<span id="cb200-46"><a href="#cb200-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add horizontal line at y = 0 if y has both positive and negative values</span></span>
<span id="cb200-47"><a href="#cb200-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">min</span>(filtered_data<span class="sc">$</span>tav_profit) <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb200-48"><a href="#cb200-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(filtered_data<span class="sc">$</span>tav_profit) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb200-49"><a href="#cb200-49" aria-hidden="true" tabindex="-1"></a>    tav_yv_plot <span class="ot">&lt;-</span> tav_yv_plot <span class="sc">+</span> </span>
<span id="cb200-50"><a href="#cb200-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, </span>
<span id="cb200-51"><a href="#cb200-51" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linewidth =</span> <span class="fl">0.30</span>, </span>
<span id="cb200-52"><a href="#cb200-52" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb200-53"><a href="#cb200-53" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb200-54"><a href="#cb200-54" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb200-55"><a href="#cb200-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(combinations[combo,])</span>
<span id="cb200-56"><a href="#cb200-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(tav_yv_plot)</span>
<span id="cb200-57"><a href="#cb200-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"Plots/tav_yv_"</span>, combo, <span class="st">".png"</span>))</span>
<span id="cb200-58"><a href="#cb200-58" aria-hidden="true" tabindex="-1"></a>  <span class="co">#break</span></span>
<span id="cb200-59"><a href="#cb200-59" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
1     0    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
2  0.25    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
3   0.5    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
4  0.75    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
5     1    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
6     0    20   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
7  0.25    20   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
8   0.5    20   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
9  0.75    20   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
10     1    20   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
11     0    23   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
12  0.25    23   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
13   0.5    23   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
14  0.75    23   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
15     1    23   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
16     0    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
17  0.25    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
18   0.5    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
19  0.75    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
20     1    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
21     0    20   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
22  0.25    20   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
23   0.5    20   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-23.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
24  0.75    20   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-24.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
25     1    20   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-25.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
26     0    23   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-26.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
27  0.25    23   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-27.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
28   0.5    23   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-28.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
29  0.75    23   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-29.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
30     1    23   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-30.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
31     0    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-31.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
32  0.25    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-32.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
33   0.5    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-33.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
34  0.75    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-34.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
35     1    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-35.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
36     0    20   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-36.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
37  0.25    20   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-37.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
38   0.5    20   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-38.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
39  0.75    20   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-39.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
40     1    20   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-40.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
41     0    23   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-41.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
42  0.25    23   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-42.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
43   0.5    23   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-43.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
44  0.75    23   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-44.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
45     1    23   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-21-45.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="strawberry-av-results" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Strawberry AV Results</h1>
<section id="sbav_profit-crosstab" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="sbav_profit-crosstab"><span class="header-section-number">4.1</span> sbav_profit Crosstab</h2>
<ul>
<li><p>Row naming: Electricity Price_Crop Price_Solar Proportion_Alabama Regions</p></li>
<li><p>Column naming: Solar Proportion_Array Types_Solar Panel Height.</p></li>
<li><p>Solar Proportion can be converted to total number of panels.</p></li>
<li><p>Only selected values from each variables are extracted for tabulation purpose.</p></li>
<li><p>Values displayed in the table are profit from Strawberry AV system.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the values for each variable</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>sprop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="fl">1.00</span>)</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>array <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Fixed"</span>, <span class="st">"Tracking"</span>)</span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.6</span>, <span class="fl">6.4</span>, <span class="fl">8.2</span>)</span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a>yldvar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.30</span>, <span class="fl">0.50</span>, <span class="fl">0.70</span>, <span class="fl">1.00</span>, <span class="fl">1.20</span>, <span class="fl">1.50</span>, <span class="fl">1.80</span>, <span class="fl">2.00</span>)</span>
<span id="cb291-6"><a href="#cb291-6" aria-hidden="true" tabindex="-1"></a>al_regs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>, <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>)</span>
<span id="cb291-7"><a href="#cb291-7" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>)</span>
<span id="cb291-8"><a href="#cb291-8" aria-hidden="true" tabindex="-1"></a>elcprc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>)</span>
<span id="cb291-9"><a href="#cb291-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-10"><a href="#cb291-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the required columns</span></span>
<span id="cb291-11"><a href="#cb291-11" aria-hidden="true" tabindex="-1"></a>required_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sprop"</span>, <span class="st">"array"</span>, <span class="st">"height"</span>, </span>
<span id="cb291-12"><a href="#cb291-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"al_regs"</span>, <span class="st">"yldvar"</span>, <span class="st">"price"</span>, <span class="st">"elcprc"</span>)</span>
<span id="cb291-13"><a href="#cb291-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-14"><a href="#cb291-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the columns exist in sbav_profit</span></span>
<span id="cb291-15"><a href="#cb291-15" aria-hidden="true" tabindex="-1"></a>missing_columns <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(required_columns, </span>
<span id="cb291-16"><a href="#cb291-16" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">names</span>(sbav_profit))</span>
<span id="cb291-17"><a href="#cb291-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(missing_columns) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb291-18"><a href="#cb291-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Missing columns in sbav_profit: "</span>,</span>
<span id="cb291-19"><a href="#cb291-19" aria-hidden="true" tabindex="-1"></a>       <span class="fu">paste</span>(missing_columns, <span class="at">collapse =</span> <span class="st">", "</span>))</span>
<span id="cb291-20"><a href="#cb291-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb291-21"><a href="#cb291-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-22"><a href="#cb291-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate column names using reversed order of expand.grid</span></span>
<span id="cb291-23"><a href="#cb291-23" aria-hidden="true" tabindex="-1"></a>col_names <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">expand.grid</span>(height, array, sprop), <span class="dv">1</span>,</span>
<span id="cb291-24"><a href="#cb291-24" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">3</span>], x[<span class="dv">2</span>], x[<span class="dv">1</span>]))</span>
<span id="cb291-25"><a href="#cb291-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-26"><a href="#cb291-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate row names using reversed order of expand.grid</span></span>
<span id="cb291-27"><a href="#cb291-27" aria-hidden="true" tabindex="-1"></a>row_names <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">expand.grid</span>(elcprc, </span>
<span id="cb291-28"><a href="#cb291-28" aria-hidden="true" tabindex="-1"></a>                               price,</span>
<span id="cb291-29"><a href="#cb291-29" aria-hidden="true" tabindex="-1"></a>                               yldvar, </span>
<span id="cb291-30"><a href="#cb291-30" aria-hidden="true" tabindex="-1"></a>                               al_regs), <span class="dv">1</span>, </span>
<span id="cb291-31"><a href="#cb291-31" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb291-32"><a href="#cb291-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-33"><a href="#cb291-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty matrix to store the results</span></span>
<span id="cb291-34"><a href="#cb291-34" aria-hidden="true" tabindex="-1"></a>result_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(row_names), </span>
<span id="cb291-35"><a href="#cb291-35" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">length</span>(col_names))</span>
<span id="cb291-36"><a href="#cb291-36" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_matrix) <span class="ot">&lt;-</span> col_names</span>
<span id="cb291-37"><a href="#cb291-37" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result_matrix) <span class="ot">&lt;-</span> row_names</span>
<span id="cb291-38"><a href="#cb291-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-39"><a href="#cb291-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with</span></span>
<span id="cb291-40"><a href="#cb291-40" aria-hidden="true" tabindex="-1"></a><span class="co"># all combinations of parameters in reversed order</span></span>
<span id="cb291-41"><a href="#cb291-41" aria-hidden="true" tabindex="-1"></a>param_combinations <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">elcprc =</span> elcprc, </span>
<span id="cb291-42"><a href="#cb291-42" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">price =</span> price, </span>
<span id="cb291-43"><a href="#cb291-43" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">yldvar =</span> yldvar, </span>
<span id="cb291-44"><a href="#cb291-44" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">al_regs =</span> al_regs,</span>
<span id="cb291-45"><a href="#cb291-45" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">height =</span> height, </span>
<span id="cb291-46"><a href="#cb291-46" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">array =</span> array, </span>
<span id="cb291-47"><a href="#cb291-47" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sprop =</span> sprop)</span>
<span id="cb291-48"><a href="#cb291-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-49"><a href="#cb291-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with tav_profit to get sbav_profit values for each combination</span></span>
<span id="cb291-50"><a href="#cb291-50" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(param_combinations, </span>
<span id="cb291-51"><a href="#cb291-51" aria-hidden="true" tabindex="-1"></a>                     sbav_profit, </span>
<span id="cb291-52"><a href="#cb291-52" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by =</span> required_columns,</span>
<span id="cb291-53"><a href="#cb291-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb291-54"><a href="#cb291-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-55"><a href="#cb291-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape merged_data to fill result_matrix with </span></span>
<span id="cb291-56"><a href="#cb291-56" aria-hidden="true" tabindex="-1"></a><span class="co"># reversed column and row names</span></span>
<span id="cb291-57"><a href="#cb291-57" aria-hidden="true" tabindex="-1"></a>merged_data<span class="sc">$</span>col_name <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb291-58"><a href="#cb291-58" aria-hidden="true" tabindex="-1"></a>  merged_data[, <span class="fu">c</span>(<span class="st">"sprop"</span>, <span class="st">"array"</span>, <span class="st">"height"</span>)], <span class="dv">1</span>,</span>
<span id="cb291-59"><a href="#cb291-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">1</span>],</span>
<span id="cb291-60"><a href="#cb291-60" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">2</span>], </span>
<span id="cb291-61"><a href="#cb291-61" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">3</span>]))</span>
<span id="cb291-62"><a href="#cb291-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-63"><a href="#cb291-63" aria-hidden="true" tabindex="-1"></a>merged_data<span class="sc">$</span>row_name <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb291-64"><a href="#cb291-64" aria-hidden="true" tabindex="-1"></a>  merged_data[, <span class="fu">c</span>(<span class="st">"al_regs"</span>, <span class="st">"yldvar"</span>, <span class="st">"price"</span>, <span class="st">"elcprc"</span>)], <span class="dv">1</span>,</span>
<span id="cb291-65"><a href="#cb291-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">4</span>],</span>
<span id="cb291-66"><a href="#cb291-66" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">3</span>],</span>
<span id="cb291-67"><a href="#cb291-67" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">2</span>],</span>
<span id="cb291-68"><a href="#cb291-68" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">1</span>]))</span>
<span id="cb291-69"><a href="#cb291-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-70"><a href="#cb291-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill the matrix with sbav_profit values</span></span>
<span id="cb291-71"><a href="#cb291-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(result_matrix))) {</span>
<span id="cb291-72"><a href="#cb291-72" aria-hidden="true" tabindex="-1"></a>  row_condition <span class="ot">&lt;-</span> <span class="fu">rownames</span>(result_matrix)[i]</span>
<span id="cb291-73"><a href="#cb291-73" aria-hidden="true" tabindex="-1"></a>  row_data <span class="ot">&lt;-</span> merged_data[</span>
<span id="cb291-74"><a href="#cb291-74" aria-hidden="true" tabindex="-1"></a>    merged_data<span class="sc">$</span>row_name <span class="sc">==</span> row_condition, ]</span>
<span id="cb291-75"><a href="#cb291-75" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(row_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb291-76"><a href="#cb291-76" aria-hidden="true" tabindex="-1"></a>    result_matrix[i, </span>
<span id="cb291-77"><a href="#cb291-77" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">match</span>(row_data<span class="sc">$</span>col_name, </span>
<span id="cb291-78"><a href="#cb291-78" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">colnames</span>(result_matrix))] <span class="ot">&lt;-</span> <span class="fu">round</span>(</span>
<span id="cb291-79"><a href="#cb291-79" aria-hidden="true" tabindex="-1"></a>                          row_data<span class="sc">$</span>sbav_profit, <span class="dv">2</span>)</span>
<span id="cb291-80"><a href="#cb291-80" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb291-81"><a href="#cb291-81" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb291-82"><a href="#cb291-82" aria-hidden="true" tabindex="-1"></a>ct_sbav_pft <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(result_matrix) <span class="co">#Table in Excel.</span></span>
<span id="cb291-83"><a href="#cb291-83" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(result_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">as.data.frame</span>(ct_sbav_pft),</span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>          <span class="co">#col.names = TRUE,</span></span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"ct_sbav_pft.csv"</span>)</span>
<span id="cb292-5"><a href="#cb292-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ct_sbav_pft)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 324  30</code></pre>
</div>
</div>
</section>
<section id="sbav_profit-heatmap" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sbav_profit-heatmap"><span class="header-section-number">4.2</span> sbav_profit Heatmap</h2>
<ul>
<li>Heatmap of 324*30 dimension matrix.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>colorcount <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">as.vector</span>(<span class="fu">as.matrix</span>(ct_sbav_pft[<span class="sc">-</span><span class="dv">1</span>]))))</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>colorcount</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7797</code></pre>
</div>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>heatmap_plot <span class="ot">&lt;-</span> <span class="fu">pheatmap</span>(<span class="fu">t</span>(ct_sbav_pft),</span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>                         <span class="co">#clustering_distance_rows = "correlation",</span></span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_distance_rows =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_distance_cols =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_method =</span> <span class="st">"complete"</span>,</span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"red"</span>, </span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"yellow"</span>, </span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"green"</span>))(colorcount),</span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cutree_rows =</span> <span class="dv">5</span>,</span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cutree_cols =</span> <span class="dv">4</span>,</span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb296-13"><a href="#cb296-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">show_rownames =</span> <span class="cn">TRUE</span>,</span>
<span id="cb296-14"><a href="#cb296-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">show_colnames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb296-15"><a href="#cb296-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">display_numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb296-16"><a href="#cb296-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">number_format =</span> <span class="st">"%.2f"</span>,</span>
<span id="cb296-17"><a href="#cb296-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cellheight =</span> <span class="dv">15</span>,</span>
<span id="cb296-18"><a href="#cb296-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cellwidth =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(heatmap_plot,</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">8</span>,</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">16</span>,</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"Plots/gp_sbav_pft"</span>, <span class="st">".png"</span>))</span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(heatmap_plot)</span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(colorcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sbavp_wocp-crosstab" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="sbavp_wocp-crosstab"><span class="header-section-number">4.3</span> sbavp_wocp Crosstab</h2>
<ul>
<li><p>Row naming: Electricity Price_Crop Price_Solar Proportion_Alabama Regions</p></li>
<li><p>Column naming: Solar Proportion_Array Types_Solar Panel Height.</p></li>
<li><p>Solar Proportion can be converted to total number of panels.</p></li>
<li><p>Only selected values from each variables are extracted for tabulation purpose.</p></li>
<li><p>Values displayed in the table are profit from Strawberry AV system.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the values for each variable</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>sprop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="fl">1.00</span>)</span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>array <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Fixed"</span>, <span class="st">"Tracking"</span>)</span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.6</span>, <span class="fl">6.4</span>, <span class="fl">8.2</span>)</span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a>yldvar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.30</span>, <span class="fl">0.50</span>, <span class="fl">0.70</span>, <span class="fl">1.00</span>, <span class="fl">1.20</span>, <span class="fl">1.50</span>, <span class="fl">1.80</span>, <span class="fl">2.00</span>)</span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a>al_regs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>, <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>)</span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>)</span>
<span id="cb298-8"><a href="#cb298-8" aria-hidden="true" tabindex="-1"></a>elcprc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>)</span>
<span id="cb298-9"><a href="#cb298-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-10"><a href="#cb298-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the required columns</span></span>
<span id="cb298-11"><a href="#cb298-11" aria-hidden="true" tabindex="-1"></a>required_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sprop"</span>, <span class="st">"array"</span>, <span class="st">"height"</span>, </span>
<span id="cb298-12"><a href="#cb298-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"al_regs"</span>, <span class="st">"yldvar"</span>, <span class="st">"price"</span>, <span class="st">"elcprc"</span>)</span>
<span id="cb298-13"><a href="#cb298-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-14"><a href="#cb298-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the columns exist in sbav_profit</span></span>
<span id="cb298-15"><a href="#cb298-15" aria-hidden="true" tabindex="-1"></a>missing_columns <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(required_columns, </span>
<span id="cb298-16"><a href="#cb298-16" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">names</span>(sbav_profit))</span>
<span id="cb298-17"><a href="#cb298-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(missing_columns) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb298-18"><a href="#cb298-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Missing columns in sbav_profit: "</span>,</span>
<span id="cb298-19"><a href="#cb298-19" aria-hidden="true" tabindex="-1"></a>       <span class="fu">paste</span>(missing_columns, <span class="at">collapse =</span> <span class="st">", "</span>))</span>
<span id="cb298-20"><a href="#cb298-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb298-21"><a href="#cb298-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-22"><a href="#cb298-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate column names using reversed order of expand.grid</span></span>
<span id="cb298-23"><a href="#cb298-23" aria-hidden="true" tabindex="-1"></a>col_names <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">expand.grid</span>(height, array, sprop), <span class="dv">1</span>,</span>
<span id="cb298-24"><a href="#cb298-24" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">3</span>], x[<span class="dv">2</span>], x[<span class="dv">1</span>]))</span>
<span id="cb298-25"><a href="#cb298-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-26"><a href="#cb298-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate row names using reversed order of expand.grid</span></span>
<span id="cb298-27"><a href="#cb298-27" aria-hidden="true" tabindex="-1"></a>row_names <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">expand.grid</span>(elcprc, </span>
<span id="cb298-28"><a href="#cb298-28" aria-hidden="true" tabindex="-1"></a>                               price,</span>
<span id="cb298-29"><a href="#cb298-29" aria-hidden="true" tabindex="-1"></a>                               yldvar, </span>
<span id="cb298-30"><a href="#cb298-30" aria-hidden="true" tabindex="-1"></a>                               al_regs), <span class="dv">1</span>, </span>
<span id="cb298-31"><a href="#cb298-31" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb298-32"><a href="#cb298-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-33"><a href="#cb298-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty matrix to store the results</span></span>
<span id="cb298-34"><a href="#cb298-34" aria-hidden="true" tabindex="-1"></a>result_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(row_names), </span>
<span id="cb298-35"><a href="#cb298-35" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">length</span>(col_names))</span>
<span id="cb298-36"><a href="#cb298-36" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_matrix) <span class="ot">&lt;-</span> col_names</span>
<span id="cb298-37"><a href="#cb298-37" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result_matrix) <span class="ot">&lt;-</span> row_names</span>
<span id="cb298-38"><a href="#cb298-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-39"><a href="#cb298-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with</span></span>
<span id="cb298-40"><a href="#cb298-40" aria-hidden="true" tabindex="-1"></a><span class="co"># all combinations of parameters in reversed order</span></span>
<span id="cb298-41"><a href="#cb298-41" aria-hidden="true" tabindex="-1"></a>param_combinations <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">elcprc =</span> elcprc, </span>
<span id="cb298-42"><a href="#cb298-42" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">price =</span> price, </span>
<span id="cb298-43"><a href="#cb298-43" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">yldvar =</span> yldvar, </span>
<span id="cb298-44"><a href="#cb298-44" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">al_regs =</span> al_regs,</span>
<span id="cb298-45"><a href="#cb298-45" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">height =</span> height, </span>
<span id="cb298-46"><a href="#cb298-46" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">array =</span> array, </span>
<span id="cb298-47"><a href="#cb298-47" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sprop =</span> sprop)</span>
<span id="cb298-48"><a href="#cb298-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-49"><a href="#cb298-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with tav_profit to get sbav_profit values for each combination</span></span>
<span id="cb298-50"><a href="#cb298-50" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(param_combinations, </span>
<span id="cb298-51"><a href="#cb298-51" aria-hidden="true" tabindex="-1"></a>                     sbav_profit, </span>
<span id="cb298-52"><a href="#cb298-52" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by =</span> required_columns,</span>
<span id="cb298-53"><a href="#cb298-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb298-54"><a href="#cb298-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-55"><a href="#cb298-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape merged_data to fill result_matrix with </span></span>
<span id="cb298-56"><a href="#cb298-56" aria-hidden="true" tabindex="-1"></a><span class="co"># reversed column and row names</span></span>
<span id="cb298-57"><a href="#cb298-57" aria-hidden="true" tabindex="-1"></a>merged_data<span class="sc">$</span>col_name <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb298-58"><a href="#cb298-58" aria-hidden="true" tabindex="-1"></a>  merged_data[, <span class="fu">c</span>(<span class="st">"sprop"</span>, <span class="st">"array"</span>, <span class="st">"height"</span>)], <span class="dv">1</span>,</span>
<span id="cb298-59"><a href="#cb298-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">1</span>],</span>
<span id="cb298-60"><a href="#cb298-60" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">2</span>], </span>
<span id="cb298-61"><a href="#cb298-61" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">3</span>]))</span>
<span id="cb298-62"><a href="#cb298-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-63"><a href="#cb298-63" aria-hidden="true" tabindex="-1"></a>merged_data<span class="sc">$</span>row_name <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb298-64"><a href="#cb298-64" aria-hidden="true" tabindex="-1"></a>  merged_data[, <span class="fu">c</span>(<span class="st">"al_regs"</span>, <span class="st">"yldvar"</span>, <span class="st">"price"</span>, <span class="st">"elcprc"</span>)], <span class="dv">1</span>,</span>
<span id="cb298-65"><a href="#cb298-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">4</span>],</span>
<span id="cb298-66"><a href="#cb298-66" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">3</span>],</span>
<span id="cb298-67"><a href="#cb298-67" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">2</span>],</span>
<span id="cb298-68"><a href="#cb298-68" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">1</span>]))</span>
<span id="cb298-69"><a href="#cb298-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-70"><a href="#cb298-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill the matrix with sbav_profit values</span></span>
<span id="cb298-71"><a href="#cb298-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(result_matrix))) {</span>
<span id="cb298-72"><a href="#cb298-72" aria-hidden="true" tabindex="-1"></a>  row_condition <span class="ot">&lt;-</span> <span class="fu">rownames</span>(result_matrix)[i]</span>
<span id="cb298-73"><a href="#cb298-73" aria-hidden="true" tabindex="-1"></a>  row_data <span class="ot">&lt;-</span> merged_data[</span>
<span id="cb298-74"><a href="#cb298-74" aria-hidden="true" tabindex="-1"></a>    merged_data<span class="sc">$</span>row_name <span class="sc">==</span> row_condition, ]</span>
<span id="cb298-75"><a href="#cb298-75" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(row_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb298-76"><a href="#cb298-76" aria-hidden="true" tabindex="-1"></a>    result_matrix[i, </span>
<span id="cb298-77"><a href="#cb298-77" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">match</span>(row_data<span class="sc">$</span>col_name, </span>
<span id="cb298-78"><a href="#cb298-78" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">colnames</span>(result_matrix))] <span class="ot">&lt;-</span> <span class="fu">round</span>(</span>
<span id="cb298-79"><a href="#cb298-79" aria-hidden="true" tabindex="-1"></a>                          row_data<span class="sc">$</span>sbavp_wocp, <span class="dv">2</span>)</span>
<span id="cb298-80"><a href="#cb298-80" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb298-81"><a href="#cb298-81" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb298-82"><a href="#cb298-82" aria-hidden="true" tabindex="-1"></a>ct_sbavp_wocp <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(result_matrix) <span class="co">#Table in Excel.</span></span>
<span id="cb298-83"><a href="#cb298-83" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(result_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">as.data.frame</span>(ct_sbavp_wocp),</span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a>          <span class="co">#col.names = TRUE,</span></span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"ct_sbavp_wocp.csv"</span>)</span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ct_sbavp_wocp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 324  30</code></pre>
</div>
</div>
</section>
<section id="sbavp_wocp-heatmap" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="sbavp_wocp-heatmap"><span class="header-section-number">4.4</span> sbavp_wocp Heatmap</h2>
<ul>
<li>Heatmap of 324*30 dimension matrix.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>colorcount <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">as.vector</span>(<span class="fu">as.matrix</span>(ct_sbavp_wocp[<span class="sc">-</span><span class="dv">1</span>]))))</span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>colorcount</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7219</code></pre>
</div>
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>heatmap_plot <span class="ot">&lt;-</span> <span class="fu">pheatmap</span>(<span class="fu">t</span>(ct_sbavp_wocp),</span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>                         <span class="co">#clustering_distance_rows = "correlation",</span></span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_distance_rows =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_distance_cols =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_method =</span> <span class="st">"complete"</span>,</span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"red"</span>, </span>
<span id="cb303-7"><a href="#cb303-7" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"yellow"</span>, </span>
<span id="cb303-8"><a href="#cb303-8" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"green"</span>))(colorcount),</span>
<span id="cb303-9"><a href="#cb303-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cutree_rows =</span> <span class="dv">5</span>,</span>
<span id="cb303-10"><a href="#cb303-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cutree_cols =</span> <span class="dv">4</span>,</span>
<span id="cb303-11"><a href="#cb303-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb303-12"><a href="#cb303-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb303-13"><a href="#cb303-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">show_rownames =</span> <span class="cn">TRUE</span>,</span>
<span id="cb303-14"><a href="#cb303-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">show_colnames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb303-15"><a href="#cb303-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">display_numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb303-16"><a href="#cb303-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">number_format =</span> <span class="st">"%.2f"</span>,</span>
<span id="cb303-17"><a href="#cb303-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cellheight =</span> <span class="dv">15</span>,</span>
<span id="cb303-18"><a href="#cb303-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cellwidth =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(heatmap_plot,</span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">8</span>,</span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">16</span>,</span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"Plots/gp_sbavp_wocp"</span>, <span class="st">".png"</span>))</span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(heatmap_plot)</span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(colorcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-strawberry-profit-by-panels" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="plotting-strawberry-profit-by-panels"><span class="header-section-number">4.5</span> Plotting Strawberry Profit by Panels</h2>
<p>You can see plot breakdown based on yield variation, crop price, and electricity price. You can see variation for all solar proportion in one facet of the chart. Each facet of the chart contain av profit three heights of solar panels, four regions of AL, two array types.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>combinations <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">yldvar =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="fl">1.20</span>, <span class="fl">1.5</span>, <span class="fl">1.80</span>, <span class="dv">2</span>), <span class="co"># Yield variation</span></span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">price =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>), <span class="co"># Strawberry price</span></span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">elcprc =</span> <span class="fu">c</span>(<span class="fl">0.03</span>, <span class="fl">0.04</span>, <span class="fl">0.05</span>) <span class="co"># Electricity price</span></span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over the combinations and create the plots</span></span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (combo <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(combinations))) {</span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true" tabindex="-1"></a>  filtered_data <span class="ot">&lt;-</span> sbav_profit <span class="sc">%&gt;%</span></span>
<span id="cb305-10"><a href="#cb305-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb305-11"><a href="#cb305-11" aria-hidden="true" tabindex="-1"></a>      yldvar <span class="sc">==</span> combinations<span class="sc">$</span>yldvar[combo],</span>
<span id="cb305-12"><a href="#cb305-12" aria-hidden="true" tabindex="-1"></a>      price <span class="sc">==</span> combinations<span class="sc">$</span>price[combo],</span>
<span id="cb305-13"><a href="#cb305-13" aria-hidden="true" tabindex="-1"></a>      elcprc <span class="sc">==</span> combinations<span class="sc">$</span>elcprc[combo]</span>
<span id="cb305-14"><a href="#cb305-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb305-15"><a href="#cb305-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If by panel, put panels below in color and group.</span></span>
<span id="cb305-16"><a href="#cb305-16" aria-hidden="true" tabindex="-1"></a>  sbav_sp_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> filtered_data,</span>
<span id="cb305-17"><a href="#cb305-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> al_regs,</span>
<span id="cb305-18"><a href="#cb305-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">y =</span> sbav_profit,</span>
<span id="cb305-19"><a href="#cb305-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">color =</span> <span class="fu">factor</span>(panels),</span>
<span id="cb305-20"><a href="#cb305-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">group =</span> <span class="fu">factor</span>(panels))) <span class="sc">+</span></span>
<span id="cb305-21"><a href="#cb305-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb305-22"><a href="#cb305-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb305-23"><a href="#cb305-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(height <span class="sc">~</span> array,</span>
<span id="cb305-24"><a href="#cb305-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb305-25"><a href="#cb305-25" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(</span>
<span id="cb305-26"><a href="#cb305-26" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"4.6"</span> <span class="ot">=</span> <span class="st">"4.6 ft. Height"</span>,</span>
<span id="cb305-27"><a href="#cb305-27" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"6.4"</span> <span class="ot">=</span> <span class="st">"6.4 ft. Height"</span>,</span>
<span id="cb305-28"><a href="#cb305-28" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"8.2"</span> <span class="ot">=</span> <span class="st">"8.2 ft. Height"</span>,</span>
<span id="cb305-29"><a href="#cb305-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Tracking =</span> <span class="st">"Single Axis Rotation"</span>, </span>
<span id="cb305-30"><a href="#cb305-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Fixed =</span> <span class="st">"Fixed Open Rack"</span></span>
<span id="cb305-31"><a href="#cb305-31" aria-hidden="true" tabindex="-1"></a>                   ))) <span class="sc">+</span></span>
<span id="cb305-32"><a href="#cb305-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">1</span>, </span>
<span id="cb305-33"><a href="#cb305-33" aria-hidden="true" tabindex="-1"></a>                                <span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb305-34"><a href="#cb305-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>,</span>
<span id="cb305-35"><a href="#cb305-35" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>), </span>
<span id="cb305-36"><a href="#cb305-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"Center"</span>, </span>
<span id="cb305-37"><a href="#cb305-37" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"B Belt"</span>, <span class="st">"South"</span>)) <span class="sc">+</span></span>
<span id="cb305-38"><a href="#cb305-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb305-39"><a href="#cb305-39" aria-hidden="true" tabindex="-1"></a>                                <span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb305-40"><a href="#cb305-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Regions of Alabama"</span>,</span>
<span id="cb305-41"><a href="#cb305-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Profit ($) from Strawberry Agrivoltaic System"</span>,</span>
<span id="cb305-42"><a href="#cb305-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"Number of Solar </span><span class="sc">\n</span><span class="st"> Panels per Acre"</span>,</span>
<span id="cb305-43"><a href="#cb305-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> (<span class="fu">list</span>(combinations[combo,]))</span>
<span id="cb305-44"><a href="#cb305-44" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">+</span></span>
<span id="cb305-45"><a href="#cb305-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>())</span>
<span id="cb305-46"><a href="#cb305-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add horizontal line at y = 0 if y has both positive and negative values</span></span>
<span id="cb305-47"><a href="#cb305-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">min</span>(filtered_data<span class="sc">$</span>sbav_profit) <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb305-48"><a href="#cb305-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(filtered_data<span class="sc">$</span>sbav_profit) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb305-49"><a href="#cb305-49" aria-hidden="true" tabindex="-1"></a>    sbav_sp_plot <span class="ot">&lt;-</span> sbav_sp_plot <span class="sc">+</span> </span>
<span id="cb305-50"><a href="#cb305-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, </span>
<span id="cb305-51"><a href="#cb305-51" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linewidth =</span> <span class="fl">0.30</span>, </span>
<span id="cb305-52"><a href="#cb305-52" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb305-53"><a href="#cb305-53" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb305-54"><a href="#cb305-54" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb305-55"><a href="#cb305-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(combinations[combo,])</span>
<span id="cb305-56"><a href="#cb305-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(sbav_sp_plot)</span>
<span id="cb305-57"><a href="#cb305-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"Plots/sbav_sp_"</span>, combo, <span class="st">".png"</span>))</span>
<span id="cb305-58"><a href="#cb305-58" aria-hidden="true" tabindex="-1"></a>  <span class="co">#break</span></span>
<span id="cb305-59"><a href="#cb305-59" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
1    0.1     3   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
2    0.3     3   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
3    0.5     3   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
4    0.7     3   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
5      1     3   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
6    1.2     3   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
7    1.5     3   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
8    1.8     3   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
9      2     3   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
10    0.1     6   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
11    0.3     6   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
12    0.5     6   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
13    0.7     6   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
14      1     6   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
15    1.2     6   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
16    1.5     6   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
17    1.8     6   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
18      2     6   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
19    0.1     9   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
20    0.3     9   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
21    0.5     9   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
22    0.7     9   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
23      1     9   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-23.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
24    1.2     9   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-24.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
25    1.5     9   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-25.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
26    1.8     9   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-26.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
27      2     9   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-27.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
28    0.1     3   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-28.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
29    0.3     3   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-29.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
30    0.5     3   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-30.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
31    0.7     3   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-31.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
32      1     3   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-32.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
33    1.2     3   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-33.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
34    1.5     3   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-34.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
35    1.8     3   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-35.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
36      2     3   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-36.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
37    0.1     6   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-37.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
38    0.3     6   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-38.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
39    0.5     6   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-39.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
40    0.7     6   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-40.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
41      1     6   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-41.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
42    1.2     6   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-42.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
43    1.5     6   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-43.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
44    1.8     6   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-44.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
45      2     6   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-45.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
46    0.1     9   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-46.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
47    0.3     9   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-47.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
48    0.5     9   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-48.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
49    0.7     9   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-49.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
50      1     9   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-50.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
51    1.2     9   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-51.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
52    1.5     9   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-52.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
53    1.8     9   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-53.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
54      2     9   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-54.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
55    0.1     3   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-55.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
56    0.3     3   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-56.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
57    0.5     3   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-57.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
58    0.7     3   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-58.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
59      1     3   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-59.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
60    1.2     3   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-60.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
61    1.5     3   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-61.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
62    1.8     3   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-62.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
63      2     3   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-63.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
64    0.1     6   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-64.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
65    0.3     6   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-65.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
66    0.5     6   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-66.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
67    0.7     6   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-67.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
68      1     6   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-68.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
69    1.2     6   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-69.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
70    1.5     6   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-70.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
71    1.8     6   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-71.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
72      2     6   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-72.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
73    0.1     9   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-73.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
74    0.3     9   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-74.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
75    0.5     9   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-75.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
76    0.7     9   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-76.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
77      1     9   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-77.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
78    1.2     9   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-78.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
79    1.5     9   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-79.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
80    1.8     9   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-80.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
81      2     9   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-30-81.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plotting-strawberry-profit-by-yields" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="plotting-strawberry-profit-by-yields"><span class="header-section-number">4.6</span> Plotting Strawberry Profit by Yields</h2>
<p>You can see plot breakdown based on solar proportion, crop price, and electricity price. You can see variation for all crop yield variation in one facet of the chart. Each facet of the chart contain av profit three heights of solar panels, four regions of AL, two array types.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb468"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a>combinations <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sprop =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="fl">1.00</span>), <span class="co"># Solar proportion</span></span>
<span id="cb468-3"><a href="#cb468-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">price =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>), <span class="co"># Strawberry price</span></span>
<span id="cb468-4"><a href="#cb468-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">elcprc =</span> <span class="fu">c</span>(<span class="fl">0.03</span>, <span class="fl">0.04</span>, <span class="fl">0.05</span>) <span class="co">#Electricity price</span></span>
<span id="cb468-5"><a href="#cb468-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb468-6"><a href="#cb468-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-7"><a href="#cb468-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over the combinations and create the plots</span></span>
<span id="cb468-8"><a href="#cb468-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (combo <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(combinations))) {</span>
<span id="cb468-9"><a href="#cb468-9" aria-hidden="true" tabindex="-1"></a>  filtered_data <span class="ot">&lt;-</span> sbav_profit <span class="sc">%&gt;%</span></span>
<span id="cb468-10"><a href="#cb468-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb468-11"><a href="#cb468-11" aria-hidden="true" tabindex="-1"></a>      sprop <span class="sc">==</span> combinations<span class="sc">$</span>sprop[combo],</span>
<span id="cb468-12"><a href="#cb468-12" aria-hidden="true" tabindex="-1"></a>      price <span class="sc">==</span> combinations<span class="sc">$</span>price[combo],</span>
<span id="cb468-13"><a href="#cb468-13" aria-hidden="true" tabindex="-1"></a>      elcprc <span class="sc">==</span> combinations<span class="sc">$</span>elcprc[combo]</span>
<span id="cb468-14"><a href="#cb468-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb468-15"><a href="#cb468-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If by yield, put yield below in color and group.</span></span>
<span id="cb468-16"><a href="#cb468-16" aria-hidden="true" tabindex="-1"></a>  sbav_yv_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> filtered_data,</span>
<span id="cb468-17"><a href="#cb468-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> al_regs,</span>
<span id="cb468-18"><a href="#cb468-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">y =</span> sbav_profit,</span>
<span id="cb468-19"><a href="#cb468-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">color =</span> <span class="fu">factor</span>(yield),</span>
<span id="cb468-20"><a href="#cb468-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">group =</span> <span class="fu">factor</span>(yield))) <span class="sc">+</span></span>
<span id="cb468-21"><a href="#cb468-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb468-22"><a href="#cb468-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb468-23"><a href="#cb468-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(height <span class="sc">~</span> array,</span>
<span id="cb468-24"><a href="#cb468-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb468-25"><a href="#cb468-25" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(</span>
<span id="cb468-26"><a href="#cb468-26" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"4.6"</span> <span class="ot">=</span> <span class="st">"4.6 ft. Height"</span>,</span>
<span id="cb468-27"><a href="#cb468-27" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"6.4"</span> <span class="ot">=</span> <span class="st">"6.4 ft. Height"</span>,</span>
<span id="cb468-28"><a href="#cb468-28" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"8.2"</span> <span class="ot">=</span> <span class="st">"8.2 ft. Height"</span>,</span>
<span id="cb468-29"><a href="#cb468-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Tracking =</span> <span class="st">"Single Axis Rotation"</span>, </span>
<span id="cb468-30"><a href="#cb468-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Fixed =</span> <span class="st">"Fixed Open Rack"</span></span>
<span id="cb468-31"><a href="#cb468-31" aria-hidden="true" tabindex="-1"></a>                   ))) <span class="sc">+</span></span>
<span id="cb468-32"><a href="#cb468-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">1</span>, </span>
<span id="cb468-33"><a href="#cb468-33" aria-hidden="true" tabindex="-1"></a>                                <span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb468-34"><a href="#cb468-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>,</span>
<span id="cb468-35"><a href="#cb468-35" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>), </span>
<span id="cb468-36"><a href="#cb468-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"Center"</span>, </span>
<span id="cb468-37"><a href="#cb468-37" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"B Belt"</span>, <span class="st">"South"</span>)) <span class="sc">+</span></span>
<span id="cb468-38"><a href="#cb468-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb468-39"><a href="#cb468-39" aria-hidden="true" tabindex="-1"></a>                                <span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb468-40"><a href="#cb468-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Regions of Alabama"</span>,</span>
<span id="cb468-41"><a href="#cb468-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Profit ($) from Strawberry Agrivoltaic System"</span>,</span>
<span id="cb468-42"><a href="#cb468-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"Strawberry Yield </span><span class="sc">\n</span><span class="st"> (25 Lb Buckets)"</span>,</span>
<span id="cb468-43"><a href="#cb468-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> (<span class="fu">list</span>(combinations[combo,]))</span>
<span id="cb468-44"><a href="#cb468-44" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">+</span></span>
<span id="cb468-45"><a href="#cb468-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>())</span>
<span id="cb468-46"><a href="#cb468-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add horizontal line at y = 0 if y has both positive and negative values</span></span>
<span id="cb468-47"><a href="#cb468-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">min</span>(filtered_data<span class="sc">$</span>sbav_profit) <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb468-48"><a href="#cb468-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(filtered_data<span class="sc">$</span>sbav_profit) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb468-49"><a href="#cb468-49" aria-hidden="true" tabindex="-1"></a>    sbav_yv_plot <span class="ot">&lt;-</span> sbav_yv_plot <span class="sc">+</span> </span>
<span id="cb468-50"><a href="#cb468-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, </span>
<span id="cb468-51"><a href="#cb468-51" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linewidth =</span> <span class="fl">0.30</span>, </span>
<span id="cb468-52"><a href="#cb468-52" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb468-53"><a href="#cb468-53" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb468-54"><a href="#cb468-54" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb468-55"><a href="#cb468-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(combinations[combo,])</span>
<span id="cb468-56"><a href="#cb468-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(sbav_yv_plot)</span>
<span id="cb468-57"><a href="#cb468-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"Plots/sbav_yv_"</span>, combo, <span class="st">".png"</span>))</span>
<span id="cb468-58"><a href="#cb468-58" aria-hidden="true" tabindex="-1"></a>  <span class="co">#break</span></span>
<span id="cb468-59"><a href="#cb468-59" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
1     0     3   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
2  0.25     3   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
3   0.5     3   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
4  0.75     3   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
5     1     3   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
6     0     6   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
7  0.25     6   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
8   0.5     6   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
9  0.75     6   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
10     1     6   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
11     0     9   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
12  0.25     9   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
13   0.5     9   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
14  0.75     9   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
15     1     9   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
16     0     3   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
17  0.25     3   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
18   0.5     3   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
19  0.75     3   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
20     1     3   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
21     0     6   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
22  0.25     6   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
23   0.5     6   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-23.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
24  0.75     6   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-24.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
25     1     6   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-25.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
26     0     9   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-26.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
27  0.25     9   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-27.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
28   0.5     9   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-28.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
29  0.75     9   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-29.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
30     1     9   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-30.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
31     0     3   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-31.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
32  0.25     3   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-32.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
33   0.5     3   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-33.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
34  0.75     3   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-34.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
35     1     3   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-35.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
36     0     6   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-36.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
37  0.25     6   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-37.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
38   0.5     6   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-38.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
39  0.75     6   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-39.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
40     1     6   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-40.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
41     0     9   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-41.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
42  0.25     9   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-42.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
43   0.5     9   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-43.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
44  0.75     9   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-44.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
45     1     9   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-31-45.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="squash-av-results" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Squash AV Results</h1>
<section id="sqav_profit-crosstab" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sqav_profit-crosstab"><span class="header-section-number">5.1</span> sqav_profit Crosstab</h2>
<ul>
<li><p>Row naming: Electricity Price_Crop Price_Solar Proportion_Alabama Regions</p></li>
<li><p>Column naming: Solar Proportion_Array Types_Solar Panel Height.</p></li>
<li><p>Solar Proportion can be converted to total number of panels.</p></li>
<li><p>Only selected values from each variables are extracted for tabulation purpose.</p></li>
<li><p>Values displayed in the table are profit from Squash AV system.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb559"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb559-1"><a href="#cb559-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the values for each variable</span></span>
<span id="cb559-2"><a href="#cb559-2" aria-hidden="true" tabindex="-1"></a>sprop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="fl">1.00</span>)</span>
<span id="cb559-3"><a href="#cb559-3" aria-hidden="true" tabindex="-1"></a>array <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Fixed"</span>, <span class="st">"Tracking"</span>)</span>
<span id="cb559-4"><a href="#cb559-4" aria-hidden="true" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.6</span>, <span class="fl">6.4</span>, <span class="fl">8.2</span>)</span>
<span id="cb559-5"><a href="#cb559-5" aria-hidden="true" tabindex="-1"></a>yldvar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.30</span>, <span class="fl">0.50</span>, <span class="fl">0.70</span>, <span class="fl">1.00</span>, <span class="fl">1.20</span>, <span class="fl">1.50</span>, <span class="fl">1.80</span>, <span class="fl">2.00</span>)</span>
<span id="cb559-6"><a href="#cb559-6" aria-hidden="true" tabindex="-1"></a>al_regs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>, <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>)</span>
<span id="cb559-7"><a href="#cb559-7" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">17</span>)</span>
<span id="cb559-8"><a href="#cb559-8" aria-hidden="true" tabindex="-1"></a>elcprc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>)</span>
<span id="cb559-9"><a href="#cb559-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-10"><a href="#cb559-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the required columns</span></span>
<span id="cb559-11"><a href="#cb559-11" aria-hidden="true" tabindex="-1"></a>required_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sprop"</span>, <span class="st">"array"</span>, <span class="st">"height"</span>, </span>
<span id="cb559-12"><a href="#cb559-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"al_regs"</span>, <span class="st">"yldvar"</span>, <span class="st">"price"</span>, <span class="st">"elcprc"</span>)</span>
<span id="cb559-13"><a href="#cb559-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-14"><a href="#cb559-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the columns exist in sqav_profit</span></span>
<span id="cb559-15"><a href="#cb559-15" aria-hidden="true" tabindex="-1"></a>missing_columns <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(required_columns, </span>
<span id="cb559-16"><a href="#cb559-16" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">names</span>(sqav_profit))</span>
<span id="cb559-17"><a href="#cb559-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(missing_columns) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb559-18"><a href="#cb559-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Missing columns in sqav_profit: "</span>,</span>
<span id="cb559-19"><a href="#cb559-19" aria-hidden="true" tabindex="-1"></a>       <span class="fu">paste</span>(missing_columns, <span class="at">collapse =</span> <span class="st">", "</span>))</span>
<span id="cb559-20"><a href="#cb559-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb559-21"><a href="#cb559-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-22"><a href="#cb559-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate column names using reversed order of expand.grid</span></span>
<span id="cb559-23"><a href="#cb559-23" aria-hidden="true" tabindex="-1"></a>col_names <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">expand.grid</span>(height, array, sprop), <span class="dv">1</span>,</span>
<span id="cb559-24"><a href="#cb559-24" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">3</span>],</span>
<span id="cb559-25"><a href="#cb559-25" aria-hidden="true" tabindex="-1"></a>                                      x[<span class="dv">2</span>],</span>
<span id="cb559-26"><a href="#cb559-26" aria-hidden="true" tabindex="-1"></a>                                      x[<span class="dv">1</span>]))</span>
<span id="cb559-27"><a href="#cb559-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-28"><a href="#cb559-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate row names using reversed order of expand.grid</span></span>
<span id="cb559-29"><a href="#cb559-29" aria-hidden="true" tabindex="-1"></a>row_names <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">expand.grid</span>(elcprc, </span>
<span id="cb559-30"><a href="#cb559-30" aria-hidden="true" tabindex="-1"></a>                               price,</span>
<span id="cb559-31"><a href="#cb559-31" aria-hidden="true" tabindex="-1"></a>                               yldvar, </span>
<span id="cb559-32"><a href="#cb559-32" aria-hidden="true" tabindex="-1"></a>                               al_regs), <span class="dv">1</span>, </span>
<span id="cb559-33"><a href="#cb559-33" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb559-34"><a href="#cb559-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-35"><a href="#cb559-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty matrix to store the results</span></span>
<span id="cb559-36"><a href="#cb559-36" aria-hidden="true" tabindex="-1"></a>result_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(row_names), </span>
<span id="cb559-37"><a href="#cb559-37" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">length</span>(col_names))</span>
<span id="cb559-38"><a href="#cb559-38" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_matrix) <span class="ot">&lt;-</span> col_names</span>
<span id="cb559-39"><a href="#cb559-39" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result_matrix) <span class="ot">&lt;-</span> row_names</span>
<span id="cb559-40"><a href="#cb559-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-41"><a href="#cb559-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with </span></span>
<span id="cb559-42"><a href="#cb559-42" aria-hidden="true" tabindex="-1"></a><span class="co"># all combinations of parameters in reversed order</span></span>
<span id="cb559-43"><a href="#cb559-43" aria-hidden="true" tabindex="-1"></a>param_combinations <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">elcprc =</span> elcprc, </span>
<span id="cb559-44"><a href="#cb559-44" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">price =</span> price, </span>
<span id="cb559-45"><a href="#cb559-45" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">yldvar =</span> yldvar, </span>
<span id="cb559-46"><a href="#cb559-46" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">al_regs =</span> al_regs,</span>
<span id="cb559-47"><a href="#cb559-47" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">height =</span> height, </span>
<span id="cb559-48"><a href="#cb559-48" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">array =</span> array, </span>
<span id="cb559-49"><a href="#cb559-49" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sprop =</span> sprop)</span>
<span id="cb559-50"><a href="#cb559-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-51"><a href="#cb559-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with tav_profit to get sqav_profit values for each combination</span></span>
<span id="cb559-52"><a href="#cb559-52" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(param_combinations, </span>
<span id="cb559-53"><a href="#cb559-53" aria-hidden="true" tabindex="-1"></a>                     sqav_profit, </span>
<span id="cb559-54"><a href="#cb559-54" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by =</span> required_columns,</span>
<span id="cb559-55"><a href="#cb559-55" aria-hidden="true" tabindex="-1"></a>                     <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb559-56"><a href="#cb559-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-57"><a href="#cb559-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape merged_data to fill result_matrix with </span></span>
<span id="cb559-58"><a href="#cb559-58" aria-hidden="true" tabindex="-1"></a><span class="co"># reversed column and row names</span></span>
<span id="cb559-59"><a href="#cb559-59" aria-hidden="true" tabindex="-1"></a>merged_data<span class="sc">$</span>col_name <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb559-60"><a href="#cb559-60" aria-hidden="true" tabindex="-1"></a>  merged_data[, <span class="fu">c</span>(<span class="st">"sprop"</span>, <span class="st">"array"</span>, <span class="st">"height"</span>)], <span class="dv">1</span>,</span>
<span id="cb559-61"><a href="#cb559-61" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">1</span>],</span>
<span id="cb559-62"><a href="#cb559-62" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">2</span>],</span>
<span id="cb559-63"><a href="#cb559-63" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">3</span>]))</span>
<span id="cb559-64"><a href="#cb559-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-65"><a href="#cb559-65" aria-hidden="true" tabindex="-1"></a>merged_data<span class="sc">$</span>row_name <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb559-66"><a href="#cb559-66" aria-hidden="true" tabindex="-1"></a>  merged_data[, <span class="fu">c</span>(<span class="st">"al_regs"</span>, <span class="st">"yldvar"</span>, <span class="st">"price"</span>, <span class="st">"elcprc"</span>)], <span class="dv">1</span>,</span>
<span id="cb559-67"><a href="#cb559-67" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">4</span>],</span>
<span id="cb559-68"><a href="#cb559-68" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">3</span>],</span>
<span id="cb559-69"><a href="#cb559-69" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">2</span>],</span>
<span id="cb559-70"><a href="#cb559-70" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">1</span>]))</span>
<span id="cb559-71"><a href="#cb559-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-72"><a href="#cb559-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill the matrix with sqav_profit values</span></span>
<span id="cb559-73"><a href="#cb559-73" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(result_matrix))) {</span>
<span id="cb559-74"><a href="#cb559-74" aria-hidden="true" tabindex="-1"></a>  row_condition <span class="ot">&lt;-</span> <span class="fu">rownames</span>(result_matrix)[i]</span>
<span id="cb559-75"><a href="#cb559-75" aria-hidden="true" tabindex="-1"></a>  row_data <span class="ot">&lt;-</span> merged_data[</span>
<span id="cb559-76"><a href="#cb559-76" aria-hidden="true" tabindex="-1"></a>    merged_data<span class="sc">$</span>row_name <span class="sc">==</span> row_condition, ]</span>
<span id="cb559-77"><a href="#cb559-77" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(row_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb559-78"><a href="#cb559-78" aria-hidden="true" tabindex="-1"></a>    result_matrix[i, </span>
<span id="cb559-79"><a href="#cb559-79" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">match</span>(row_data<span class="sc">$</span>col_name, </span>
<span id="cb559-80"><a href="#cb559-80" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">colnames</span>(result_matrix))] <span class="ot">&lt;-</span> <span class="fu">round</span>(</span>
<span id="cb559-81"><a href="#cb559-81" aria-hidden="true" tabindex="-1"></a>                          row_data<span class="sc">$</span>sqav_profit, <span class="dv">2</span>)</span>
<span id="cb559-82"><a href="#cb559-82" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb559-83"><a href="#cb559-83" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb559-84"><a href="#cb559-84" aria-hidden="true" tabindex="-1"></a>ct_sqav_pft <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(result_matrix)</span>
<span id="cb559-85"><a href="#cb559-85" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(result_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb560"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb560-1"><a href="#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">as.data.frame</span>(ct_sqav_pft),</span>
<span id="cb560-2"><a href="#cb560-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb560-3"><a href="#cb560-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"ct_sqav_pft.csv"</span>)</span>
<span id="cb560-4"><a href="#cb560-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ct_sqav_pft)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 324  30</code></pre>
</div>
</div>
</section>
<section id="sqav_profit-heatmap" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sqav_profit-heatmap"><span class="header-section-number">5.2</span> sqav_profit Heatmap</h2>
<ul>
<li>Heatmap of 324*30 dimension matrix.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb562"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb562-1"><a href="#cb562-1" aria-hidden="true" tabindex="-1"></a>colorcount <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">as.vector</span>(<span class="fu">as.matrix</span>(ct_sqav_pft[<span class="sc">-</span><span class="dv">1</span>]))))</span>
<span id="cb562-2"><a href="#cb562-2" aria-hidden="true" tabindex="-1"></a>colorcount</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7798</code></pre>
</div>
<div class="sourceCode cell-code" id="cb564"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true" tabindex="-1"></a>heatmap_plot <span class="ot">&lt;-</span> <span class="fu">pheatmap</span>(<span class="fu">t</span>(ct_sqav_pft),</span>
<span id="cb564-2"><a href="#cb564-2" aria-hidden="true" tabindex="-1"></a>                         <span class="co">#clustering_distance_rows = "correlation",</span></span>
<span id="cb564-3"><a href="#cb564-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_distance_rows =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb564-4"><a href="#cb564-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_distance_cols =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb564-5"><a href="#cb564-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_method =</span> <span class="st">"complete"</span>,</span>
<span id="cb564-6"><a href="#cb564-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"red"</span>, </span>
<span id="cb564-7"><a href="#cb564-7" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"yellow"</span>, </span>
<span id="cb564-8"><a href="#cb564-8" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"green"</span>))(colorcount),</span>
<span id="cb564-9"><a href="#cb564-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cutree_rows =</span> <span class="dv">5</span>,</span>
<span id="cb564-10"><a href="#cb564-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cutree_cols =</span> <span class="dv">4</span>,</span>
<span id="cb564-11"><a href="#cb564-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb564-12"><a href="#cb564-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb564-13"><a href="#cb564-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">show_rownames =</span> <span class="cn">TRUE</span>,</span>
<span id="cb564-14"><a href="#cb564-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">show_colnames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb564-15"><a href="#cb564-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">display_numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb564-16"><a href="#cb564-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">number_format =</span> <span class="st">"%.2f"</span>,</span>
<span id="cb564-17"><a href="#cb564-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cellheight =</span> <span class="dv">15</span>,</span>
<span id="cb564-18"><a href="#cb564-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cellwidth =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb565"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb565-1"><a href="#cb565-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(heatmap_plot,</span>
<span id="cb565-2"><a href="#cb565-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">8</span>,</span>
<span id="cb565-3"><a href="#cb565-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">16</span>,</span>
<span id="cb565-4"><a href="#cb565-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb565-5"><a href="#cb565-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"Plots/gp_sqav_pft"</span>, <span class="st">".png"</span>))</span>
<span id="cb565-6"><a href="#cb565-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(heatmap_plot)</span>
<span id="cb565-7"><a href="#cb565-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(colorcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sqavp_wocp-crosstab" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="sqavp_wocp-crosstab"><span class="header-section-number">5.3</span> sqavp_wocp Crosstab</h2>
<ul>
<li><p>Profit at 100% crop at their respective price is subtracted from tav_profit.</p></li>
<li><p>tavp_wocp = tav_profit - profit from 100% crop at their respective prices. This variable gives an idea where av profit stands in relation to crop profit. It helps to identify relative profitability of agrivoltaic system compared to crop only.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb566"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb566-1"><a href="#cb566-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the values for each variable</span></span>
<span id="cb566-2"><a href="#cb566-2" aria-hidden="true" tabindex="-1"></a>sprop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="fl">1.00</span>)</span>
<span id="cb566-3"><a href="#cb566-3" aria-hidden="true" tabindex="-1"></a>array <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Fixed"</span>, <span class="st">"Tracking"</span>)</span>
<span id="cb566-4"><a href="#cb566-4" aria-hidden="true" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.6</span>, <span class="fl">6.4</span>, <span class="fl">8.2</span>)</span>
<span id="cb566-5"><a href="#cb566-5" aria-hidden="true" tabindex="-1"></a>yldvar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.30</span>, <span class="fl">0.50</span>, <span class="fl">0.70</span>, <span class="fl">1.00</span>, <span class="fl">1.20</span>, <span class="fl">1.50</span>, <span class="fl">1.80</span>, <span class="fl">2.00</span>)</span>
<span id="cb566-6"><a href="#cb566-6" aria-hidden="true" tabindex="-1"></a>al_regs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>, <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>)</span>
<span id="cb566-7"><a href="#cb566-7" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">17</span>)</span>
<span id="cb566-8"><a href="#cb566-8" aria-hidden="true" tabindex="-1"></a>elcprc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>)</span>
<span id="cb566-9"><a href="#cb566-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-10"><a href="#cb566-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the required columns</span></span>
<span id="cb566-11"><a href="#cb566-11" aria-hidden="true" tabindex="-1"></a>required_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sprop"</span>, <span class="st">"array"</span>, <span class="st">"height"</span>, </span>
<span id="cb566-12"><a href="#cb566-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"al_regs"</span>, <span class="st">"yldvar"</span>, <span class="st">"price"</span>, <span class="st">"elcprc"</span>)</span>
<span id="cb566-13"><a href="#cb566-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-14"><a href="#cb566-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the columns exist in sqav_profit</span></span>
<span id="cb566-15"><a href="#cb566-15" aria-hidden="true" tabindex="-1"></a>missing_columns <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(required_columns, </span>
<span id="cb566-16"><a href="#cb566-16" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">names</span>(sqav_profit))</span>
<span id="cb566-17"><a href="#cb566-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(missing_columns) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb566-18"><a href="#cb566-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Missing columns in sqav_profit: "</span>,</span>
<span id="cb566-19"><a href="#cb566-19" aria-hidden="true" tabindex="-1"></a>       <span class="fu">paste</span>(missing_columns, <span class="at">collapse =</span> <span class="st">", "</span>))</span>
<span id="cb566-20"><a href="#cb566-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb566-21"><a href="#cb566-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-22"><a href="#cb566-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate column names using reversed order of expand.grid</span></span>
<span id="cb566-23"><a href="#cb566-23" aria-hidden="true" tabindex="-1"></a>col_names <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">expand.grid</span>(height, array, sprop), <span class="dv">1</span>,</span>
<span id="cb566-24"><a href="#cb566-24" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">3</span>],</span>
<span id="cb566-25"><a href="#cb566-25" aria-hidden="true" tabindex="-1"></a>                                      x[<span class="dv">2</span>],</span>
<span id="cb566-26"><a href="#cb566-26" aria-hidden="true" tabindex="-1"></a>                                      x[<span class="dv">1</span>]))</span>
<span id="cb566-27"><a href="#cb566-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-28"><a href="#cb566-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate row names using reversed order of expand.grid</span></span>
<span id="cb566-29"><a href="#cb566-29" aria-hidden="true" tabindex="-1"></a>row_names <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">expand.grid</span>(elcprc, </span>
<span id="cb566-30"><a href="#cb566-30" aria-hidden="true" tabindex="-1"></a>                               price,</span>
<span id="cb566-31"><a href="#cb566-31" aria-hidden="true" tabindex="-1"></a>                               yldvar, </span>
<span id="cb566-32"><a href="#cb566-32" aria-hidden="true" tabindex="-1"></a>                               al_regs), <span class="dv">1</span>, </span>
<span id="cb566-33"><a href="#cb566-33" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb566-34"><a href="#cb566-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-35"><a href="#cb566-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty matrix to store the results</span></span>
<span id="cb566-36"><a href="#cb566-36" aria-hidden="true" tabindex="-1"></a>result_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(row_names), </span>
<span id="cb566-37"><a href="#cb566-37" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">length</span>(col_names))</span>
<span id="cb566-38"><a href="#cb566-38" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_matrix) <span class="ot">&lt;-</span> col_names</span>
<span id="cb566-39"><a href="#cb566-39" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result_matrix) <span class="ot">&lt;-</span> row_names</span>
<span id="cb566-40"><a href="#cb566-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-41"><a href="#cb566-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with </span></span>
<span id="cb566-42"><a href="#cb566-42" aria-hidden="true" tabindex="-1"></a><span class="co"># all combinations of parameters in reversed order</span></span>
<span id="cb566-43"><a href="#cb566-43" aria-hidden="true" tabindex="-1"></a>param_combinations <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">elcprc =</span> elcprc, </span>
<span id="cb566-44"><a href="#cb566-44" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">price =</span> price, </span>
<span id="cb566-45"><a href="#cb566-45" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">yldvar =</span> yldvar, </span>
<span id="cb566-46"><a href="#cb566-46" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">al_regs =</span> al_regs,</span>
<span id="cb566-47"><a href="#cb566-47" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">height =</span> height, </span>
<span id="cb566-48"><a href="#cb566-48" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">array =</span> array, </span>
<span id="cb566-49"><a href="#cb566-49" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sprop =</span> sprop)</span>
<span id="cb566-50"><a href="#cb566-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-51"><a href="#cb566-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with tav_profit to get sqav_profit values for each combination</span></span>
<span id="cb566-52"><a href="#cb566-52" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(param_combinations, </span>
<span id="cb566-53"><a href="#cb566-53" aria-hidden="true" tabindex="-1"></a>                     sqav_profit, </span>
<span id="cb566-54"><a href="#cb566-54" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by =</span> required_columns,</span>
<span id="cb566-55"><a href="#cb566-55" aria-hidden="true" tabindex="-1"></a>                     <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb566-56"><a href="#cb566-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-57"><a href="#cb566-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape merged_data to fill result_matrix with </span></span>
<span id="cb566-58"><a href="#cb566-58" aria-hidden="true" tabindex="-1"></a><span class="co"># reversed column and row names</span></span>
<span id="cb566-59"><a href="#cb566-59" aria-hidden="true" tabindex="-1"></a>merged_data<span class="sc">$</span>col_name <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb566-60"><a href="#cb566-60" aria-hidden="true" tabindex="-1"></a>  merged_data[, <span class="fu">c</span>(<span class="st">"sprop"</span>, <span class="st">"array"</span>, <span class="st">"height"</span>)], <span class="dv">1</span>,</span>
<span id="cb566-61"><a href="#cb566-61" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">1</span>],</span>
<span id="cb566-62"><a href="#cb566-62" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">2</span>],</span>
<span id="cb566-63"><a href="#cb566-63" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">3</span>]))</span>
<span id="cb566-64"><a href="#cb566-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-65"><a href="#cb566-65" aria-hidden="true" tabindex="-1"></a>merged_data<span class="sc">$</span>row_name <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb566-66"><a href="#cb566-66" aria-hidden="true" tabindex="-1"></a>  merged_data[, <span class="fu">c</span>(<span class="st">"al_regs"</span>, <span class="st">"yldvar"</span>, <span class="st">"price"</span>, <span class="st">"elcprc"</span>)], <span class="dv">1</span>,</span>
<span id="cb566-67"><a href="#cb566-67" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">paste0</span>(x[<span class="dv">4</span>],</span>
<span id="cb566-68"><a href="#cb566-68" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">3</span>],</span>
<span id="cb566-69"><a href="#cb566-69" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">2</span>],</span>
<span id="cb566-70"><a href="#cb566-70" aria-hidden="true" tabindex="-1"></a>                     x[<span class="dv">1</span>]))</span>
<span id="cb566-71"><a href="#cb566-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-72"><a href="#cb566-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill the matrix with sqav_profit values</span></span>
<span id="cb566-73"><a href="#cb566-73" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(result_matrix))) {</span>
<span id="cb566-74"><a href="#cb566-74" aria-hidden="true" tabindex="-1"></a>  row_condition <span class="ot">&lt;-</span> <span class="fu">rownames</span>(result_matrix)[i]</span>
<span id="cb566-75"><a href="#cb566-75" aria-hidden="true" tabindex="-1"></a>  row_data <span class="ot">&lt;-</span> merged_data[</span>
<span id="cb566-76"><a href="#cb566-76" aria-hidden="true" tabindex="-1"></a>    merged_data<span class="sc">$</span>row_name <span class="sc">==</span> row_condition, ]</span>
<span id="cb566-77"><a href="#cb566-77" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(row_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb566-78"><a href="#cb566-78" aria-hidden="true" tabindex="-1"></a>    result_matrix[i, </span>
<span id="cb566-79"><a href="#cb566-79" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">match</span>(row_data<span class="sc">$</span>col_name, </span>
<span id="cb566-80"><a href="#cb566-80" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">colnames</span>(result_matrix))] <span class="ot">&lt;-</span> <span class="fu">round</span>(</span>
<span id="cb566-81"><a href="#cb566-81" aria-hidden="true" tabindex="-1"></a>                          row_data<span class="sc">$</span>sqavp_wocp, <span class="dv">2</span>)</span>
<span id="cb566-82"><a href="#cb566-82" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb566-83"><a href="#cb566-83" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb566-84"><a href="#cb566-84" aria-hidden="true" tabindex="-1"></a>ct_sqavp_wocp <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(result_matrix) <span class="co">#Table in Excel.</span></span>
<span id="cb566-85"><a href="#cb566-85" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(result_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb567"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb567-1"><a href="#cb567-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">as.data.frame</span>(ct_sqavp_wocp),</span>
<span id="cb567-2"><a href="#cb567-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb567-3"><a href="#cb567-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"ct_sqavp_wocp.csv"</span>)</span>
<span id="cb567-4"><a href="#cb567-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ct_sqavp_wocp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 324  30</code></pre>
</div>
</div>
</section>
<section id="sqavp_wocp-heatmap" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="sqavp_wocp-heatmap"><span class="header-section-number">5.4</span> sqavp_wocp Heatmap</h2>
<ul>
<li>Heatmap of 324*30 dimension matrix.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb569"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb569-1"><a href="#cb569-1" aria-hidden="true" tabindex="-1"></a>colorcount <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">as.vector</span>(<span class="fu">as.matrix</span>(ct_sqavp_wocp[<span class="sc">-</span><span class="dv">1</span>]))))</span>
<span id="cb569-2"><a href="#cb569-2" aria-hidden="true" tabindex="-1"></a>colorcount</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7216</code></pre>
</div>
<div class="sourceCode cell-code" id="cb571"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb571-1"><a href="#cb571-1" aria-hidden="true" tabindex="-1"></a>heatmap_plot <span class="ot">&lt;-</span> <span class="fu">pheatmap</span>(<span class="fu">t</span>(ct_sqavp_wocp),</span>
<span id="cb571-2"><a href="#cb571-2" aria-hidden="true" tabindex="-1"></a>                         <span class="co">#clustering_distance_rows = "correlation",</span></span>
<span id="cb571-3"><a href="#cb571-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_distance_rows =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb571-4"><a href="#cb571-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_distance_cols =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb571-5"><a href="#cb571-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">clustering_method =</span> <span class="st">"complete"</span>,</span>
<span id="cb571-6"><a href="#cb571-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"red"</span>, </span>
<span id="cb571-7"><a href="#cb571-7" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"yellow"</span>, </span>
<span id="cb571-8"><a href="#cb571-8" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"green"</span>))(colorcount),</span>
<span id="cb571-9"><a href="#cb571-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cutree_rows =</span> <span class="dv">5</span>,</span>
<span id="cb571-10"><a href="#cb571-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cutree_cols =</span> <span class="dv">4</span>,</span>
<span id="cb571-11"><a href="#cb571-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb571-12"><a href="#cb571-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb571-13"><a href="#cb571-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">show_rownames =</span> <span class="cn">TRUE</span>,</span>
<span id="cb571-14"><a href="#cb571-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">show_colnames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb571-15"><a href="#cb571-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">display_numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb571-16"><a href="#cb571-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">number_format =</span> <span class="st">"%.2f"</span>,</span>
<span id="cb571-17"><a href="#cb571-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cellheight =</span> <span class="dv">15</span>,</span>
<span id="cb571-18"><a href="#cb571-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cellwidth =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb572"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb572-1"><a href="#cb572-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(heatmap_plot,</span>
<span id="cb572-2"><a href="#cb572-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">8</span>,</span>
<span id="cb572-3"><a href="#cb572-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">16</span>,</span>
<span id="cb572-4"><a href="#cb572-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb572-5"><a href="#cb572-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"Plots/gp_sqavp_wocp"</span>, <span class="st">".png"</span>))</span>
<span id="cb572-6"><a href="#cb572-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(heatmap_plot)</span>
<span id="cb572-7"><a href="#cb572-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(colorcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-squash-profit-by-panels" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="plotting-squash-profit-by-panels"><span class="header-section-number">5.5</span> Plotting Squash Profit by Panels</h2>
<p>You can see plot breakdown based on yield variation, crop price, and electricity price. You can see variation for all solar proportion in one facet of the chart. Each facet of the chart contain av profit three heights of solar panels, four regions of AL, two array types.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb573"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb573-1"><a href="#cb573-1" aria-hidden="true" tabindex="-1"></a>combinations <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb573-2"><a href="#cb573-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">yldvar =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="fl">1.20</span>, <span class="fl">1.5</span>, <span class="fl">1.80</span>, <span class="dv">2</span>), <span class="co"># Yield variation</span></span>
<span id="cb573-3"><a href="#cb573-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">price =</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">17</span>), <span class="co"># Squash price</span></span>
<span id="cb573-4"><a href="#cb573-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">elcprc =</span> <span class="fu">c</span>(<span class="fl">0.03</span>, <span class="fl">0.04</span>, <span class="fl">0.05</span>) <span class="co">#Electricity price</span></span>
<span id="cb573-5"><a href="#cb573-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb573-6"><a href="#cb573-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-7"><a href="#cb573-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over the combinations and create the plots</span></span>
<span id="cb573-8"><a href="#cb573-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (combo <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(combinations))) {</span>
<span id="cb573-9"><a href="#cb573-9" aria-hidden="true" tabindex="-1"></a>  filtered_data <span class="ot">&lt;-</span> sqav_profit <span class="sc">%&gt;%</span></span>
<span id="cb573-10"><a href="#cb573-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb573-11"><a href="#cb573-11" aria-hidden="true" tabindex="-1"></a>      yldvar <span class="sc">==</span> combinations<span class="sc">$</span>yldvar[combo],</span>
<span id="cb573-12"><a href="#cb573-12" aria-hidden="true" tabindex="-1"></a>      price <span class="sc">==</span> combinations<span class="sc">$</span>price[combo],</span>
<span id="cb573-13"><a href="#cb573-13" aria-hidden="true" tabindex="-1"></a>      elcprc <span class="sc">==</span> combinations<span class="sc">$</span>elcprc[combo]</span>
<span id="cb573-14"><a href="#cb573-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb573-15"><a href="#cb573-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If by panel, put panels below in color and group.</span></span>
<span id="cb573-16"><a href="#cb573-16" aria-hidden="true" tabindex="-1"></a>  sqav_sp_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> filtered_data,</span>
<span id="cb573-17"><a href="#cb573-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> al_regs,</span>
<span id="cb573-18"><a href="#cb573-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">y =</span> sqav_profit,</span>
<span id="cb573-19"><a href="#cb573-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">color =</span> <span class="fu">factor</span>(panels),</span>
<span id="cb573-20"><a href="#cb573-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">group =</span> <span class="fu">factor</span>(panels))) <span class="sc">+</span></span>
<span id="cb573-21"><a href="#cb573-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb573-22"><a href="#cb573-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb573-23"><a href="#cb573-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(height <span class="sc">~</span> array,</span>
<span id="cb573-24"><a href="#cb573-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb573-25"><a href="#cb573-25" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(</span>
<span id="cb573-26"><a href="#cb573-26" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"4.6"</span> <span class="ot">=</span> <span class="st">"4.6 ft. Height"</span>,</span>
<span id="cb573-27"><a href="#cb573-27" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"6.4"</span> <span class="ot">=</span> <span class="st">"6.4 ft. Height"</span>,</span>
<span id="cb573-28"><a href="#cb573-28" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"8.2"</span> <span class="ot">=</span> <span class="st">"8.2 ft. Height"</span>,</span>
<span id="cb573-29"><a href="#cb573-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Tracking =</span> <span class="st">"Single Axis Rotation"</span>, </span>
<span id="cb573-30"><a href="#cb573-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Fixed =</span> <span class="st">"Fixed Open Rack"</span></span>
<span id="cb573-31"><a href="#cb573-31" aria-hidden="true" tabindex="-1"></a>                   ))) <span class="sc">+</span></span>
<span id="cb573-32"><a href="#cb573-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">1</span>, </span>
<span id="cb573-33"><a href="#cb573-33" aria-hidden="true" tabindex="-1"></a>                                <span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb573-34"><a href="#cb573-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>,</span>
<span id="cb573-35"><a href="#cb573-35" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>), </span>
<span id="cb573-36"><a href="#cb573-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"Center"</span>, </span>
<span id="cb573-37"><a href="#cb573-37" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"B Belt"</span>, <span class="st">"South"</span>)) <span class="sc">+</span></span>
<span id="cb573-38"><a href="#cb573-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb573-39"><a href="#cb573-39" aria-hidden="true" tabindex="-1"></a>                                <span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb573-40"><a href="#cb573-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Regions of Alabama"</span>,</span>
<span id="cb573-41"><a href="#cb573-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Profit ($) from Squash Agrivoltaic System"</span>,</span>
<span id="cb573-42"><a href="#cb573-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"Number of Solar </span><span class="sc">\n</span><span class="st"> Panels per Acre"</span>,</span>
<span id="cb573-43"><a href="#cb573-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> (<span class="fu">list</span>(combinations[combo,]))</span>
<span id="cb573-44"><a href="#cb573-44" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">+</span></span>
<span id="cb573-45"><a href="#cb573-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>())</span>
<span id="cb573-46"><a href="#cb573-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add horizontal line at y = 0 if y has both positive and negative values</span></span>
<span id="cb573-47"><a href="#cb573-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">min</span>(filtered_data<span class="sc">$</span>sqav_profit) <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb573-48"><a href="#cb573-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(filtered_data<span class="sc">$</span>sqav_profit) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb573-49"><a href="#cb573-49" aria-hidden="true" tabindex="-1"></a>    sqav_sp_plot <span class="ot">&lt;-</span> sqav_sp_plot <span class="sc">+</span> </span>
<span id="cb573-50"><a href="#cb573-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, </span>
<span id="cb573-51"><a href="#cb573-51" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linewidth =</span> <span class="fl">0.30</span>, </span>
<span id="cb573-52"><a href="#cb573-52" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb573-53"><a href="#cb573-53" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb573-54"><a href="#cb573-54" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb573-55"><a href="#cb573-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(combinations[combo,])</span>
<span id="cb573-56"><a href="#cb573-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(sqav_sp_plot)</span>
<span id="cb573-57"><a href="#cb573-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"Plots/sqav_sp_"</span>, combo, <span class="st">".png"</span>))</span>
<span id="cb573-58"><a href="#cb573-58" aria-hidden="true" tabindex="-1"></a>  <span class="co">#break</span></span>
<span id="cb573-59"><a href="#cb573-59" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
1    0.1    11   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
2    0.3    11   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
3    0.5    11   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
4    0.7    11   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
5      1    11   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
6    1.2    11   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
7    1.5    11   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
8    1.8    11   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  yldvar price elcprc
9      2    11   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
10    0.1    14   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
11    0.3    14   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
12    0.5    14   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
13    0.7    14   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
14      1    14   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
15    1.2    14   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
16    1.5    14   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
17    1.8    14   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
18      2    14   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
19    0.1    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
20    0.3    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
21    0.5    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
22    0.7    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
23      1    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-23.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
24    1.2    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-24.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
25    1.5    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-25.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
26    1.8    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-26.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
27      2    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-27.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
28    0.1    11   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-28.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
29    0.3    11   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-29.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
30    0.5    11   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-30.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
31    0.7    11   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-31.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
32      1    11   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-32.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
33    1.2    11   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-33.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
34    1.5    11   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-34.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
35    1.8    11   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-35.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
36      2    11   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-36.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
37    0.1    14   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-37.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
38    0.3    14   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-38.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
39    0.5    14   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-39.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
40    0.7    14   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-40.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
41      1    14   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-41.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
42    1.2    14   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-42.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
43    1.5    14   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-43.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
44    1.8    14   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-44.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
45      2    14   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-45.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
46    0.1    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-46.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
47    0.3    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-47.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
48    0.5    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-48.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
49    0.7    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-49.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
50      1    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-50.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
51    1.2    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-51.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
52    1.5    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-52.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
53    1.8    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-53.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
54      2    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-54.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
55    0.1    11   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-55.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
56    0.3    11   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-56.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
57    0.5    11   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-57.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
58    0.7    11   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-58.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
59      1    11   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-59.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
60    1.2    11   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-60.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
61    1.5    11   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-61.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
62    1.8    11   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-62.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
63      2    11   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-63.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
64    0.1    14   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-64.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
65    0.3    14   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-65.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
66    0.5    14   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-66.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
67    0.7    14   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-67.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
68      1    14   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-68.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
69    1.2    14   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-69.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
70    1.5    14   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-70.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
71    1.8    14   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-71.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
72      2    14   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-72.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
73    0.1    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-73.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
74    0.3    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-74.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
75    0.5    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-75.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
76    0.7    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-76.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
77      1    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-77.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
78    1.2    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-78.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
79    1.5    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-79.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
80    1.8    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-80.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   yldvar price elcprc
81      2    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-40-81.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plotting-squash-profit-by-yields" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="plotting-squash-profit-by-yields"><span class="header-section-number">5.6</span> Plotting Squash Profit by Yields</h2>
<p>You can see plot breakdown based on solar proportion, crop price, and electricity price. You can see variation for all crop yield variation in one facet of the chart. Each facet of the chart contain av profit three heights of solar panels, four regions of AL, two array types.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb736"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb736-1"><a href="#cb736-1" aria-hidden="true" tabindex="-1"></a>combinations <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb736-2"><a href="#cb736-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sprop =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="fl">1.00</span>), <span class="co"># Solar proportion</span></span>
<span id="cb736-3"><a href="#cb736-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">price =</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">17</span>), <span class="co"># Squash price</span></span>
<span id="cb736-4"><a href="#cb736-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">elcprc =</span> <span class="fu">c</span>(<span class="fl">0.03</span>, <span class="fl">0.04</span>, <span class="fl">0.05</span>) <span class="co">#Electricity price</span></span>
<span id="cb736-5"><a href="#cb736-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb736-6"><a href="#cb736-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb736-7"><a href="#cb736-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over the combinations and create the plots</span></span>
<span id="cb736-8"><a href="#cb736-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (combo <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(combinations))) {</span>
<span id="cb736-9"><a href="#cb736-9" aria-hidden="true" tabindex="-1"></a>  filtered_data <span class="ot">&lt;-</span> sqav_profit <span class="sc">%&gt;%</span></span>
<span id="cb736-10"><a href="#cb736-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb736-11"><a href="#cb736-11" aria-hidden="true" tabindex="-1"></a>      sprop <span class="sc">==</span> combinations<span class="sc">$</span>sprop[combo],</span>
<span id="cb736-12"><a href="#cb736-12" aria-hidden="true" tabindex="-1"></a>      price <span class="sc">==</span> combinations<span class="sc">$</span>price[combo],</span>
<span id="cb736-13"><a href="#cb736-13" aria-hidden="true" tabindex="-1"></a>      elcprc <span class="sc">==</span> combinations<span class="sc">$</span>elcprc[combo]</span>
<span id="cb736-14"><a href="#cb736-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb736-15"><a href="#cb736-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If by yield, put yield below in color and group.</span></span>
<span id="cb736-16"><a href="#cb736-16" aria-hidden="true" tabindex="-1"></a>  sqav_yv_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> filtered_data,</span>
<span id="cb736-17"><a href="#cb736-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> al_regs,</span>
<span id="cb736-18"><a href="#cb736-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">y =</span> sqav_profit,</span>
<span id="cb736-19"><a href="#cb736-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">color =</span> <span class="fu">factor</span>(yield),</span>
<span id="cb736-20"><a href="#cb736-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">group =</span> <span class="fu">factor</span>(yield))) <span class="sc">+</span></span>
<span id="cb736-21"><a href="#cb736-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb736-22"><a href="#cb736-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb736-23"><a href="#cb736-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(height <span class="sc">~</span> array,</span>
<span id="cb736-24"><a href="#cb736-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb736-25"><a href="#cb736-25" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(</span>
<span id="cb736-26"><a href="#cb736-26" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"4.6"</span> <span class="ot">=</span> <span class="st">"4.6 ft. Height"</span>,</span>
<span id="cb736-27"><a href="#cb736-27" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"6.4"</span> <span class="ot">=</span> <span class="st">"6.4 ft. Height"</span>,</span>
<span id="cb736-28"><a href="#cb736-28" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"8.2"</span> <span class="ot">=</span> <span class="st">"8.2 ft. Height"</span>,</span>
<span id="cb736-29"><a href="#cb736-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Tracking =</span> <span class="st">"Single Axis Rotation"</span>, </span>
<span id="cb736-30"><a href="#cb736-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Fixed =</span> <span class="st">"Fixed Open Rack"</span></span>
<span id="cb736-31"><a href="#cb736-31" aria-hidden="true" tabindex="-1"></a>                   ))) <span class="sc">+</span></span>
<span id="cb736-32"><a href="#cb736-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">1</span>, </span>
<span id="cb736-33"><a href="#cb736-33" aria-hidden="true" tabindex="-1"></a>                                <span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb736-34"><a href="#cb736-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Northern"</span>, <span class="st">"Central"</span>,</span>
<span id="cb736-35"><a href="#cb736-35" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Black Belt"</span>, <span class="st">"Southern"</span>), </span>
<span id="cb736-36"><a href="#cb736-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"Center"</span>, </span>
<span id="cb736-37"><a href="#cb736-37" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"B Belt"</span>, <span class="st">"South"</span>)) <span class="sc">+</span></span>
<span id="cb736-38"><a href="#cb736-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb736-39"><a href="#cb736-39" aria-hidden="true" tabindex="-1"></a>                                <span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb736-40"><a href="#cb736-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Regions of Alabama"</span>,</span>
<span id="cb736-41"><a href="#cb736-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Profit ($) from Squash Agrivoltaic System"</span>,</span>
<span id="cb736-42"><a href="#cb736-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"Squash Yield </span><span class="sc">\n</span><span class="st"> (25 Lb Buckets)"</span>,</span>
<span id="cb736-43"><a href="#cb736-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> (<span class="fu">list</span>(combinations[combo,]))</span>
<span id="cb736-44"><a href="#cb736-44" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">+</span></span>
<span id="cb736-45"><a href="#cb736-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>())</span>
<span id="cb736-46"><a href="#cb736-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add horizontal line at y = 0 if y has both positive and negative values</span></span>
<span id="cb736-47"><a href="#cb736-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">min</span>(filtered_data<span class="sc">$</span>sqav_profit) <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb736-48"><a href="#cb736-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(filtered_data<span class="sc">$</span>sqav_profit) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb736-49"><a href="#cb736-49" aria-hidden="true" tabindex="-1"></a>    sqav_yv_plot <span class="ot">&lt;-</span> sqav_yv_plot <span class="sc">+</span> </span>
<span id="cb736-50"><a href="#cb736-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, </span>
<span id="cb736-51"><a href="#cb736-51" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linewidth =</span> <span class="fl">0.30</span>, </span>
<span id="cb736-52"><a href="#cb736-52" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb736-53"><a href="#cb736-53" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb736-54"><a href="#cb736-54" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb736-55"><a href="#cb736-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(combinations[combo,])</span>
<span id="cb736-56"><a href="#cb736-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(sqav_yv_plot)</span>
<span id="cb736-57"><a href="#cb736-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"Plots/sqav_yv_"</span>, combo, <span class="st">".png"</span>))</span>
<span id="cb736-58"><a href="#cb736-58" aria-hidden="true" tabindex="-1"></a>  <span class="co">#break</span></span>
<span id="cb736-59"><a href="#cb736-59" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
1     0    11   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
2  0.25    11   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
3   0.5    11   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
4  0.75    11   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
5     1    11   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
6     0    14   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
7  0.25    14   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
8   0.5    14   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sprop price elcprc
9  0.75    14   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
10     1    14   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
11     0    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
12  0.25    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
13   0.5    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
14  0.75    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
15     1    17   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
16     0    11   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
17  0.25    11   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
18   0.5    11   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
19  0.75    11   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
20     1    11   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
21     0    14   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
22  0.25    14   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
23   0.5    14   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-23.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
24  0.75    14   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-24.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
25     1    14   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-25.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
26     0    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-26.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
27  0.25    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-27.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
28   0.5    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-28.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
29  0.75    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-29.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
30     1    17   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-30.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
31     0    11   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-31.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
32  0.25    11   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-32.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
33   0.5    11   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-33.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
34  0.75    11   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-34.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
35     1    11   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-35.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
36     0    14   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-36.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
37  0.25    14   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-37.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
38   0.5    14   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-38.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
39  0.75    14   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-39.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
40     1    14   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-40.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
41     0    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-41.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
42  0.25    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-42.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
43   0.5    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-43.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
44  0.75    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-44.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   sprop price elcprc
45     1    17   0.05</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AV-Profit_files/figure-html/unnamed-chunk-41-45.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>